var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={exports:{}},i={},n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var a=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(r){return!1}}()?Object.assign:function(t,e){for(var i,a,l=o(t),u=1;u<arguments.length;u++){for(var c in i=Object(arguments[u]))r.call(i,c)&&(l[c]=i[c]);if(n){a=n(i);for(var h=0;h<a.length;h++)s.call(i,a[h])&&(l[a[h]]=i[a[h]])}}return l},l=a,u=60103,c=60106;
/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */i.Fragment=60107,i.StrictMode=60108,i.Profiler=60114;var h=60109,m=60110,_=60112;i.Suspense=60113;var f=60115,d=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;u=p("react.element"),c=p("react.portal"),i.Fragment=p("react.fragment"),i.StrictMode=p("react.strict_mode"),i.Profiler=p("react.profiler"),h=p("react.provider"),m=p("react.context"),_=p("react.forward_ref"),i.Suspense=p("react.suspense"),f=p("react.memo"),d=p("react.lazy")}var y="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function x(t,e,i){this.props=t,this.context=e,this.refs=b,this.updater=i||g}function S(){}function w(t,e,i){this.props=t,this.context=e,this.refs=b,this.updater=i||g}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},S.prototype=x.prototype;var B=w.prototype=new S;B.constructor=w,l(B,x.prototype),B.isPureReactComponent=!0;var C={current:null},A=Object.prototype.hasOwnProperty,V={key:!0,ref:!0,__self:!0,__source:!0};function P(t,e,i){var n,r={},s=null,o=null;if(null!=e)for(n in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(s=""+e.key),e)A.call(e,n)&&!V.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(1===a)r.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps)void 0===r[n]&&(r[n]=a[n]);return{$$typeof:u,type:t,key:s,ref:o,props:r,_owner:C.current}}function M(t){return"object"==typeof t&&null!==t&&t.$$typeof===u}var I=/\/+/g;function k(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function D(t,e,i,n,r){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var o=!1;if(null===t)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case u:case c:o=!0}}if(o)return r=r(o=t),t=""===n?"."+k(o,0):n,Array.isArray(r)?(i="",null!=t&&(i=t.replace(I,"$&/")+"/"),D(r,e,i,"",(function(t){return t}))):null!=r&&(M(r)&&(r=function(t,e){return{$$typeof:u,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(r,i+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(I,"$&/")+"/")+t)),e.push(r)),1;if(o=0,n=""===n?".":n+":",Array.isArray(t))for(var a=0;a<t.length;a++){var l=n+k(s=t[a],a);o+=D(s,e,i,l,r)}else if("function"==typeof(l=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=y&&t[y]||t["@@iterator"])?t:null}(t)))for(t=l.call(t),a=0;!(s=t.next()).done;)o+=D(s=s.value,e,i,l=n+k(s,a++),r);else if("object"===s)throw e=""+t,Error(v(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return o}function G(t,e,i){if(null==t)return t;var n=[],r=0;return D(t,n,"","",(function(t){return e.call(i,t,r++)})),n}function T(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var F={current:null};function L(){var t=F.current;if(null===t)throw Error(v(321));return t}var R={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:C,IsSomeRendererActing:{current:!1},assign:l};i.Children={map:G,forEach:function(t,e,i){G(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return G(t,(function(){e++})),e},toArray:function(t){return G(t,(function(t){return t}))||[]},only:function(t){if(!M(t))throw Error(v(143));return t}},i.Component=x,i.PureComponent=w,i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,i.cloneElement=function(t,e,i){if(null==t)throw Error(v(267,t));var n=l({},t.props),r=t.key,s=t.ref,o=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,o=C.current),void 0!==e.key&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)A.call(e,c)&&!V.hasOwnProperty(c)&&(n[c]=void 0===e[c]&&void 0!==a?a[c]:e[c])}var c=arguments.length-2;if(1===c)n.children=i;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];n.children=a}return{$$typeof:u,type:t.type,key:r,ref:s,props:n,_owner:o}},i.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:m,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:h,_context:t},t.Consumer=t},i.createElement=P,i.createFactory=function(t){var e=P.bind(null,t);return e.type=t,e},i.createRef=function(){return{current:null}},i.forwardRef=function(t){return{$$typeof:_,render:t}},i.isValidElement=M,i.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:T}},i.memo=function(t,e){return{$$typeof:f,type:t,compare:void 0===e?null:e}},i.useCallback=function(t,e){return L().useCallback(t,e)},i.useContext=function(t,e){return L().useContext(t,e)},i.useDebugValue=function(){},i.useEffect=function(t,e){return L().useEffect(t,e)},i.useImperativeHandle=function(t,e,i){return L().useImperativeHandle(t,e,i)},i.useLayoutEffect=function(t,e){return L().useLayoutEffect(t,e)},i.useMemo=function(t,e){return L().useMemo(t,e)},i.useReducer=function(t,e,i){return L().useReducer(t,e,i)},i.useRef=function(t){return L().useRef(t)},i.useState=function(t){return L().useState(t)},i.version="17.0.2",e.exports=i;var E=e.exports,z={exports:{}},O={},N={exports:{}},j={};
/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(t){var e,i,n,r;if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,u=null,c=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e),l=null}catch(i){throw setTimeout(c,0),i}};e=function(t){null!==l?setTimeout(e,0,t):(l=t,setTimeout(c,0))},i=function(t,e){u=setTimeout(t,e)},n=function(){clearTimeout(u)},t.unstable_shouldYield=function(){return!1},r=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var _=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof _&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var f=!1,d=null,p=-1,y=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},r=function(){},t.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<t?Math.floor(1e3/t):5};var g=new MessageChannel,b=g.port2;g.port1.onmessage=function(){if(null!==d){var e=t.unstable_now();v=e+y;try{d(!0,e)?b.postMessage(null):(f=!1,d=null)}catch(i){throw b.postMessage(null),i}}else f=!1},e=function(t){d=t,f||(f=!0,b.postMessage(null))},i=function(e,i){p=h((function(){e(t.unstable_now())}),i)},n=function(){m(p),p=-1}}function x(t,e){var i=t.length;t.push(e);t:for(;;){var n=i-1>>>1,r=t[n];if(!(void 0!==r&&0<B(r,e)))break t;t[n]=e,t[i]=r,i=n}}function S(t){return void 0===(t=t[0])?null:t}function w(t){var e=t[0];if(void 0!==e){var i=t.pop();if(i!==e){t[0]=i;t:for(var n=0,r=t.length;n<r;){var s=2*(n+1)-1,o=t[s],a=s+1,l=t[a];if(void 0!==o&&0>B(o,i))void 0!==l&&0>B(l,o)?(t[n]=l,t[a]=i,n=a):(t[n]=o,t[s]=i,n=s);else{if(!(void 0!==l&&0>B(l,i)))break t;t[n]=l,t[a]=i,n=a}}}return e}return null}function B(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}var C=[],A=[],V=1,P=null,M=3,I=!1,k=!1,D=!1;function G(t){for(var e=S(A);null!==e;){if(null===e.callback)w(A);else{if(!(e.startTime<=t))break;w(A),e.sortIndex=e.expirationTime,x(C,e)}e=S(A)}}function T(t){if(D=!1,G(t),!k)if(null!==S(C))k=!0,e(F);else{var n=S(A);null!==n&&i(T,n.startTime-t)}}function F(e,r){k=!1,D&&(D=!1,n()),I=!0;var s=M;try{for(G(r),P=S(C);null!==P&&(!(P.expirationTime>r)||e&&!t.unstable_shouldYield());){var o=P.callback;if("function"==typeof o){P.callback=null,M=P.priorityLevel;var a=o(P.expirationTime<=r);r=t.unstable_now(),"function"==typeof a?P.callback=a:P===S(C)&&w(C),G(r)}else w(C);P=S(C)}if(null!==P)var l=!0;else{var u=S(A);null!==u&&i(T,u.startTime-r),l=!1}return l}finally{P=null,M=s,I=!1}}var L=r;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(t){t.callback=null},t.unstable_continueExecution=function(){k||I||(k=!0,e(F))},t.unstable_getCurrentPriorityLevel=function(){return M},t.unstable_getFirstCallbackNode=function(){return S(C)},t.unstable_next=function(t){switch(M){case 1:case 2:case 3:var e=3;break;default:e=M}var i=M;M=e;try{return t()}finally{M=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=L,t.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=M;M=t;try{return e()}finally{M=i}},t.unstable_scheduleCallback=function(r,s,o){var a=t.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?a+o:a:o=a,r){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return r={id:V++,callback:s,priorityLevel:r,startTime:o,expirationTime:l=o+l,sortIndex:-1},o>a?(r.sortIndex=o,x(A,r),null===S(C)&&r===S(A)&&(D?n():D=!0,i(T,o-a))):(r.sortIndex=l,x(C,r),k||I||(k=!0,e(F))),r},t.unstable_wrapCallback=function(t){var e=M;return function(){var i=M;M=e;try{return t.apply(this,arguments)}finally{M=i}}}}(j),N.exports=j;
/** @license React v17.0.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var q=e.exports,U=a,J=N.exports;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!q)throw Error(W(227));var X=new Set,H={};function Z(t,e){Q(t,e),Q(t+"Capture",e)}function Q(t,e){for(H[t]=e,t=0;t<e.length;t++)X.add(e[t])}var $=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,K=Object.prototype.hasOwnProperty,tt={},et={};function it(t,e,i,n,r,s,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){nt[t]=new it(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];nt[e]=new it(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){nt[t]=new it(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){nt[t]=new it(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){nt[t]=new it(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){nt[t]=new it(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){nt[t]=new it(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){nt[t]=new it(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){nt[t]=new it(t,5,!1,t.toLowerCase(),null,!1,!1)}));var rt=/[\-:]([a-z])/g;function st(t){return t[1].toUpperCase()}function ot(t,e,i,n){var r=nt.hasOwnProperty(e)?nt[e]:null;(null!==r?0===r.type:!n&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,i,n){if(null==e||function(t,e,i,n){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,r,n)&&(i=null),n||null===r?function(t){return!!K.call(et,t)||!K.call(tt,t)&&(Y.test(t)?et[t]=!0:(tt[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):r.mustUseProperty?t[r.propertyName]=null===i?3!==r.type&&"":i:(e=r.attributeName,n=r.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(rt,st);nt[e]=new it(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(rt,st);nt[e]=new it(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(rt,st);nt[e]=new it(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){nt[t]=new it(t,1,!1,t.toLowerCase(),null,!1,!1)})),nt.xlinkHref=new it("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){nt[t]=new it(t,1,!1,t.toLowerCase(),null,!0,!0)}));var at=q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lt=60103,ut=60106,ct=60107,ht=60108,mt=60114,_t=60109,ft=60110,dt=60112,pt=60113,yt=60120,vt=60115,gt=60116,bt=60121,xt=60128,St=60129,wt=60130,Bt=60131;if("function"==typeof Symbol&&Symbol.for){var Ct=Symbol.for;lt=Ct("react.element"),ut=Ct("react.portal"),ct=Ct("react.fragment"),ht=Ct("react.strict_mode"),mt=Ct("react.profiler"),_t=Ct("react.provider"),ft=Ct("react.context"),dt=Ct("react.forward_ref"),pt=Ct("react.suspense"),yt=Ct("react.suspense_list"),vt=Ct("react.memo"),gt=Ct("react.lazy"),bt=Ct("react.block"),Ct("react.scope"),xt=Ct("react.opaque.id"),St=Ct("react.debug_trace_mode"),wt=Ct("react.offscreen"),Bt=Ct("react.legacy_hidden")}var At,Vt="function"==typeof Symbol&&Symbol.iterator;function Pt(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=Vt&&t[Vt]||t["@@iterator"])?t:null}function Mt(t){if(void 0===At)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);At=e&&e[1]||""}return"\n"+At+t}var It=!1;function kt(t,e){if(!t||It)return"";It=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&"string"==typeof l.stack){for(var r=l.stack.split("\n"),s=n.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a])return"\n"+r[o].replace(" at new "," at ")}while(1<=o&&0<=a);break}}}finally{It=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?Mt(t):""}function Dt(t){switch(t.tag){case 5:return Mt(t.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 2:case 15:return t=kt(t.type,!1);case 11:return t=kt(t.type.render,!1);case 22:return t=kt(t.type._render,!1);case 1:return t=kt(t.type,!0);default:return""}}function Gt(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case ct:return"Fragment";case ut:return"Portal";case mt:return"Profiler";case ht:return"StrictMode";case pt:return"Suspense";case yt:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case ft:return(t.displayName||"Context")+".Consumer";case _t:return(t._context.displayName||"Context")+".Provider";case dt:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case vt:return Gt(t.type);case bt:return Gt(t._render);case gt:e=t._payload,t=t._init;try{return Gt(t(e))}catch(i){}}return null}function Tt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Ft(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Lt(t){t._valueTracker||(t._valueTracker=function(t){var e=Ft(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var r=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){n=""+t,s.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(t){n=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Rt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=Ft(t)?t.checked?"true":"false":t.value),(t=n)!==i&&(e.setValue(t),!0)}function Et(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function zt(t,e){var i=e.checked;return U({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function Ot(t,e){var i=null==e.defaultValue?"":e.defaultValue,n=null!=e.checked?e.checked:e.defaultChecked;i=Tt(null!=e.value?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Nt(t,e){null!=(e=e.checked)&&ot(t,"checked",e,!1)}function jt(t,e){Nt(t,e);var i=Tt(e.value),n=e.type;if(null!=i)"number"===n?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===n||"reset"===n)return void t.removeAttribute("value");e.hasOwnProperty("value")?Ut(t,e.type,i):e.hasOwnProperty("defaultValue")&&Ut(t,e.type,Tt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function qt(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!("submit"!==n&&"reset"!==n||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function Ut(t,e,i){"number"===e&&Et(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}function Jt(t,e){return t=U({children:void 0},e),(e=function(t){var e="";return q.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Wt(t,e,i,n){if(t=t.options,e){e={};for(var r=0;r<i.length;r++)e["$"+i[r]]=!0;for(i=0;i<t.length;i++)r=e.hasOwnProperty("$"+t[i].value),t[i].selected!==r&&(t[i].selected=r),r&&n&&(t[i].defaultSelected=!0)}else{for(i=""+Tt(i),e=null,r=0;r<t.length;r++){if(t[r].value===i)return t[r].selected=!0,void(n&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function Xt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(W(91));return U({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ht(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(W(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(W(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:Tt(i)}}function Zt(t,e){var i=Tt(e.value),n=Tt(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=n&&(t.defaultValue=""+n)}function Qt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var $t="http://www.w3.org/1999/xhtml",Yt="http://www.w3.org/2000/svg";function Kt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function te(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Kt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ee,ie,ne=(ie=function(t,e){if(t.namespaceURI!==Yt||"innerHTML"in t)t.innerHTML=e;else{for((ee=ee||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ee.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,i,n){MSApp.execUnsafeLocalFunction((function(){return ie(t,e)}))}:ie);function re(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var se={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oe=["Webkit","ms","Moz","O"];function ae(t,e,i){return null==e||"boolean"==typeof e||""===e?"":i||"number"!=typeof e||0===e||se.hasOwnProperty(t)&&se[t]?(""+e).trim():e+"px"}function le(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=ae(i,e[i],n);"float"===i&&(i="cssFloat"),n?t.setProperty(i,r):t[i]=r}}Object.keys(se).forEach((function(t){oe.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),se[e]=se[t]}))}));var ue=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ce(t,e){if(e){if(ue[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(W(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(W(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(W(62))}}function he(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function me(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var _e=null,fe=null,de=null;function pe(t){if(t=Or(t)){if("function"!=typeof _e)throw Error(W(280));var e=t.stateNode;e&&(e=jr(e),_e(t.stateNode,t.type,e))}}function ye(t){fe?de?de.push(t):de=[t]:fe=t}function ve(){if(fe){var t=fe,e=de;if(de=fe=null,pe(t),e)for(t=0;t<e.length;t++)pe(e[t])}}function ge(t,e){return t(e)}function be(t,e,i,n,r){return t(e,i,n,r)}function xe(){}var Se=ge,we=!1,Be=!1;function Ce(){null===fe&&null===de||(xe(),ve())}function Ae(t,e){var i=t.stateNode;if(null===i)return null;var n=jr(i);if(null===n)return null;i=n[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!n;break t;default:t=!1}if(t)return null;if(i&&"function"!=typeof i)throw Error(W(231,e,typeof i));return i}var Ve=!1;if($)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Ve=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ie){Ve=!1}function Me(t,e,i,n,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(i,u)}catch(c){this.onError(c)}}var Ie=!1,ke=null,De=!1,Ge=null,Te={onError:function(t){Ie=!0,ke=t}};function Fe(t,e,i,n,r,s,o,a,l){Ie=!1,ke=null,Me.apply(Te,arguments)}function Le(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function Re(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Ee(t){if(Le(t)!==t)throw Error(W(188))}function ze(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=Le(t)))throw Error(W(188));return e!==t?null:t}for(var i=t,n=e;;){var r=i.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(n=r.return)){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return Ee(r),t;if(s===n)return Ee(r),e;s=s.sibling}throw Error(W(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(W(189))}}if(i.alternate!==n)throw Error(W(190))}if(3!==i.tag)throw Error(W(188));return i.stateNode.current===i?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Oe(t,e){for(var i=t.alternate;null!==e;){if(e===t||e===i)return!0;e=e.return}return!1}var Ne,je,qe,Ue,Je=!1,We=[],Xe=null,He=null,Ze=null,Qe=new Map,$e=new Map,Ye=[],Ke="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ti(t,e,i,n,r){return{blockedOn:t,domEventName:e,eventSystemFlags:16|i,nativeEvent:r,targetContainers:[n]}}function ei(t,e){switch(t){case"focusin":case"focusout":Xe=null;break;case"dragenter":case"dragleave":He=null;break;case"mouseover":case"mouseout":Ze=null;break;case"pointerover":case"pointerout":Qe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$e.delete(e.pointerId)}}function ii(t,e,i,n,r,s){return null===t||t.nativeEvent!==s?(t=ti(e,i,n,r,s),null!==e&&(null!==(e=Or(e))&&je(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function ni(t){var e=zr(t.target);if(null!==e){var i=Le(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=Re(i)))return t.blockedOn=e,void Ue(t.lanePriority,(function(){J.unstable_runWithPriority(t.priority,(function(){qe(i)}))}))}else if(3===e&&i.stateNode.hydrate)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function ri(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=zi(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=Or(i))&&je(e),t.blockedOn=i,!1;e.shift()}return!0}function si(t,e,i){ri(t)&&i.delete(e)}function oi(){for(Je=!1;0<We.length;){var t=We[0];if(null!==t.blockedOn){null!==(t=Or(t.blockedOn))&&Ne(t);break}for(var e=t.targetContainers;0<e.length;){var i=zi(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i){t.blockedOn=i;break}e.shift()}null===t.blockedOn&&We.shift()}null!==Xe&&ri(Xe)&&(Xe=null),null!==He&&ri(He)&&(He=null),null!==Ze&&ri(Ze)&&(Ze=null),Qe.forEach(si),$e.forEach(si)}function ai(t,e){t.blockedOn===e&&(t.blockedOn=null,Je||(Je=!0,J.unstable_scheduleCallback(J.unstable_NormalPriority,oi)))}function li(t){function e(e){return ai(e,t)}if(0<We.length){ai(We[0],t);for(var i=1;i<We.length;i++){var n=We[i];n.blockedOn===t&&(n.blockedOn=null)}}for(null!==Xe&&ai(Xe,t),null!==He&&ai(He,t),null!==Ze&&ai(Ze,t),Qe.forEach(e),$e.forEach(e),i=0;i<Ye.length;i++)(n=Ye[i]).blockedOn===t&&(n.blockedOn=null);for(;0<Ye.length&&null===(i=Ye[0]).blockedOn;)ni(i),null===i.blockedOn&&Ye.shift()}function ui(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var ci={animationend:ui("Animation","AnimationEnd"),animationiteration:ui("Animation","AnimationIteration"),animationstart:ui("Animation","AnimationStart"),transitionend:ui("Transition","TransitionEnd")},hi={},mi={};function _i(t){if(hi[t])return hi[t];if(!ci[t])return t;var e,i=ci[t];for(e in i)if(i.hasOwnProperty(e)&&e in mi)return hi[t]=i[e];return t}$&&(mi=document.createElement("div").style,"AnimationEvent"in window||(delete ci.animationend.animation,delete ci.animationiteration.animation,delete ci.animationstart.animation),"TransitionEvent"in window||delete ci.transitionend.transition);var fi=_i("animationend"),di=_i("animationiteration"),pi=_i("animationstart"),yi=_i("transitionend"),vi=new Map,gi=new Map,bi=["abort","abort",fi,"animationEnd",di,"animationIteration",pi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",yi,"transitionEnd","waiting","waiting"];function xi(t,e){for(var i=0;i<t.length;i+=2){var n=t[i],r=t[i+1];r="on"+(r[0].toUpperCase()+r.slice(1)),gi.set(n,e),vi.set(n,r),Z(r,[n])}}(0,J.unstable_now)();var Si=8;function wi(t){if(0!=(1&t))return Si=15,1;if(0!=(2&t))return Si=14,2;if(0!=(4&t))return Si=13,4;var e=24&t;return 0!==e?(Si=12,e):0!=(32&t)?(Si=11,32):0!==(e=192&t)?(Si=10,e):0!=(256&t)?(Si=9,256):0!==(e=3584&t)?(Si=8,e):0!=(4096&t)?(Si=7,4096):0!==(e=4186112&t)?(Si=6,e):0!==(e=62914560&t)?(Si=5,e):67108864&t?(Si=4,67108864):0!=(134217728&t)?(Si=3,134217728):0!==(e=805306368&t)?(Si=2,e):0!=(1073741824&t)?(Si=1,1073741824):(Si=8,t)}function Bi(t,e){var i=t.pendingLanes;if(0===i)return Si=0;var n=0,r=0,s=t.expiredLanes,o=t.suspendedLanes,a=t.pingedLanes;if(0!==s)n=s,r=Si=15;else if(0!==(s=134217727&i)){var l=s&~o;0!==l?(n=wi(l),r=Si):0!==(a&=s)&&(n=wi(a),r=Si)}else 0!==(s=i&~o)?(n=wi(s),r=Si):0!==a&&(n=wi(a),r=Si);if(0===n)return 0;if(n=i&((0>(n=31-Ii(n))?0:1<<n)<<1)-1,0!==e&&e!==n&&0==(e&o)){if(wi(e),r<=Si)return e;Si=r}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=n;0<e;)r=1<<(i=31-Ii(e)),n|=t[i],e&=~r;return n}function Ci(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function Ai(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=Vi(24&~e))?Ai(10,e):t;case 10:return 0===(t=Vi(192&~e))?Ai(8,e):t;case 8:return 0===(t=Vi(3584&~e))&&(0===(t=Vi(4186112&~e))&&(t=512)),t;case 2:return 0===(e=Vi(805306368&~e))&&(e=268435456),e}throw Error(W(358,t))}function Vi(t){return t&-t}function Pi(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function Mi(t,e,i){t.pendingLanes|=e;var n=e-1;t.suspendedLanes&=n,t.pingedLanes&=n,(t=t.eventTimes)[e=31-Ii(e)]=i}var Ii=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(ki(t)/Di|0)|0},ki=Math.log,Di=Math.LN2;var Gi=J.unstable_UserBlockingPriority,Ti=J.unstable_runWithPriority,Fi=!0;function Li(t,e,i,n){we||xe();var r=Ei,s=we;we=!0;try{be(r,t,e,i,n)}finally{(we=s)||Ce()}}function Ri(t,e,i,n){Ti(Gi,Ei.bind(null,t,e,i,n))}function Ei(t,e,i,n){var r;if(Fi)if((r=0==(4&e))&&0<We.length&&-1<Ke.indexOf(t))t=ti(null,t,e,i,n),We.push(t);else{var s=zi(t,e,i,n);if(null===s)r&&ei(t,n);else{if(r){if(-1<Ke.indexOf(t))return t=ti(s,t,e,i,n),void We.push(t);if(function(t,e,i,n,r){switch(e){case"focusin":return Xe=ii(Xe,t,e,i,n,r),!0;case"dragenter":return He=ii(He,t,e,i,n,r),!0;case"mouseover":return Ze=ii(Ze,t,e,i,n,r),!0;case"pointerover":var s=r.pointerId;return Qe.set(s,ii(Qe.get(s)||null,t,e,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,$e.set(s,ii($e.get(s)||null,t,e,i,n,r)),!0}return!1}(s,t,e,i,n))return;ei(t,n)}vr(t,e,n,null,i)}}}function zi(t,e,i,n){var r=me(n);if(null!==(r=zr(r))){var s=Le(r);if(null===s)r=null;else{var o=s.tag;if(13===o){if(null!==(r=Re(s)))return r;r=null}else if(3===o){if(s.stateNode.hydrate)return 3===s.tag?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return vr(t,e,n,r,i),null}var Oi=null,Ni=null,ji=null;function qi(){if(ji)return ji;var t,e,i=Ni,n=i.length,r="value"in Oi?Oi.value:Oi.textContent,s=r.length;for(t=0;t<n&&i[t]===r[t];t++);var o=n-t;for(e=1;e<=o&&i[n-e]===r[s-e];e++);return ji=r.slice(t,1<e?1-e:void 0)}function Ui(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function Ji(){return!0}function Wi(){return!1}function Xi(t){function e(e,i,n,r,s){for(var o in this._reactName=e,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=s,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Ji:Wi,this.isPropagationStopped=Wi,this}return U(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=Ji)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=Ji)},persist:function(){},isPersistent:Ji}),e}var Hi,Zi,Qi,$i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yi=Xi($i),Ki=U({},$i,{view:0,detail:0}),tn=Xi(Ki),en=U({},Ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qi&&(Qi&&"mousemove"===t.type?(Hi=t.screenX-Qi.screenX,Zi=t.screenY-Qi.screenY):Zi=Hi=0,Qi=t),Hi)},movementY:function(t){return"movementY"in t?t.movementY:Zi}}),nn=Xi(en),rn=Xi(U({},en,{dataTransfer:0})),sn=Xi(U({},Ki,{relatedTarget:0})),on=Xi(U({},$i,{animationName:0,elapsedTime:0,pseudoElement:0})),an=Xi(U({},$i,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}})),ln=Xi(U({},$i,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=hn[t])&&!!e[t]}function _n(){return mn}var fn=Xi(U({},Ki,{key:function(t){if(t.key){var e=un[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=Ui(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?cn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(t){return"keypress"===t.type?Ui(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Ui(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}})),dn=Xi(U({},en,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),pn=Xi(U({},Ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),yn=Xi(U({},$i,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=Xi(U({},en,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0})),gn=[9,13,27,32],bn=$&&"CompositionEvent"in window,xn=null;$&&"documentMode"in document&&(xn=document.documentMode);var Sn=$&&"TextEvent"in window&&!xn,wn=$&&(!bn||xn&&8<xn&&11>=xn),Bn=String.fromCharCode(32),Cn=!1;function An(t,e){switch(t){case"keyup":return-1!==gn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Pn=!1;var Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function In(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Mn[t.type]:"textarea"===e}function kn(t,e,i,n){ye(n),0<(e=br(e,"onChange")).length&&(i=new Yi("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var Dn=null,Gn=null;function Tn(t){mr(t,0)}function Fn(t){if(Rt(Nr(t)))return t}function Ln(t,e){if("change"===t)return e}var Rn=!1;if($){var En;if($){var zn="oninput"in document;if(!zn){var On=document.createElement("div");On.setAttribute("oninput","return;"),zn="function"==typeof On.oninput}En=zn}else En=!1;Rn=En&&(!document.documentMode||9<document.documentMode)}function Nn(){Dn&&(Dn.detachEvent("onpropertychange",jn),Gn=Dn=null)}function jn(t){if("value"===t.propertyName&&Fn(Gn)){var e=[];if(kn(e,Gn,t,me(t)),t=Tn,we)t(e);else{we=!0;try{ge(t,e)}finally{we=!1,Ce()}}}}function qn(t,e,i){"focusin"===t?(Nn(),Gn=i,(Dn=e).attachEvent("onpropertychange",jn)):"focusout"===t&&Nn()}function Un(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Fn(Gn)}function Jn(t,e){if("click"===t)return Fn(e)}function Wn(t,e){if("input"===t||"change"===t)return Fn(e)}var Xn="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},Hn=Object.prototype.hasOwnProperty;function Zn(t,e){if(Xn(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++)if(!Hn.call(e,i[n])||!Xn(t[i[n]],e[i[n]]))return!1;return!0}function Qn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $n(t,e){var i,n=Qn(t);for(t=0;n;){if(3===n.nodeType){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=Qn(n)}}function Yn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?Yn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function Kn(){for(var t=window,e=Et();e instanceof t.HTMLIFrameElement;){try{var i="string"==typeof e.contentWindow.location.href}catch(n){i=!1}if(!i)break;e=Et((t=e.contentWindow).document)}return e}function tr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var er=$&&"documentMode"in document&&11>=document.documentMode,ir=null,nr=null,rr=null,sr=!1;function or(t,e,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;sr||null==ir||ir!==Et(n)||("selectionStart"in(n=ir)&&tr(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},rr&&Zn(rr,n)||(rr=n,0<(n=br(nr,"onSelect")).length&&(e=new Yi("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=ir)))}xi("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),xi("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),xi(bi,2);for(var ar="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),lr=0;lr<ar.length;lr++)gi.set(ar[lr],0);Q("onMouseEnter",["mouseout","mouseover"]),Q("onMouseLeave",["mouseout","mouseover"]),Q("onPointerEnter",["pointerout","pointerover"]),Q("onPointerLeave",["pointerout","pointerover"]),Z("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Z("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Z("onBeforeInput",["compositionend","keypress","textInput","paste"]),Z("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Z("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Z("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ur="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cr=new Set("cancel close invalid load scroll toggle".split(" ").concat(ur));function hr(t,e,i){var n=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,n,r,s,o,a,l){if(Fe.apply(this,arguments),Ie){if(!Ie)throw Error(W(198));var u=ke;Ie=!1,ke=null,De||(De=!0,Ge=u)}}(n,e,void 0,t),t.currentTarget=null}function mr(t,e){e=0!=(4&e);for(var i=0;i<t.length;i++){var n=t[i],r=n.event;n=n.listeners;t:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break t;hr(r,a,u),s=l}else for(o=0;o<n.length;o++){if(l=(a=n[o]).instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break t;hr(r,a,u),s=l}}}if(De)throw t=Ge,De=!1,Ge=null,t}function _r(t,e){var i=qr(e),n=t+"__bubble";i.has(n)||(yr(e,t,2,!1),i.add(n))}var fr="_reactListening"+Math.random().toString(36).slice(2);function dr(t){t[fr]||(t[fr]=!0,X.forEach((function(e){cr.has(e)||pr(e,!1,t,null),pr(e,!0,t,null)})))}function pr(t,e,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=i;if("selectionchange"===t&&9!==i.nodeType&&(s=i.ownerDocument),null!==n&&!e&&cr.has(t)){if("scroll"!==t)return;r|=2,s=n}var o=qr(s),a=t+"__"+(e?"capture":"bubble");o.has(a)||(e&&(r|=4),yr(s,t,r,e),o.add(a))}function yr(t,e,i,n){var r=gi.get(e);switch(void 0===r?2:r){case 0:r=Li;break;case 1:r=Ri;break;default:r=Ei}i=r.bind(null,e,i,t),r=void 0,!Ve||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),n?void 0!==r?t.addEventListener(e,i,{capture:!0,passive:r}):t.addEventListener(e,i,!0):void 0!==r?t.addEventListener(e,i,{passive:r}):t.addEventListener(e,i,!1)}function vr(t,e,i,n,r){var s=n;if(0==(1&e)&&0==(2&e)&&null!==n)t:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var a=n.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=n.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=zr(a)))return;if(5===(l=o.tag)||6===l){n=s=o;continue t}a=a.parentNode}}n=n.return}!function(t,e,i){if(Be)return t(e,i);Be=!0;try{Se(t,e,i)}finally{Be=!1,Ce()}}((function(){var n=s,r=me(i),o=[];t:{var a=vi.get(t);if(void 0!==a){var l=Yi,u=t;switch(t){case"keypress":if(0===Ui(i))break t;case"keydown":case"keyup":l=fn;break;case"focusin":u="focus",l=sn;break;case"focusout":u="blur",l=sn;break;case"beforeblur":case"afterblur":l=sn;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=nn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=rn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=pn;break;case fi:case di:case pi:l=on;break;case yi:l=yn;break;case"scroll":l=tn;break;case"wheel":l=vn;break;case"copy":case"cut":case"paste":l=an;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=dn}var c=0!=(4&e),h=!c&&"scroll"===t,m=c?null!==a?a+"Capture":null:a;c=[];for(var _,f=n;null!==f;){var d=(_=f).stateNode;if(5===_.tag&&null!==d&&(_=d,null!==m&&(null!=(d=Ae(f,m))&&c.push(gr(f,d,_)))),h)break;f=f.return}0<c.length&&(a=new l(a,u,null,i,r),o.push({event:a,listeners:c}))}}if(0==(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||0!=(16&e)||!(u=i.relatedTarget||i.fromElement)||!zr(u)&&!u[Rr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(u=(u=i.relatedTarget||i.toElement)?zr(u):null)&&(u!==(h=Le(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=n),l!==u)){if(c=nn,d="onMouseLeave",m="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(c=dn,d="onPointerLeave",m="onPointerEnter",f="pointer"),h=null==l?a:Nr(l),_=null==u?a:Nr(u),(a=new c(d,f+"leave",l,i,r)).target=h,a.relatedTarget=_,d=null,zr(r)===n&&((c=new c(m,f+"enter",u,i,r)).target=_,c.relatedTarget=h,d=c),h=d,l&&u)t:{for(m=u,f=0,_=c=l;_;_=xr(_))f++;for(_=0,d=m;d;d=xr(d))_++;for(;0<f-_;)c=xr(c),f--;for(;0<_-f;)m=xr(m),_--;for(;f--;){if(c===m||null!==m&&c===m.alternate)break t;c=xr(c),m=xr(m)}c=null}else c=null;null!==l&&Sr(o,a,l,c,!1),null!==u&&null!==h&&Sr(o,h,u,c,!0)}if("select"===(l=(a=n?Nr(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var p=Ln;else if(In(a))if(Rn)p=Wn;else{p=Un;var y=qn}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(p=Jn);switch(p&&(p=p(t,n))?kn(o,p,i,r):(y&&y(t,a,n),"focusout"===t&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&Ut(a,"number",a.value)),y=n?Nr(n):window,t){case"focusin":(In(y)||"true"===y.contentEditable)&&(ir=y,nr=n,rr=null);break;case"focusout":rr=nr=ir=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,or(o,i,r);break;case"selectionchange":if(er)break;case"keydown":case"keyup":or(o,i,r)}var v;if(bn)t:{switch(t){case"compositionstart":var g="onCompositionStart";break t;case"compositionend":g="onCompositionEnd";break t;case"compositionupdate":g="onCompositionUpdate";break t}g=void 0}else Pn?An(t,i)&&(g="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(g="onCompositionStart");g&&(wn&&"ko"!==i.locale&&(Pn||"onCompositionStart"!==g?"onCompositionEnd"===g&&Pn&&(v=qi()):(Ni="value"in(Oi=r)?Oi.value:Oi.textContent,Pn=!0)),0<(y=br(n,g)).length&&(g=new ln(g,t,null,i,r),o.push({event:g,listeners:y}),v?g.data=v:null!==(v=Vn(i))&&(g.data=v))),(v=Sn?function(t,e){switch(t){case"compositionend":return Vn(e);case"keypress":return 32!==e.which?null:(Cn=!0,Bn);case"textInput":return(t=e.data)===Bn&&Cn?null:t;default:return null}}(t,i):function(t,e){if(Pn)return"compositionend"===t||!bn&&An(t,e)?(t=qi(),ji=Ni=Oi=null,Pn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wn&&"ko"!==e.locale?null:e.data;default:return null}}(t,i))&&(0<(n=br(n,"onBeforeInput")).length&&(r=new ln("onBeforeInput","beforeinput",null,i,r),o.push({event:r,listeners:n}),r.data=v))}mr(o,e)}))}function gr(t,e,i){return{instance:t,listener:e,currentTarget:i}}function br(t,e){for(var i=e+"Capture",n=[];null!==t;){var r=t,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Ae(t,i))&&n.unshift(gr(t,s,r)),null!=(s=Ae(t,e))&&n.push(gr(t,s,r))),t=t.return}return n}function xr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Sr(t,e,i,n,r){for(var s=e._reactName,o=[];null!==i&&i!==n;){var a=i,l=a.alternate,u=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==u&&(a=u,r?null!=(l=Ae(i,s))&&o.unshift(gr(i,l,a)):r||null!=(l=Ae(i,s))&&o.push(gr(i,l,a))),i=i.return}0!==o.length&&t.push({event:e,listeners:o})}function wr(){}var Br=null,Cr=null;function Ar(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Vr(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Pr="function"==typeof setTimeout?setTimeout:void 0,Mr="function"==typeof clearTimeout?clearTimeout:void 0;function Ir(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function kr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Dr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var Gr=0;var Tr=Math.random().toString(36).slice(2),Fr="__reactFiber$"+Tr,Lr="__reactProps$"+Tr,Rr="__reactContainer$"+Tr,Er="__reactEvents$"+Tr;function zr(t){var e=t[Fr];if(e)return e;for(var i=t.parentNode;i;){if(e=i[Rr]||i[Fr]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=Dr(t);null!==t;){if(i=t[Fr])return i;t=Dr(t)}return e}i=(t=i).parentNode}return null}function Or(t){return!(t=t[Fr]||t[Rr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function Nr(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(W(33))}function jr(t){return t[Lr]||null}function qr(t){var e=t[Er];return void 0===e&&(e=t[Er]=new Set),e}var Ur=[],Jr=-1;function Wr(t){return{current:t}}function Xr(t){0>Jr||(t.current=Ur[Jr],Ur[Jr]=null,Jr--)}function Hr(t,e){Jr++,Ur[Jr]=t.current,t.current=e}var Zr={},Qr=Wr(Zr),$r=Wr(!1),Yr=Zr;function Kr(t,e){var i=t.type.contextTypes;if(!i)return Zr;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in i)s[r]=e[r];return n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ts(t){return null!=(t=t.childContextTypes)}function es(){Xr($r),Xr(Qr)}function is(t,e,i){if(Qr.current!==Zr)throw Error(W(168));Hr(Qr,e),Hr($r,i)}function ns(t,e,i){var n=t.stateNode;if(t=e.childContextTypes,"function"!=typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(W(108,Gt(e)||"Unknown",r));return U({},i,n)}function rs(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zr,Yr=Qr.current,Hr(Qr,t),Hr($r,$r.current),!0}function ss(t,e,i){var n=t.stateNode;if(!n)throw Error(W(169));i?(t=ns(t,e,Yr),n.__reactInternalMemoizedMergedChildContext=t,Xr($r),Xr(Qr),Hr(Qr,t)):Xr($r),Hr($r,i)}var os=null,as=null,ls=J.unstable_runWithPriority,us=J.unstable_scheduleCallback,cs=J.unstable_cancelCallback,hs=J.unstable_shouldYield,ms=J.unstable_requestPaint,_s=J.unstable_now,fs=J.unstable_getCurrentPriorityLevel,ds=J.unstable_ImmediatePriority,ps=J.unstable_UserBlockingPriority,ys=J.unstable_NormalPriority,vs=J.unstable_LowPriority,gs=J.unstable_IdlePriority,bs={},xs=void 0!==ms?ms:function(){},Ss=null,ws=null,Bs=!1,Cs=_s(),As=1e4>Cs?_s:function(){return _s()-Cs};function Vs(){switch(fs()){case ds:return 99;case ps:return 98;case ys:return 97;case vs:return 96;case gs:return 95;default:throw Error(W(332))}}function Ps(t){switch(t){case 99:return ds;case 98:return ps;case 97:return ys;case 96:return vs;case 95:return gs;default:throw Error(W(332))}}function Ms(t,e){return t=Ps(t),ls(t,e)}function Is(t,e,i){return t=Ps(t),us(t,e,i)}function ks(){if(null!==ws){var t=ws;ws=null,cs(t)}Ds()}function Ds(){if(!Bs&&null!==Ss){Bs=!0;var t=0;try{var e=Ss;Ms(99,(function(){for(;t<e.length;t++){var i=e[t];do{i=i(!0)}while(null!==i)}})),Ss=null}catch(i){throw null!==Ss&&(Ss=Ss.slice(t+1)),us(ds,ks),i}finally{Bs=!1}}}var Gs=at.ReactCurrentBatchConfig;function Ts(t,e){if(t&&t.defaultProps){for(var i in e=U({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}var Fs=Wr(null),Ls=null,Rs=null,Es=null;function zs(){Es=Rs=Ls=null}function Os(t){var e=Fs.current;Xr(Fs),t.type._context._currentValue=e}function Ns(t,e){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)===e){if(null===i||(i.childLanes&e)===e)break;i.childLanes|=e}else t.childLanes|=e,null!==i&&(i.childLanes|=e);t=t.return}}function js(t,e){Ls=t,Es=Rs=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!=(t.lanes&e)&&(ba=!0),t.firstContext=null)}function qs(t,e){if(Es!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(Es=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Rs){if(null===Ls)throw Error(W(308));Rs=e,Ls.dependencies={lanes:0,firstContext:e,responders:null}}else Rs=Rs.next=e;return t._currentValue}var Us=!1;function Js(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function Ws(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hs(t,e){if(null!==(t=t.updateQueue)){var i=(t=t.shared).pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}}function Zs(t,e){var i=t.updateQueue,n=t.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,s=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===s?r=s=o:s=s.next=o,i=i.next}while(null!==i);null===s?r=s=e:s=s.next=e}else r=s=e;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function Qs(t,e,i,n){var r=t.updateQueue;Us=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,u=l.next;l.next=null,null===o?s=u:o.next=u,o=l;var c=t.alternate;if(null!==c){var h=(c=c.updateQueue).lastBaseUpdate;h!==o&&(null===h?c.firstBaseUpdate=u:h.next=u,c.lastBaseUpdate=l)}}if(null!==s){for(h=r.baseState,o=0,c=u=l=null;;){a=s.lane;var m=s.eventTime;if((n&a)===a){null!==c&&(c=c.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var _=t,f=s;switch(a=e,m=i,f.tag){case 1:if("function"==typeof(_=f.payload)){h=_.call(m,h,a);break t}h=_;break t;case 3:_.flags=-4097&_.flags|64;case 0:if(null==(a="function"==typeof(_=f.payload)?_.call(m,h,a):_))break t;h=U({},h,a);break t;case 2:Us=!0}}null!==s.callback&&(t.flags|=32,null===(a=r.effects)?r.effects=[s]:a.push(s))}else m={eventTime:m,lane:a,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=m,l=h):c=c.next=m,o|=a;if(null===(s=s.next)){if(null===(a=r.shared.pending))break;s=a.next,a.next=null,r.lastBaseUpdate=a,r.shared.pending=null}}null===c&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,Bl|=o,t.lanes=o,t.memoizedState=h}}function $s(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var n=t[e],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!=typeof r)throw Error(W(191,r));r.call(n)}}}var Ys=(new q.Component).refs;function Ks(t,e,i,n){i=null==(i=i(n,e=t.memoizedState))?e:U({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var to={isMounted:function(t){return!!(t=t._reactInternals)&&Le(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=Zl(),r=Ql(t),s=Xs(n,r);s.payload=e,null!=i&&(s.callback=i),Hs(t,s),$l(t,r,n)},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=Zl(),r=Ql(t),s=Xs(n,r);s.tag=1,s.payload=e,null!=i&&(s.callback=i),Hs(t,s),$l(t,r,n)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Zl(),n=Ql(t),r=Xs(i,n);r.tag=2,null!=e&&(r.callback=e),Hs(t,r),$l(t,n,i)}};function eo(t,e,i,n,r,s,o){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(n,s,o):!e.prototype||!e.prototype.isPureReactComponent||(!Zn(i,n)||!Zn(r,s))}function io(t,e,i){var n=!1,r=Zr,s=e.contextType;return"object"==typeof s&&null!==s?s=qs(s):(r=ts(e)?Yr:Qr.current,s=(n=null!=(n=e.contextTypes))?Kr(t,r):Zr),e=new e(i,s),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=to,t.stateNode=e,e._reactInternals=t,n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function no(t,e,i,n){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,n),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&to.enqueueReplaceState(e,e.state,null)}function ro(t,e,i,n){var r=t.stateNode;r.props=i,r.state=t.memoizedState,r.refs=Ys,Js(t);var s=e.contextType;"object"==typeof s&&null!==s?r.context=qs(s):(s=ts(e)?Yr:Qr.current,r.context=Kr(t,s)),Qs(t,i,r,n),r.state=t.memoizedState,"function"==typeof(s=e.getDerivedStateFromProps)&&(Ks(t,e,s,i),r.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(e=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&to.enqueueReplaceState(r,r.state,null),Qs(t,i,r,n),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.flags|=4)}var so=Array.isArray;function oo(t,e,i){if(null!==(t=i.ref)&&"function"!=typeof t&&"object"!=typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(W(309));var n=i.stateNode}if(!n)throw Error(W(147,t));var r=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===r?e.ref:((e=function(t){var e=n.refs;e===Ys&&(e=n.refs={}),null===t?delete e[r]:e[r]=t})._stringRef=r,e)}if("string"!=typeof t)throw Error(W(284));if(!i._owner)throw Error(W(290,t))}return t}function ao(t,e){if("textarea"!==t.type)throw Error(W(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function lo(t){function e(e,i){if(t){var n=e.lastEffect;null!==n?(n.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i,i.nextEffect=null,i.flags=8}}function i(i,n){if(!t)return null;for(;null!==n;)e(i,n),n=n.sibling;return null}function n(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Mu(t,e)).index=0,t.sibling=null,t}function s(e,i,n){return e.index=n,t?null!==(n=e.alternate)?(n=n.index)<i?(e.flags=2,i):n:(e.flags=2,i):i}function o(e){return t&&null===e.alternate&&(e.flags=2),e}function a(t,e,i,n){return null===e||6!==e.tag?((e=Gu(i,t.mode,n)).return=t,e):((e=r(e,i)).return=t,e)}function l(t,e,i,n){return null!==e&&e.elementType===i.type?((n=r(e,i.props)).ref=oo(t,e,i),n.return=t,n):((n=Iu(i.type,i.key,i.props,null,t.mode,n)).ref=oo(t,e,i),n.return=t,n)}function u(t,e,i,n){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=Tu(i,t.mode,n)).return=t,e):((e=r(e,i.children||[])).return=t,e)}function c(t,e,i,n,s){return null===e||7!==e.tag?((e=ku(i,t.mode,n,s)).return=t,e):((e=r(e,i)).return=t,e)}function h(t,e,i){if("string"==typeof e||"number"==typeof e)return(e=Gu(""+e,t.mode,i)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case lt:return(i=Iu(e.type,e.key,e.props,null,t.mode,i)).ref=oo(t,null,e),i.return=t,i;case ut:return(e=Tu(e,t.mode,i)).return=t,e}if(so(e)||Pt(e))return(e=ku(e,t.mode,i,null)).return=t,e;ao(t,e)}return null}function m(t,e,i,n){var r=null!==e?e.key:null;if("string"==typeof i||"number"==typeof i)return null!==r?null:a(t,e,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case lt:return i.key===r?i.type===ct?c(t,e,i.props.children,n,r):l(t,e,i,n):null;case ut:return i.key===r?u(t,e,i,n):null}if(so(i)||Pt(i))return null!==r?null:c(t,e,i,n,null);ao(t,i)}return null}function _(t,e,i,n,r){if("string"==typeof n||"number"==typeof n)return a(e,t=t.get(i)||null,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case lt:return t=t.get(null===n.key?i:n.key)||null,n.type===ct?c(e,t,n.props.children,r,n.key):l(e,t,n,r);case ut:return u(e,t=t.get(null===n.key?i:n.key)||null,n,r)}if(so(n)||Pt(n))return c(e,t=t.get(i)||null,n,r,null);ao(e,n)}return null}return function(a,l,u,c){var f="object"==typeof u&&null!==u&&u.type===ct&&null===u.key;f&&(u=u.props.children);var d="object"==typeof u&&null!==u;if(d)switch(u.$$typeof){case lt:t:{for(d=u.key,f=l;null!==f;){if(f.key===d){switch(f.tag){case 7:if(u.type===ct){i(a,f.sibling),(l=r(f,u.props.children)).return=a,a=l;break t}break;default:if(f.elementType===u.type){i(a,f.sibling),(l=r(f,u.props)).ref=oo(a,f,u),l.return=a,a=l;break t}}i(a,f);break}e(a,f),f=f.sibling}u.type===ct?((l=ku(u.props.children,a.mode,c,u.key)).return=a,a=l):((c=Iu(u.type,u.key,u.props,null,a.mode,c)).ref=oo(a,l,u),c.return=a,a=c)}return o(a);case ut:t:{for(f=u.key;null!==l;){if(l.key===f){if(4===l.tag&&l.stateNode.containerInfo===u.containerInfo&&l.stateNode.implementation===u.implementation){i(a,l.sibling),(l=r(l,u.children||[])).return=a,a=l;break t}i(a,l);break}e(a,l),l=l.sibling}(l=Tu(u,a.mode,c)).return=a,a=l}return o(a)}if("string"==typeof u||"number"==typeof u)return u=""+u,null!==l&&6===l.tag?(i(a,l.sibling),(l=r(l,u)).return=a,a=l):(i(a,l),(l=Gu(u,a.mode,c)).return=a,a=l),o(a);if(so(u))return function(r,o,a,l){for(var u=null,c=null,f=o,d=o=0,p=null;null!==f&&d<a.length;d++){f.index>d?(p=f,f=null):p=f.sibling;var y=m(r,f,a[d],l);if(null===y){null===f&&(f=p);break}t&&f&&null===y.alternate&&e(r,f),o=s(y,o,d),null===c?u=y:c.sibling=y,c=y,f=p}if(d===a.length)return i(r,f),u;if(null===f){for(;d<a.length;d++)null!==(f=h(r,a[d],l))&&(o=s(f,o,d),null===c?u=f:c.sibling=f,c=f);return u}for(f=n(r,f);d<a.length;d++)null!==(p=_(f,r,d,a[d],l))&&(t&&null!==p.alternate&&f.delete(null===p.key?d:p.key),o=s(p,o,d),null===c?u=p:c.sibling=p,c=p);return t&&f.forEach((function(t){return e(r,t)})),u}(a,l,u,c);if(Pt(u))return function(r,o,a,l){var u=Pt(a);if("function"!=typeof u)throw Error(W(150));if(null==(a=u.call(a)))throw Error(W(151));for(var c=u=null,f=o,d=o=0,p=null,y=a.next();null!==f&&!y.done;d++,y=a.next()){f.index>d?(p=f,f=null):p=f.sibling;var v=m(r,f,y.value,l);if(null===v){null===f&&(f=p);break}t&&f&&null===v.alternate&&e(r,f),o=s(v,o,d),null===c?u=v:c.sibling=v,c=v,f=p}if(y.done)return i(r,f),u;if(null===f){for(;!y.done;d++,y=a.next())null!==(y=h(r,y.value,l))&&(o=s(y,o,d),null===c?u=y:c.sibling=y,c=y);return u}for(f=n(r,f);!y.done;d++,y=a.next())null!==(y=_(f,r,d,y.value,l))&&(t&&null!==y.alternate&&f.delete(null===y.key?d:y.key),o=s(y,o,d),null===c?u=y:c.sibling=y,c=y);return t&&f.forEach((function(t){return e(r,t)})),u}(a,l,u,c);if(d&&ao(a,u),void 0===u&&!f)switch(a.tag){case 1:case 22:case 0:case 11:case 15:throw Error(W(152,Gt(a.type)||"Component"))}return i(a,l)}}var uo=lo(!0),co=lo(!1),ho={},mo=Wr(ho),_o=Wr(ho),fo=Wr(ho);function po(t){if(t===ho)throw Error(W(174));return t}function yo(t,e){switch(Hr(fo,e),Hr(_o,t),Hr(mo,ho),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:te(null,"");break;default:e=te(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Xr(mo),Hr(mo,e)}function vo(){Xr(mo),Xr(_o),Xr(fo)}function go(t){po(fo.current);var e=po(mo.current),i=te(e,t.type);e!==i&&(Hr(_o,t),Hr(mo,i))}function bo(t){_o.current===t&&(Xr(mo),Xr(_o))}var xo=Wr(0);function So(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wo=null,Bo=null,Co=!1;function Ao(t,e){var i=Vu(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=e,i.return=t,i.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i}function Vo(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Po(t){if(Co){var e=Bo;if(e){var i=e;if(!Vo(t,e)){if(!(e=kr(i.nextSibling))||!Vo(t,e))return t.flags=-1025&t.flags|2,Co=!1,void(wo=t);Ao(wo,i)}wo=t,Bo=kr(e.firstChild)}else t.flags=-1025&t.flags|2,Co=!1,wo=t}}function Mo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;wo=t}function Io(t){if(t!==wo)return!1;if(!Co)return Mo(t),Co=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!Vr(e,t.memoizedProps))for(e=Bo;e;)Ao(t,e),e=kr(e.nextSibling);if(Mo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(W(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){Bo=kr(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}Bo=null}}else Bo=wo?kr(t.stateNode.nextSibling):null;return!0}function ko(){Bo=wo=null,Co=!1}var Do=[];function Go(){for(var t=0;t<Do.length;t++)Do[t]._workInProgressVersionPrimary=null;Do.length=0}var To=at.ReactCurrentDispatcher,Fo=at.ReactCurrentBatchConfig,Lo=0,Ro=null,Eo=null,zo=null,Oo=!1,No=!1;function jo(){throw Error(W(321))}function qo(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!Xn(t[i],e[i]))return!1;return!0}function Uo(t,e,i,n,r,s){if(Lo=s,Ro=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,To.current=null===t||null===t.memoizedState?pa:ya,t=i(n,r),No){s=0;do{if(No=!1,!(25>s))throw Error(W(301));s+=1,zo=Eo=null,e.updateQueue=null,To.current=va,t=i(n,r)}while(No)}if(To.current=da,e=null!==Eo&&null!==Eo.next,Lo=0,zo=Eo=Ro=null,Oo=!1,e)throw Error(W(300));return t}function Jo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===zo?Ro.memoizedState=zo=t:zo=zo.next=t,zo}function Wo(){if(null===Eo){var t=Ro.alternate;t=null!==t?t.memoizedState:null}else t=Eo.next;var e=null===zo?Ro.memoizedState:zo.next;if(null!==e)zo=e,Eo=t;else{if(null===t)throw Error(W(310));t={memoizedState:(Eo=t).memoizedState,baseState:Eo.baseState,baseQueue:Eo.baseQueue,queue:Eo.queue,next:null},null===zo?Ro.memoizedState=zo=t:zo=zo.next=t}return zo}function Xo(t,e){return"function"==typeof e?e(t):e}function Ho(t){var e=Wo(),i=e.queue;if(null===i)throw Error(W(311));i.lastRenderedReducer=t;var n=Eo,r=n.baseQueue,s=i.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(null!==r){r=r.next,n=n.baseState;var a=o=s=null,l=r;do{var u=l.lane;if((Lo&u)===u)null!==a&&(a=a.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),n=l.eagerReducer===t?l.eagerState:t(n,l.action);else{var c={lane:u,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===a?(o=a=c,s=n):a=a.next=c,Ro.lanes|=u,Bl|=u}l=l.next}while(null!==l&&l!==r);null===a?s=n:a.next=o,Xn(n,e.memoizedState)||(ba=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=a,i.lastRenderedState=n}return[e.memoizedState,i.dispatch]}function Zo(t){var e=Wo(),i=e.queue;if(null===i)throw Error(W(311));i.lastRenderedReducer=t;var n=i.dispatch,r=i.pending,s=e.memoizedState;if(null!==r){i.pending=null;var o=r=r.next;do{s=t(s,o.action),o=o.next}while(o!==r);Xn(s,e.memoizedState)||(ba=!0),e.memoizedState=s,null===e.baseQueue&&(e.baseState=s),i.lastRenderedState=s}return[s,n]}function Qo(t,e,i){var n=e._getVersion;n=n(e._source);var r=e._workInProgressVersionPrimary;if(null!==r?t=r===n:(t=t.mutableReadLanes,(t=(Lo&t)===t)&&(e._workInProgressVersionPrimary=n,Do.push(e))),t)return i(e._source);throw Do.push(e),Error(W(350))}function $o(t,e,i,n){var r=pl;if(null===r)throw Error(W(349));var s=e._getVersion,o=s(e._source),a=To.current,l=a.useState((function(){return Qo(r,e,i)})),u=l[1],c=l[0];l=zo;var h=t.memoizedState,m=h.refs,_=m.getSnapshot,f=h.source;h=h.subscribe;var d=Ro;return t.memoizedState={refs:m,source:e,subscribe:n},a.useEffect((function(){m.getSnapshot=i,m.setSnapshot=u;var t=s(e._source);if(!Xn(o,t)){t=i(e._source),Xn(c,t)||(u(t),t=Ql(d),r.mutableReadLanes|=t&r.pendingLanes),t=r.mutableReadLanes,r.entangledLanes|=t;for(var n=r.entanglements,a=t;0<a;){var l=31-Ii(a),h=1<<l;n[l]|=t,a&=~h}}}),[i,e,n]),a.useEffect((function(){return n(e._source,(function(){var t=m.getSnapshot,i=m.setSnapshot;try{i(t(e._source));var n=Ql(d);r.mutableReadLanes|=n&r.pendingLanes}catch(s){i((function(){throw s}))}}))}),[e,n]),Xn(_,i)&&Xn(f,e)&&Xn(h,n)||((t={pending:null,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:c}).dispatch=u=fa.bind(null,Ro,t),l.queue=t,l.baseQueue=null,c=Qo(r,e,i),l.memoizedState=l.baseState=c),c}function Yo(t,e,i){return $o(Wo(),t,e,i)}function Ko(t){var e=Jo();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:t}).dispatch=fa.bind(null,Ro,t),[e.memoizedState,t]}function ta(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},null===(e=Ro.updateQueue)?(e={lastEffect:null},Ro.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t),t}function ea(t){return t={current:t},Jo().memoizedState=t}function ia(){return Wo().memoizedState}function na(t,e,i,n){var r=Jo();Ro.flags|=t,r.memoizedState=ta(1|e,i,void 0,void 0===n?null:n)}function ra(t,e,i,n){var r=Wo();n=void 0===n?null:n;var s=void 0;if(null!==Eo){var o=Eo.memoizedState;if(s=o.destroy,null!==n&&qo(n,o.deps))return void ta(e,i,s,n)}Ro.flags|=t,r.memoizedState=ta(1|e,i,s,n)}function sa(t,e){return na(516,4,t,e)}function oa(t,e){return ra(516,4,t,e)}function aa(t,e){return ra(4,2,t,e)}function la(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function ua(t,e,i){return i=null!=i?i.concat([t]):null,ra(4,2,la.bind(null,e,t),i)}function ca(){}function ha(t,e){var i=Wo();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&qo(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function ma(t,e){var i=Wo();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&qo(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function _a(t,e){var i=Vs();Ms(98>i?98:i,(function(){t(!0)})),Ms(97<i?97:i,(function(){var i=Fo.transition;Fo.transition=1;try{t(!1),e()}finally{Fo.transition=i}}))}function fa(t,e,i){var n=Zl(),r=Ql(t),s={lane:r,action:i,eagerReducer:null,eagerState:null,next:null},o=e.pending;if(null===o?s.next=s:(s.next=o.next,o.next=s),e.pending=s,o=t.alternate,t===Ro||null!==o&&o===Ro)No=Oo=!0;else{if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,l=o(a,i);if(s.eagerReducer=o,s.eagerState=l,Xn(l,a))return}catch(u){}$l(t,r,n)}}var da={readContext:qs,useCallback:jo,useContext:jo,useEffect:jo,useImperativeHandle:jo,useLayoutEffect:jo,useMemo:jo,useReducer:jo,useRef:jo,useState:jo,useDebugValue:jo,useDeferredValue:jo,useTransition:jo,useMutableSource:jo,useOpaqueIdentifier:jo,unstable_isNewReconciler:!1},pa={readContext:qs,useCallback:function(t,e){return Jo().memoizedState=[t,void 0===e?null:e],t},useContext:qs,useEffect:sa,useImperativeHandle:function(t,e,i){return i=null!=i?i.concat([t]):null,na(4,2,la.bind(null,e,t),i)},useLayoutEffect:function(t,e){return na(4,2,t,e)},useMemo:function(t,e){var i=Jo();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=Jo();return e=void 0!==i?i(e):e,n.memoizedState=n.baseState=e,t=(t=n.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=fa.bind(null,Ro,t),[n.memoizedState,t]},useRef:ea,useState:Ko,useDebugValue:ca,useDeferredValue:function(t){var e=Ko(t),i=e[0],n=e[1];return sa((function(){var e=Fo.transition;Fo.transition=1;try{n(t)}finally{Fo.transition=e}}),[t]),i},useTransition:function(){var t=Ko(!1),e=t[0];return ea(t=_a.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,i){var n=Jo();return n.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:i},$o(n,t,e,i)},useOpaqueIdentifier:function(){if(Co){var t=!1,e=function(t){return{$$typeof:xt,toString:t,valueOf:t}}((function(){throw t||(t=!0,i("r:"+(Gr++).toString(36))),Error(W(355))})),i=Ko(e)[1];return 0==(2&Ro.mode)&&(Ro.flags|=516,ta(5,(function(){i("r:"+(Gr++).toString(36))}),void 0,null)),e}return Ko(e="r:"+(Gr++).toString(36)),e},unstable_isNewReconciler:!1},ya={readContext:qs,useCallback:ha,useContext:qs,useEffect:oa,useImperativeHandle:ua,useLayoutEffect:aa,useMemo:ma,useReducer:Ho,useRef:ia,useState:function(){return Ho(Xo)},useDebugValue:ca,useDeferredValue:function(t){var e=Ho(Xo),i=e[0],n=e[1];return oa((function(){var e=Fo.transition;Fo.transition=1;try{n(t)}finally{Fo.transition=e}}),[t]),i},useTransition:function(){var t=Ho(Xo)[0];return[ia().current,t]},useMutableSource:Yo,useOpaqueIdentifier:function(){return Ho(Xo)[0]},unstable_isNewReconciler:!1},va={readContext:qs,useCallback:ha,useContext:qs,useEffect:oa,useImperativeHandle:ua,useLayoutEffect:aa,useMemo:ma,useReducer:Zo,useRef:ia,useState:function(){return Zo(Xo)},useDebugValue:ca,useDeferredValue:function(t){var e=Zo(Xo),i=e[0],n=e[1];return oa((function(){var e=Fo.transition;Fo.transition=1;try{n(t)}finally{Fo.transition=e}}),[t]),i},useTransition:function(){var t=Zo(Xo)[0];return[ia().current,t]},useMutableSource:Yo,useOpaqueIdentifier:function(){return Zo(Xo)[0]},unstable_isNewReconciler:!1},ga=at.ReactCurrentOwner,ba=!1;function xa(t,e,i,n){e.child=null===t?co(e,null,i,n):uo(e,t.child,i,n)}function Sa(t,e,i,n,r){i=i.render;var s=e.ref;return js(e,r),n=Uo(t,e,i,n,s,r),null===t||ba?(e.flags|=1,xa(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,ja(t,e,r))}function wa(t,e,i,n,r,s){if(null===t){var o=i.type;return"function"!=typeof o||Pu(o)||void 0!==o.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=Iu(i.type,null,n,e,e.mode,s)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Ba(t,e,o,n,r,s))}return o=t.child,0==(r&s)&&(r=o.memoizedProps,(i=null!==(i=i.compare)?i:Zn)(r,n)&&t.ref===e.ref)?ja(t,e,s):(e.flags|=1,(t=Mu(o,n)).ref=e.ref,t.return=e,e.child=t)}function Ba(t,e,i,n,r,s){if(null!==t&&Zn(t.memoizedProps,n)&&t.ref===e.ref){if(ba=!1,0==(s&r))return e.lanes=t.lanes,ja(t,e,s);0!=(16384&t.flags)&&(ba=!0)}return Va(t,e,i,n,s)}function Ca(t,e,i){var n=e.pendingProps,r=n.children,s=null!==t?t.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(0==(4&e.mode))e.memoizedState={baseLanes:0},su(e,i);else{if(0==(1073741824&i))return t=null!==s?s.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},su(e,t),null;e.memoizedState={baseLanes:0},su(e,null!==s?s.baseLanes:i)}else null!==s?(n=s.baseLanes|i,e.memoizedState=null):n=i,su(e,n);return xa(t,e,r,i),e.child}function Aa(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=128)}function Va(t,e,i,n,r){var s=ts(i)?Yr:Qr.current;return s=Kr(e,s),js(e,r),i=Uo(t,e,i,n,s,r),null===t||ba?(e.flags|=1,xa(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,ja(t,e,r))}function Pa(t,e,i,n,r){if(ts(i)){var s=!0;rs(e)}else s=!1;if(js(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),io(e,i,n),ro(e,i,n,r),n=!0;else if(null===t){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=i.contextType;"object"==typeof u&&null!==u?u=qs(u):u=Kr(e,u=ts(i)?Yr:Qr.current);var c=i.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==n||l!==u)&&no(e,o,n,u),Us=!1;var m=e.memoizedState;o.state=m,Qs(e,n,o,r),l=e.memoizedState,a!==n||m!==l||$r.current||Us?("function"==typeof c&&(Ks(e,i,c,n),l=e.memoizedState),(a=Us||eo(e,i,a,n,m,l,u))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(e.flags|=4)):("function"==typeof o.componentDidMount&&(e.flags|=4),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):("function"==typeof o.componentDidMount&&(e.flags|=4),n=!1)}else{o=e.stateNode,Ws(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ts(e.type,a),o.props=u,h=e.pendingProps,m=o.context,"object"==typeof(l=i.contextType)&&null!==l?l=qs(l):l=Kr(e,l=ts(i)?Yr:Qr.current);var _=i.getDerivedStateFromProps;(c="function"==typeof _||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==h||m!==l)&&no(e,o,n,l),Us=!1,m=e.memoizedState,o.state=m,Qs(e,n,o,r);var f=e.memoizedState;a!==h||m!==f||$r.current||Us?("function"==typeof _&&(Ks(e,i,_,n),f=e.memoizedState),(u=Us||eo(e,i,u,n,m,f,l))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(n,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,f,l)),"function"==typeof o.componentDidUpdate&&(e.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!=typeof o.componentDidUpdate||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=256),e.memoizedProps=n,e.memoizedState=f),o.props=n,o.state=f,o.context=l,n=u):("function"!=typeof o.componentDidUpdate||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=256),n=!1)}return Ma(t,e,i,n,s,r)}function Ma(t,e,i,n,r,s){Aa(t,e);var o=0!=(64&e.flags);if(!n&&!o)return r&&ss(e,i,!1),ja(t,e,s);n=e.stateNode,ga.current=e;var a=o&&"function"!=typeof i.getDerivedStateFromError?null:n.render();return e.flags|=1,null!==t&&o?(e.child=uo(e,t.child,null,s),e.child=uo(e,null,a,s)):xa(t,e,a,s),e.memoizedState=n.state,r&&ss(e,i,!0),e.child}function Ia(t){var e=t.stateNode;e.pendingContext?is(0,e.pendingContext,e.pendingContext!==e.context):e.context&&is(0,e.context,!1),yo(t,e.containerInfo)}var ka,Da,Ga,Ta={dehydrated:null,retryLane:0};function Fa(t,e,i){var n,r=e.pendingProps,s=xo.current,o=!1;return(n=0!=(64&e.flags))||(n=(null===t||null!==t.memoizedState)&&0!=(2&s)),n?(o=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===r.fallback||!0===r.unstable_avoidThisFallback||(s|=1),Hr(xo,1&s),null===t?(void 0!==r.fallback&&Po(e),t=r.children,s=r.fallback,o?(t=La(e,t,s,i),e.child.memoizedState={baseLanes:i},e.memoizedState=Ta,t):"number"==typeof r.unstable_expectedLoadTime?(t=La(e,t,s,i),e.child.memoizedState={baseLanes:i},e.memoizedState=Ta,e.lanes=33554432,t):((i=Du({mode:"visible",children:t},e.mode,i,null)).return=e,e.child=i)):(t.memoizedState,o?(r=Ea(t,e,r.children,r.fallback,i),o=e.child,s=t.child.memoizedState,o.memoizedState=null===s?{baseLanes:i}:{baseLanes:s.baseLanes|i},o.childLanes=t.childLanes&~i,e.memoizedState=Ta,r):(i=Ra(t,e,r.children,i),e.memoizedState=null,i))}function La(t,e,i,n){var r=t.mode,s=t.child;return e={mode:"hidden",children:e},0==(2&r)&&null!==s?(s.childLanes=0,s.pendingProps=e):s=Du(e,r,0,null),i=ku(i,r,n,null),s.return=t,i.return=t,s.sibling=i,t.child=s,i}function Ra(t,e,i,n){var r=t.child;return t=r.sibling,i=Mu(r,{mode:"visible",children:i}),0==(2&e.mode)&&(i.lanes=n),i.return=e,i.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=i}function Ea(t,e,i,n,r){var s=e.mode,o=t.child;t=o.sibling;var a={mode:"hidden",children:i};return 0==(2&s)&&e.child!==o?((i=e.child).childLanes=0,i.pendingProps=a,null!==(o=i.lastEffect)?(e.firstEffect=i.firstEffect,e.lastEffect=o,o.nextEffect=null):e.firstEffect=e.lastEffect=null):i=Mu(o,a),null!==t?n=Mu(t,n):(n=ku(n,s,r,null)).flags|=2,n.return=e,i.return=e,i.sibling=n,e.child=i,n}function za(t,e){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),Ns(t.return,e)}function Oa(t,e,i,n,r,s){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r,lastEffect:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailMode=r,o.lastEffect=s)}function Na(t,e,i){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(xa(t,e,n.children,i),0!=(2&(n=xo.current)))n=1&n|2,e.flags|=64;else{if(null!==t&&0!=(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&za(t,i);else if(19===t.tag)za(t,i);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Hr(xo,n),0==(2&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(i=e.child,r=null;null!==i;)null!==(t=i.alternate)&&null===So(t)&&(r=i),i=i.sibling;null===(i=r)?(r=e.child,e.child=null):(r=i.sibling,i.sibling=null),Oa(e,!1,r,i,s,e.lastEffect);break;case"backwards":for(i=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===So(t)){e.child=r;break}t=r.sibling,r.sibling=i,i=r,r=t}Oa(e,!0,i,null,s,e.lastEffect);break;case"together":Oa(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function ja(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Bl|=e.lanes,0!=(i&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(W(153));if(null!==e.child){for(i=Mu(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Mu(t,t.pendingProps)).return=e;i.sibling=null}return e.child}return null}function qa(t,e){if(!Co)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?e||null===t.tail?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ua(t,e,i){var n=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ts(e.type)&&es(),null;case 3:return vo(),Xr($r),Xr(Qr),Go(),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||(Io(e)?e.flags|=4:n.hydrate||(e.flags|=256)),null;case 5:bo(e);var r=po(fo.current);if(i=e.type,null!==t&&null!=e.stateNode)Da(t,e,i,n),t.ref!==e.ref&&(e.flags|=128);else{if(!n){if(null===e.stateNode)throw Error(W(166));return null}if(t=po(mo.current),Io(e)){n=e.stateNode,i=e.type;var s=e.memoizedProps;switch(n[Fr]=e,n[Lr]=s,i){case"dialog":_r("cancel",n),_r("close",n);break;case"iframe":case"object":case"embed":_r("load",n);break;case"video":case"audio":for(t=0;t<ur.length;t++)_r(ur[t],n);break;case"source":_r("error",n);break;case"img":case"image":case"link":_r("error",n),_r("load",n);break;case"details":_r("toggle",n);break;case"input":Ot(n,s),_r("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},_r("invalid",n);break;case"textarea":Ht(n,s),_r("invalid",n)}for(var o in ce(i,s),t=null,s)s.hasOwnProperty(o)&&(r=s[o],"children"===o?"string"==typeof r?n.textContent!==r&&(t=["children",r]):"number"==typeof r&&n.textContent!==""+r&&(t=["children",""+r]):H.hasOwnProperty(o)&&null!=r&&"onScroll"===o&&_r("scroll",n));switch(i){case"input":Lt(n),qt(n,s,!0);break;case"textarea":Lt(n),Qt(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=wr)}n=t,e.updateQueue=n,null!==n&&(e.flags|=4)}else{switch(o=9===r.nodeType?r:r.ownerDocument,t===$t&&(t=Kt(i)),t===$t?"script"===i?((t=o.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof n.is?t=o.createElement(i,{is:n.is}):(t=o.createElement(i),"select"===i&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,i),t[Fr]=e,t[Lr]=n,ka(t,e),e.stateNode=t,o=he(i,n),i){case"dialog":_r("cancel",t),_r("close",t),r=n;break;case"iframe":case"object":case"embed":_r("load",t),r=n;break;case"video":case"audio":for(r=0;r<ur.length;r++)_r(ur[r],t);r=n;break;case"source":_r("error",t),r=n;break;case"img":case"image":case"link":_r("error",t),_r("load",t),r=n;break;case"details":_r("toggle",t),r=n;break;case"input":Ot(t,n),r=zt(t,n),_r("invalid",t);break;case"option":r=Jt(t,n);break;case"select":t._wrapperState={wasMultiple:!!n.multiple},r=U({},n,{value:void 0}),_r("invalid",t);break;case"textarea":Ht(t,n),r=Xt(t,n),_r("invalid",t);break;default:r=n}ce(i,r);var a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];"style"===s?le(t,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&ne(t,l):"children"===s?"string"==typeof l?("textarea"!==i||""!==l)&&re(t,l):"number"==typeof l&&re(t,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(H.hasOwnProperty(s)?null!=l&&"onScroll"===s&&_r("scroll",t):null!=l&&ot(t,s,l,o))}switch(i){case"input":Lt(t),qt(t,n,!1);break;case"textarea":Lt(t),Qt(t);break;case"option":null!=n.value&&t.setAttribute("value",""+Tt(n.value));break;case"select":t.multiple=!!n.multiple,null!=(s=n.value)?Wt(t,!!n.multiple,s,!1):null!=n.defaultValue&&Wt(t,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof r.onClick&&(t.onclick=wr)}Ar(i,n)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)Ga(0,e,t.memoizedProps,n);else{if("string"!=typeof n&&null===e.stateNode)throw Error(W(166));i=po(fo.current),po(mo.current),Io(e)?(n=e.stateNode,i=e.memoizedProps,n[Fr]=e,n.nodeValue!==i&&(e.flags|=4)):((n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[Fr]=e,e.stateNode=n)}return null;case 13:return Xr(xo),n=e.memoizedState,0!=(64&e.flags)?(e.lanes=i,e):(n=null!==n,i=!1,null===t?void 0!==e.memoizedProps.fallback&&Io(e):i=null!==t.memoizedState,n&&!i&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&xo.current)?0===xl&&(xl=3):(0!==xl&&3!==xl||(xl=4),null===pl||0==(134217727&Bl)&&0==(134217727&Cl)||eu(pl,vl))),(n||i)&&(e.flags|=4),null);case 4:return vo(),null===t&&dr(e.stateNode.containerInfo),null;case 10:return Os(e),null;case 17:return ts(e.type)&&es(),null;case 19:if(Xr(xo),null===(n=e.memoizedState))return null;if(s=0!=(64&e.flags),null===(o=n.rendering))if(s)qa(n,!1);else{if(0!==xl||null!==t&&0!=(64&t.flags))for(t=e.child;null!==t;){if(null!==(o=So(t))){for(e.flags|=64,qa(n,!1),null!==(s=o.updateQueue)&&(e.updateQueue=s,e.flags|=4),null===n.lastEffect&&(e.firstEffect=null),e.lastEffect=n.lastEffect,n=i,i=e.child;null!==i;)t=n,(s=i).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(o=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Hr(xo,1&xo.current|2),e.child}t=t.sibling}null!==n.tail&&As()>Ml&&(e.flags|=64,s=!0,qa(n,!1),e.lanes=33554432)}else{if(!s)if(null!==(t=So(o))){if(e.flags|=64,s=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),qa(n,!0),null===n.tail&&"hidden"===n.tailMode&&!o.alternate&&!Co)return null!==(e=e.lastEffect=n.lastEffect)&&(e.nextEffect=null),null}else 2*As()-n.renderingStartTime>Ml&&1073741824!==i&&(e.flags|=64,s=!0,qa(n,!1),e.lanes=33554432);n.isBackwards?(o.sibling=e.child,e.child=o):(null!==(i=n.last)?i.sibling=o:e.child=o,n.last=o)}return null!==n.tail?(i=n.tail,n.rendering=i,n.tail=i.sibling,n.lastEffect=e.lastEffect,n.renderingStartTime=As(),i.sibling=null,e=xo.current,Hr(xo,s?1&e|2:1&e),i):null;case 23:case 24:return ou(),null!==t&&null!==t.memoizedState!=(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(e.flags|=4),null}throw Error(W(156,e.tag))}function Ja(t){switch(t.tag){case 1:ts(t.type)&&es();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(vo(),Xr($r),Xr(Qr),Go(),0!=(64&(e=t.flags)))throw Error(W(285));return t.flags=-4097&e|64,t;case 5:return bo(t),null;case 13:return Xr(xo),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return Xr(xo),null;case 4:return vo(),null;case 10:return Os(t),null;case 23:case 24:return ou(),null;default:return null}}function Wa(t,e){try{var i="",n=e;do{i+=Dt(n),n=n.return}while(n);var r=i}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:t,source:e,stack:r}}function Xa(t,e){try{console.error(e.value)}catch(i){setTimeout((function(){throw i}))}}ka=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Da=function(t,e,i,n){var r=t.memoizedProps;if(r!==n){t=e.stateNode,po(mo.current);var s,o=null;switch(i){case"input":r=zt(t,r),n=zt(t,n),o=[];break;case"option":r=Jt(t,r),n=Jt(t,n),o=[];break;case"select":r=U({},r,{value:void 0}),n=U({},n,{value:void 0}),o=[];break;case"textarea":r=Xt(t,r),n=Xt(t,n),o=[];break;default:"function"!=typeof r.onClick&&"function"==typeof n.onClick&&(t.onclick=wr)}for(u in ce(i,n),i=null,r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var a=r[u];for(s in a)a.hasOwnProperty(s)&&(i||(i={}),i[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(H.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var l=n[u];if(a=null!=r?r[u]:void 0,n.hasOwnProperty(u)&&l!==a&&(null!=l||null!=a))if("style"===u)if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(i||(i={}),i[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(i||(i={}),i[s]=l[s])}else i||(o||(o=[]),o.push(u,i)),i=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!=typeof l&&"number"!=typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(H.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&_r("scroll",t),o||a===l||(o=[])):"object"==typeof l&&null!==l&&l.$$typeof===xt?l.toString():(o=o||[]).push(u,l))}i&&(o=o||[]).push("style",i);var u=o;(e.updateQueue=u)&&(e.flags|=4)}},Ga=function(t,e,i,n){i!==n&&(e.flags|=4)};var Ha="function"==typeof WeakMap?WeakMap:Map;function Za(t,e,i){(i=Xs(-1,i)).tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){Gl||(Gl=!0,Tl=n),Xa(0,e)},i}function Qa(t,e,i){(i=Xs(-1,i)).tag=3;var n=t.type.getDerivedStateFromError;if("function"==typeof n){var r=e.value;i.payload=function(){return Xa(0,e),n(r)}}var s=t.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(i.callback=function(){"function"!=typeof n&&(null===Fl?Fl=new Set([this]):Fl.add(this),Xa(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}var $a="function"==typeof WeakSet?WeakSet:Set;function Ya(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(i){wu(t,i)}else e.current=null}function Ka(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.flags&&null!==t){var i=t.memoizedProps,n=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?i:Ts(e.type,i),n),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Ir(e.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(W(163))}function tl(t,e,i){switch(i.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=i.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3==(3&t.tag)){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=i.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var r=t;n=r.next,0!=(4&(r=r.tag))&&0!=(1&r)&&(bu(i,t),gu(i,t)),t=n}while(t!==e)}return;case 1:return t=i.stateNode,4&i.flags&&(null===e?t.componentDidMount():(n=i.elementType===i.type?e.memoizedProps:Ts(i.type,e.memoizedProps),t.componentDidUpdate(n,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=i.updateQueue)&&$s(i,e,t));case 3:if(null!==(e=i.updateQueue)){if(t=null,null!==i.child)switch(i.child.tag){case 5:t=i.child.stateNode;break;case 1:t=i.child.stateNode}$s(i,e,t)}return;case 5:return t=i.stateNode,void(null===e&&4&i.flags&&Ar(i.type,i.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===i.memoizedState&&(i=i.alternate,null!==i&&(i=i.memoizedState,null!==i&&(i=i.dehydrated,null!==i&&li(i)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(W(163))}function el(t,e){for(var i=t;;){if(5===i.tag){var n=i.stateNode;if(e)"function"==typeof(n=n.style).setProperty?n.setProperty("display","none","important"):n.display="none";else{n=i.stateNode;var r=i.memoizedProps.style;r=null!=r&&r.hasOwnProperty("display")?r.display:null,n.style.display=ae("display",r)}}else if(6===i.tag)i.stateNode.nodeValue=e?"":i.memoizedProps;else if((23!==i.tag&&24!==i.tag||null===i.memoizedState||i===t)&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function il(t,e){if(as&&"function"==typeof as.onCommitFiberUnmount)try{as.onCommitFiberUnmount(os,e)}catch(s){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var i=t=t.next;do{var n=i,r=n.destroy;if(n=n.tag,void 0!==r)if(0!=(4&n))bu(e,i);else{n=e;try{r()}catch(s){wu(n,s)}}i=i.next}while(i!==t)}break;case 1:if(Ya(e),"function"==typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(s){wu(e,s)}break;case 5:Ya(e);break;case 4:ll(t,e)}}function nl(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function rl(t){return 5===t.tag||3===t.tag||4===t.tag}function sl(t){t:{for(var e=t.return;null!==e;){if(rl(e))break t;e=e.return}throw Error(W(160))}var i=e;switch(e=i.stateNode,i.tag){case 5:var n=!1;break;case 3:case 4:e=e.containerInfo,n=!0;break;default:throw Error(W(161))}16&i.flags&&(re(e,""),i.flags&=-17);t:e:for(i=t;;){for(;null===i.sibling;){if(null===i.return||rl(i.return)){i=null;break t}i=i.return}for(i.sibling.return=i.return,i=i.sibling;5!==i.tag&&6!==i.tag&&18!==i.tag;){if(2&i.flags)continue e;if(null===i.child||4===i.tag)continue e;i.child.return=i,i=i.child}if(!(2&i.flags)){i=i.stateNode;break t}}n?ol(t,i,e):al(t,i,e)}function ol(t,e,i){var n=t.tag,r=5===n||6===n;if(r)t=r?t.stateNode:t.stateNode.instance,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!=(i=i._reactRootContainer)||null!==e.onclick||(e.onclick=wr));else if(4!==n&&null!==(t=t.child))for(ol(t,e,i),t=t.sibling;null!==t;)ol(t,e,i),t=t.sibling}function al(t,e,i){var n=t.tag,r=5===n||6===n;if(r)t=r?t.stateNode:t.stateNode.instance,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==n&&null!==(t=t.child))for(al(t,e,i),t=t.sibling;null!==t;)al(t,e,i),t=t.sibling}function ll(t,e){for(var i,n,r=e,s=!1;;){if(!s){s=r.return;t:for(;;){if(null===s)throw Error(W(160));switch(i=s.stateNode,s.tag){case 5:n=!1;break t;case 3:case 4:i=i.containerInfo,n=!0;break t}s=s.return}s=!0}if(5===r.tag||6===r.tag){t:for(var o=t,a=r,l=a;;)if(il(o,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===a)break t;for(;null===l.sibling;){if(null===l.return||l.return===a)break t;l=l.return}l.sibling.return=l.return,l=l.sibling}n?(o=i,a=r.stateNode,8===o.nodeType?o.parentNode.removeChild(a):o.removeChild(a)):i.removeChild(r.stateNode)}else if(4===r.tag){if(null!==r.child){i=r.stateNode.containerInfo,n=!0,r.child.return=r,r=r.child;continue}}else if(il(t,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;4===(r=r.return).tag&&(s=!1)}r.sibling.return=r.return,r=r.sibling}}function ul(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var n=i=i.next;do{3==(3&n.tag)&&(t=n.destroy,n.destroy=void 0,void 0!==t&&t()),n=n.next}while(n!==i)}return;case 1:return;case 5:if(null!=(i=e.stateNode)){n=e.memoizedProps;var r=null!==t?t.memoizedProps:n;t=e.type;var s=e.updateQueue;if(e.updateQueue=null,null!==s){for(i[Lr]=n,"input"===t&&"radio"===n.type&&null!=n.name&&Nt(i,n),he(t,r),e=he(t,n),r=0;r<s.length;r+=2){var o=s[r],a=s[r+1];"style"===o?le(i,a):"dangerouslySetInnerHTML"===o?ne(i,a):"children"===o?re(i,a):ot(i,o,a,e)}switch(t){case"input":jt(i,n);break;case"textarea":Zt(i,n);break;case"select":t=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!n.multiple,null!=(s=n.value)?Wt(i,!!n.multiple,s,!1):t!==!!n.multiple&&(null!=n.defaultValue?Wt(i,!!n.multiple,n.defaultValue,!0):Wt(i,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(W(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((i=e.stateNode).hydrate&&(i.hydrate=!1,li(i.containerInfo)));case 12:return;case 13:return null!==e.memoizedState&&(Pl=As(),el(e.child,!0)),void cl(e);case 19:return void cl(e);case 17:return;case 23:case 24:return void el(e,null!==e.memoizedState)}throw Error(W(163))}function cl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new $a),e.forEach((function(e){var n=Cu.bind(null,t,e);i.has(e)||(i.add(e),e.then(n,n))}))}}function hl(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var ml=Math.ceil,_l=at.ReactCurrentDispatcher,fl=at.ReactCurrentOwner,dl=0,pl=null,yl=null,vl=0,gl=0,bl=Wr(0),xl=0,Sl=null,wl=0,Bl=0,Cl=0,Al=0,Vl=null,Pl=0,Ml=1/0;function Il(){Ml=As()+500}var kl,Dl=null,Gl=!1,Tl=null,Fl=null,Ll=!1,Rl=null,El=90,zl=[],Ol=[],Nl=null,jl=0,ql=null,Ul=-1,Jl=0,Wl=0,Xl=null,Hl=!1;function Zl(){return 0!=(48&dl)?As():-1!==Ul?Ul:Ul=As()}function Ql(t){if(0==(2&(t=t.mode)))return 1;if(0==(4&t))return 99===Vs()?1:2;if(0===Jl&&(Jl=wl),0!==Gs.transition){0!==Wl&&(Wl=null!==Vl?Vl.pendingLanes:0),t=Jl;var e=4186112&~Wl;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=Vs(),0!=(4&dl)&&98===t?t=Ai(12,Jl):t=Ai(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),Jl),t}function $l(t,e,i){if(50<jl)throw jl=0,ql=null,Error(W(185));if(null===(t=Yl(t,e)))return null;Mi(t,e,i),t===pl&&(Cl|=e,4===xl&&eu(t,vl));var n=Vs();1===e?0!=(8&dl)&&0==(48&dl)?iu(t):(Kl(t,i),0===dl&&(Il(),ks())):(0==(4&dl)||98!==n&&99!==n||(null===Nl?Nl=new Set([t]):Nl.add(t)),Kl(t,i)),Vl=t}function Yl(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}function Kl(t,e){for(var i=t.callbackNode,n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Ii(o),l=1<<a,u=s[a];if(-1===u){if(0==(l&n)||0!=(l&r)){u=e,wi(l);var c=Si;s[a]=10<=c?u+250:6<=c?u+5e3:-1}}else u<=e&&(t.expiredLanes|=l);o&=~l}if(n=Bi(t,t===pl?vl:0),e=Si,0===n)null!==i&&(i!==bs&&cs(i),t.callbackNode=null,t.callbackPriority=0);else{if(null!==i){if(t.callbackPriority===e)return;i!==bs&&cs(i)}15===e?(i=iu.bind(null,t),null===Ss?(Ss=[i],ws=us(ds,Ds)):Ss.push(i),i=bs):14===e?i=Is(99,iu.bind(null,t)):i=Is(i=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(W(358,t))}}(e),tu.bind(null,t)),t.callbackPriority=e,t.callbackNode=i}}function tu(t){if(Ul=-1,Wl=Jl=0,0!=(48&dl))throw Error(W(327));var e=t.callbackNode;if(vu()&&t.callbackNode!==e)return null;var i=Bi(t,t===pl?vl:0);if(0===i)return null;var n=i,r=dl;dl|=16;var s=uu();for(pl===t&&vl===n||(Il(),au(t,n));;)try{mu();break}catch(Zc){lu(t,Zc)}if(zs(),_l.current=s,dl=r,null!==yl?n=0:(pl=null,vl=0,n=xl),0!=(wl&Cl))au(t,0);else if(0!==n){if(2===n&&(dl|=64,t.hydrate&&(t.hydrate=!1,Ir(t.containerInfo)),0!==(i=Ci(t))&&(n=cu(t,i))),1===n)throw e=Sl,au(t,0),eu(t,i),Kl(t,As()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=i,n){case 0:case 1:throw Error(W(345));case 2:du(t);break;case 3:if(eu(t,i),(62914560&i)===i&&10<(n=Pl+500-As())){if(0!==Bi(t,0))break;if(((r=t.suspendedLanes)&i)!==i){Zl(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Pr(du.bind(null,t),n);break}du(t);break;case 4:if(eu(t,i),(4186112&i)===i)break;for(n=t.eventTimes,r=-1;0<i;){var o=31-Ii(i);s=1<<o,(o=n[o])>r&&(r=o),i&=~s}if(i=r,10<(i=(120>(i=As()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*ml(i/1960))-i)){t.timeoutHandle=Pr(du.bind(null,t),i);break}du(t);break;case 5:du(t);break;default:throw Error(W(329))}}return Kl(t,As()),t.callbackNode===e?tu.bind(null,t):null}function eu(t,e){for(e&=~Al,e&=~Cl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-Ii(e),n=1<<i;t[i]=-1,e&=~n}}function iu(t){if(0!=(48&dl))throw Error(W(327));if(vu(),t===pl&&0!=(t.expiredLanes&vl)){var e=vl,i=cu(t,e);0!=(wl&Cl)&&(i=cu(t,e=Bi(t,e)))}else i=cu(t,e=Bi(t,0));if(0!==t.tag&&2===i&&(dl|=64,t.hydrate&&(t.hydrate=!1,Ir(t.containerInfo)),0!==(e=Ci(t))&&(i=cu(t,e))),1===i)throw i=Sl,au(t,0),eu(t,e),Kl(t,As()),i;return t.finishedWork=t.current.alternate,t.finishedLanes=e,du(t),Kl(t,As()),null}function nu(t,e){var i=dl;dl|=1;try{return t(e)}finally{0===(dl=i)&&(Il(),ks())}}function ru(t,e){var i=dl;dl&=-2,dl|=8;try{return t(e)}finally{0===(dl=i)&&(Il(),ks())}}function su(t,e){Hr(bl,gl),gl|=e,wl|=e}function ou(){gl=bl.current,Xr(bl)}function au(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,Mr(i)),null!==yl)for(i=yl.return;null!==i;){var n=i;switch(n.tag){case 1:null!=(n=n.type.childContextTypes)&&es();break;case 3:vo(),Xr($r),Xr(Qr),Go();break;case 5:bo(n);break;case 4:vo();break;case 13:case 19:Xr(xo);break;case 10:Os(n);break;case 23:case 24:ou()}i=i.return}pl=t,yl=Mu(t.current,null),vl=gl=wl=e,xl=0,Sl=null,Al=Cl=Bl=0}function lu(t,e){for(;;){var i=yl;try{if(zs(),To.current=da,Oo){for(var n=Ro.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}Oo=!1}if(Lo=0,zo=Eo=Ro=null,No=!1,fl.current=null,null===i||null===i.return){xl=1,Sl=e,yl=null;break}t:{var s=t,o=i.return,a=i,l=e;if(e=vl,a.flags|=2048,a.firstEffect=a.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l;if(0==(2&a.mode)){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.lanes=c.lanes):(a.updateQueue=null,a.memoizedState=null)}var h=0!=(1&xo.current),m=o;do{var _;if(_=13===m.tag){var f=m.memoizedState;if(null!==f)_=null!==f.dehydrated;else{var d=m.memoizedProps;_=void 0!==d.fallback&&(!0!==d.unstable_avoidThisFallback||!h)}}if(_){var p=m.updateQueue;if(null===p){var y=new Set;y.add(u),m.updateQueue=y}else p.add(u);if(0==(2&m.mode)){if(m.flags|=64,a.flags|=16384,a.flags&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var v=Xs(-1,1);v.tag=2,Hs(a,v)}a.lanes|=1;break t}l=void 0,a=e;var g=s.pingCache;if(null===g?(g=s.pingCache=new Ha,l=new Set,g.set(u,l)):void 0===(l=g.get(u))&&(l=new Set,g.set(u,l)),!l.has(a)){l.add(a);var b=Bu.bind(null,s,u,a);u.then(b,b)}m.flags|=4096,m.lanes=e;break t}m=m.return}while(null!==m);l=Error((Gt(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==xl&&(xl=2),l=Wa(l,a),m=o;do{switch(m.tag){case 3:s=l,m.flags|=4096,e&=-e,m.lanes|=e,Zs(m,Za(0,s,e));break t;case 1:s=l;var x=m.type,S=m.stateNode;if(0==(64&m.flags)&&("function"==typeof x.getDerivedStateFromError||null!==S&&"function"==typeof S.componentDidCatch&&(null===Fl||!Fl.has(S)))){m.flags|=4096,e&=-e,m.lanes|=e,Zs(m,Qa(m,s,e));break t}}m=m.return}while(null!==m)}fu(i)}catch(w){e=w,yl===i&&null!==i&&(yl=i=i.return);continue}break}}function uu(){var t=_l.current;return _l.current=da,null===t?da:t}function cu(t,e){var i=dl;dl|=16;var n=uu();for(pl===t&&vl===e||au(t,e);;)try{hu();break}catch(r){lu(t,r)}if(zs(),dl=i,_l.current=n,null!==yl)throw Error(W(261));return pl=null,vl=0,xl}function hu(){for(;null!==yl;)_u(yl)}function mu(){for(;null!==yl&&!hs();)_u(yl)}function _u(t){var e=kl(t.alternate,t,gl);t.memoizedProps=t.pendingProps,null===e?fu(t):yl=e,fl.current=null}function fu(t){var e=t;do{var i=e.alternate;if(t=e.return,0==(2048&e.flags)){if(null!==(i=Ua(i,e,gl)))return void(yl=i);if(24!==(i=e).tag&&23!==i.tag||null===i.memoizedState||0!=(1073741824&gl)||0==(4&i.mode)){for(var n=0,r=i.child;null!==r;)n|=r.lanes|r.childLanes,r=r.sibling;i.childLanes=n}null!==t&&0==(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(i=Ja(e)))return i.flags&=2047,void(yl=i);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(yl=e);yl=e=t}while(null!==e);0===xl&&(xl=5)}function du(t){var e=Vs();return Ms(99,pu.bind(null,t,e)),null}function pu(t,e){do{vu()}while(null!==Rl);if(0!=(48&dl))throw Error(W(327));var i=t.finishedWork;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(W(177));t.callbackNode=null;var n=i.lanes|i.childLanes,r=n,s=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;for(var o=t.eventTimes,a=t.expirationTimes;0<s;){var l=31-Ii(s),u=1<<l;r[l]=0,o[l]=-1,a[l]=-1,s&=~u}if(null!==Nl&&0==(24&n)&&Nl.has(t)&&Nl.delete(t),t===pl&&(yl=pl=null,vl=0),1<i.flags?null!==i.lastEffect?(i.lastEffect.nextEffect=i,n=i.firstEffect):n=i:n=i.firstEffect,null!==n){if(r=dl,dl|=32,fl.current=null,Br=Fi,tr(o=Kn())){if("selectionStart"in o)a={start:o.selectionStart,end:o.selectionEnd};else t:if(a=(a=o.ownerDocument)&&a.defaultView||window,(u=a.getSelection&&a.getSelection())&&0!==u.rangeCount){a=u.anchorNode,s=u.anchorOffset,l=u.focusNode,u=u.focusOffset;try{a.nodeType,l.nodeType}catch(C){a=null;break t}var c=0,h=-1,m=-1,_=0,f=0,d=o,p=null;e:for(;;){for(var y;d!==a||0!==s&&3!==d.nodeType||(h=c+s),d!==l||0!==u&&3!==d.nodeType||(m=c+u),3===d.nodeType&&(c+=d.nodeValue.length),null!==(y=d.firstChild);)p=d,d=y;for(;;){if(d===o)break e;if(p===a&&++_===s&&(h=c),p===l&&++f===u&&(m=c),null!==(y=d.nextSibling))break;p=(d=p).parentNode}d=y}a=-1===h||-1===m?null:{start:h,end:m}}else a=null;a=a||{start:0,end:0}}else a=null;Cr={focusedElem:o,selectionRange:a},Fi=!1,Xl=null,Hl=!1,Dl=n;do{try{yu()}catch(C){if(null===Dl)throw Error(W(330));wu(Dl,C),Dl=Dl.nextEffect}}while(null!==Dl);Xl=null,Dl=n;do{try{for(o=t;null!==Dl;){var v=Dl.flags;if(16&v&&re(Dl.stateNode,""),128&v){var g=Dl.alternate;if(null!==g){var b=g.ref;null!==b&&("function"==typeof b?b(null):b.current=null)}}switch(1038&v){case 2:sl(Dl),Dl.flags&=-3;break;case 6:sl(Dl),Dl.flags&=-3,ul(Dl.alternate,Dl);break;case 1024:Dl.flags&=-1025;break;case 1028:Dl.flags&=-1025,ul(Dl.alternate,Dl);break;case 4:ul(Dl.alternate,Dl);break;case 8:ll(o,a=Dl);var x=a.alternate;nl(a),null!==x&&nl(x)}Dl=Dl.nextEffect}}catch(C){if(null===Dl)throw Error(W(330));wu(Dl,C),Dl=Dl.nextEffect}}while(null!==Dl);if(b=Cr,g=Kn(),v=b.focusedElem,o=b.selectionRange,g!==v&&v&&v.ownerDocument&&Yn(v.ownerDocument.documentElement,v)){null!==o&&tr(v)&&(g=o.start,void 0===(b=o.end)&&(b=g),"selectionStart"in v?(v.selectionStart=g,v.selectionEnd=Math.min(b,v.value.length)):(b=(g=v.ownerDocument||document)&&g.defaultView||window).getSelection&&(b=b.getSelection(),a=v.textContent.length,x=Math.min(o.start,a),o=void 0===o.end?x:Math.min(o.end,a),!b.extend&&x>o&&(a=o,o=x,x=a),a=$n(v,x),s=$n(v,o),a&&s&&(1!==b.rangeCount||b.anchorNode!==a.node||b.anchorOffset!==a.offset||b.focusNode!==s.node||b.focusOffset!==s.offset)&&((g=g.createRange()).setStart(a.node,a.offset),b.removeAllRanges(),x>o?(b.addRange(g),b.extend(s.node,s.offset)):(g.setEnd(s.node,s.offset),b.addRange(g))))),g=[];for(b=v;b=b.parentNode;)1===b.nodeType&&g.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"==typeof v.focus&&v.focus(),v=0;v<g.length;v++)(b=g[v]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Fi=!!Br,Cr=Br=null,t.current=i,Dl=n;do{try{for(v=t;null!==Dl;){var S=Dl.flags;if(36&S&&tl(v,Dl.alternate,Dl),128&S){g=void 0;var w=Dl.ref;if(null!==w){var B=Dl.stateNode;switch(Dl.tag){case 5:g=B;break;default:g=B}"function"==typeof w?w(g):w.current=g}}Dl=Dl.nextEffect}}catch(C){if(null===Dl)throw Error(W(330));wu(Dl,C),Dl=Dl.nextEffect}}while(null!==Dl);Dl=null,xs(),dl=r}else t.current=i;if(Ll)Ll=!1,Rl=t,El=e;else for(Dl=n;null!==Dl;)e=Dl.nextEffect,Dl.nextEffect=null,8&Dl.flags&&((S=Dl).sibling=null,S.stateNode=null),Dl=e;if(0===(n=t.pendingLanes)&&(Fl=null),1===n?t===ql?jl++:(jl=0,ql=t):jl=0,i=i.stateNode,as&&"function"==typeof as.onCommitFiberRoot)try{as.onCommitFiberRoot(os,i,void 0,64==(64&i.current.flags))}catch(C){}if(Kl(t,As()),Gl)throw Gl=!1,t=Tl,Tl=null,t;return 0!=(8&dl)||ks(),null}function yu(){for(;null!==Dl;){var t=Dl.alternate;Hl||null===Xl||(0!=(8&Dl.flags)?Oe(Dl,Xl)&&(Hl=!0):13===Dl.tag&&hl(t,Dl)&&Oe(Dl,Xl)&&(Hl=!0));var e=Dl.flags;0!=(256&e)&&Ka(t,Dl),0==(512&e)||Ll||(Ll=!0,Is(97,(function(){return vu(),null}))),Dl=Dl.nextEffect}}function vu(){if(90!==El){var t=97<El?97:El;return El=90,Ms(t,xu)}return!1}function gu(t,e){zl.push(e,t),Ll||(Ll=!0,Is(97,(function(){return vu(),null})))}function bu(t,e){Ol.push(e,t),Ll||(Ll=!0,Is(97,(function(){return vu(),null})))}function xu(){if(null===Rl)return!1;var t=Rl;if(Rl=null,0!=(48&dl))throw Error(W(331));var e=dl;dl|=32;var i=Ol;Ol=[];for(var n=0;n<i.length;n+=2){var r=i[n],s=i[n+1],o=r.destroy;if(r.destroy=void 0,"function"==typeof o)try{o()}catch(l){if(null===s)throw Error(W(330));wu(s,l)}}for(i=zl,zl=[],n=0;n<i.length;n+=2){r=i[n],s=i[n+1];try{var a=r.create;r.destroy=a()}catch(l){if(null===s)throw Error(W(330));wu(s,l)}}for(a=t.current.firstEffect;null!==a;)t=a.nextEffect,a.nextEffect=null,8&a.flags&&(a.sibling=null,a.stateNode=null),a=t;return dl=e,ks(),!0}function Su(t,e,i){Hs(t,e=Za(0,e=Wa(i,e),1)),e=Zl(),null!==(t=Yl(t,1))&&(Mi(t,1,e),Kl(t,e))}function wu(t,e){if(3===t.tag)Su(t,t,e);else for(var i=t.return;null!==i;){if(3===i.tag){Su(i,t,e);break}if(1===i.tag){var n=i.stateNode;if("function"==typeof i.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Fl||!Fl.has(n))){var r=Qa(i,t=Wa(e,t),1);if(Hs(i,r),r=Zl(),null!==(i=Yl(i,1)))Mi(i,1,r),Kl(i,r);else if("function"==typeof n.componentDidCatch&&(null===Fl||!Fl.has(n)))try{n.componentDidCatch(e,t)}catch(s){}break}}i=i.return}}function Bu(t,e,i){var n=t.pingCache;null!==n&&n.delete(e),e=Zl(),t.pingedLanes|=t.suspendedLanes&i,pl===t&&(vl&i)===i&&(4===xl||3===xl&&(62914560&vl)===vl&&500>As()-Pl?au(t,0):Al|=i),Kl(t,e)}function Cu(t,e){var i=t.stateNode;null!==i&&i.delete(e),0===(e=0)&&(0==(2&(e=t.mode))?e=1:0==(4&e)?e=99===Vs()?1:2:(0===Jl&&(Jl=wl),0===(e=Vi(62914560&~Jl))&&(e=4194304))),i=Zl(),null!==(t=Yl(t,e))&&(Mi(t,e,i),Kl(t,i))}function Au(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Vu(t,e,i,n){return new Au(t,e,i,n)}function Pu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Mu(t,e){var i=t.alternate;return null===i?((i=Vu(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function Iu(t,e,i,n,r,s){var o=2;if(n=t,"function"==typeof t)Pu(t)&&(o=1);else if("string"==typeof t)o=5;else t:switch(t){case ct:return ku(i.children,r,s,e);case St:o=8,r|=16;break;case ht:o=8,r|=1;break;case mt:return(t=Vu(12,i,e,8|r)).elementType=mt,t.type=mt,t.lanes=s,t;case pt:return(t=Vu(13,i,e,r)).type=pt,t.elementType=pt,t.lanes=s,t;case yt:return(t=Vu(19,i,e,r)).elementType=yt,t.lanes=s,t;case wt:return Du(i,r,s,e);case Bt:return(t=Vu(24,i,e,r)).elementType=Bt,t.lanes=s,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case _t:o=10;break t;case ft:o=9;break t;case dt:o=11;break t;case vt:o=14;break t;case gt:o=16,n=null;break t;case bt:o=22;break t}throw Error(W(130,null==t?t:typeof t,""))}return(e=Vu(o,i,e,r)).elementType=t,e.type=n,e.lanes=s,e}function ku(t,e,i,n){return(t=Vu(7,t,n,e)).lanes=i,t}function Du(t,e,i,n){return(t=Vu(23,t,n,e)).elementType=wt,t.lanes=i,t}function Gu(t,e,i){return(t=Vu(6,t,null,e)).lanes=i,t}function Tu(t,e,i){return(e=Vu(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Fu(t,e,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Pi(0),this.expirationTimes=Pi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pi(0),this.mutableSourceEagerHydrationData=null}function Lu(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ut,key:null==n?null:""+n,children:t,containerInfo:e,implementation:i}}function Ru(t,e,i,n){var r=e.current,s=Zl(),o=Ql(r);t:if(i){e:{if(Le(i=i._reactInternals)!==i||1!==i.tag)throw Error(W(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(ts(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(null!==a);throw Error(W(171))}if(1===i.tag){var l=i.type;if(ts(l)){i=ns(i,l,a);break t}}i=a}else i=Zr;return null===e.context?e.context=i:e.pendingContext=i,(e=Xs(s,o)).payload={element:t},null!==(n=void 0===n?null:n)&&(e.callback=n),Hs(r,e),$l(r,o,s),o}function Eu(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function zu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function Ou(t,e){zu(t,e),(t=t.alternate)&&zu(t,e)}function Nu(t,e,i){var n=null!=i&&null!=i.hydrationOptions&&i.hydrationOptions.mutableSources||null;if(i=new Fu(t,e,null!=i&&!0===i.hydrate),e=Vu(3,null,null,2===e?7:1===e?3:0),i.current=e,e.stateNode=i,Js(e),t[Rr]=i.current,dr(8===t.nodeType?t.parentNode:t),n)for(t=0;t<n.length;t++){var r=(e=n[t])._getVersion;r=r(e._source),null==i.mutableSourceEagerHydrationData?i.mutableSourceEagerHydrationData=[e,r]:i.mutableSourceEagerHydrationData.push(e,r)}this._internalRoot=i}function ju(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function qu(t,e,i,n,r){var s=i._reactRootContainer;if(s){var o=s._internalRoot;if("function"==typeof r){var a=r;r=function(){var t=Eu(o);a.call(t)}}Ru(e,o,t,r)}else{if(s=i._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var i;i=t.lastChild;)t.removeChild(i);return new Nu(t,0,e?{hydrate:!0}:void 0)}(i,n),o=s._internalRoot,"function"==typeof r){var l=r;r=function(){var t=Eu(o);l.call(t)}}ru((function(){Ru(e,o,t,r)}))}return Eu(o)}function Uu(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ju(e))throw Error(W(200));return Lu(t,e,null,i)}kl=function(t,e,i){var n=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||$r.current)ba=!0;else{if(0==(i&n)){switch(ba=!1,e.tag){case 3:Ia(e),ko();break;case 5:go(e);break;case 1:ts(e.type)&&rs(e);break;case 4:yo(e,e.stateNode.containerInfo);break;case 10:n=e.memoizedProps.value;var r=e.type._context;Hr(Fs,r._currentValue),r._currentValue=n;break;case 13:if(null!==e.memoizedState)return 0!=(i&e.child.childLanes)?Fa(t,e,i):(Hr(xo,1&xo.current),null!==(e=ja(t,e,i))?e.sibling:null);Hr(xo,1&xo.current);break;case 19:if(n=0!=(i&e.childLanes),0!=(64&t.flags)){if(n)return Na(t,e,i);e.flags|=64}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Hr(xo,xo.current),n)break;return null;case 23:case 24:return e.lanes=0,Ca(t,e,i)}return ja(t,e,i)}ba=0!=(16384&t.flags)}else ba=!1;switch(e.lanes=0,e.tag){case 2:if(n=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=Kr(e,Qr.current),js(e,i),r=Uo(null,e,n,t,r,i),e.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,ts(n)){var s=!0;rs(e)}else s=!1;e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Js(e);var o=n.getDerivedStateFromProps;"function"==typeof o&&Ks(e,n,o,t),r.updater=to,e.stateNode=r,r._reactInternals=e,ro(e,n,t,i),e=Ma(null,e,n,!0,s,i)}else e.tag=0,xa(null,e,r,i),e=e.child;return e;case 16:r=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=(s=r._init)(r._payload),e.type=r,s=e.tag=function(t){if("function"==typeof t)return Pu(t)?1:0;if(null!=t){if((t=t.$$typeof)===dt)return 11;if(t===vt)return 14}return 2}(r),t=Ts(r,t),s){case 0:e=Va(null,e,r,t,i);break t;case 1:e=Pa(null,e,r,t,i);break t;case 11:e=Sa(null,e,r,t,i);break t;case 14:e=wa(null,e,r,Ts(r.type,t),n,i);break t}throw Error(W(306,r,""))}return e;case 0:return n=e.type,r=e.pendingProps,Va(t,e,n,r=e.elementType===n?r:Ts(n,r),i);case 1:return n=e.type,r=e.pendingProps,Pa(t,e,n,r=e.elementType===n?r:Ts(n,r),i);case 3:if(Ia(e),n=e.updateQueue,null===t||null===n)throw Error(W(282));if(n=e.pendingProps,r=null!==(r=e.memoizedState)?r.element:null,Ws(t,e),Qs(e,n,null,i),(n=e.memoizedState.element)===r)ko(),e=ja(t,e,i);else{if((s=(r=e.stateNode).hydrate)&&(Bo=kr(e.stateNode.containerInfo.firstChild),wo=e,s=Co=!0),s){if(null!=(t=r.mutableSourceEagerHydrationData))for(r=0;r<t.length;r+=2)(s=t[r])._workInProgressVersionPrimary=t[r+1],Do.push(s);for(i=co(e,null,n,i),e.child=i;i;)i.flags=-3&i.flags|1024,i=i.sibling}else xa(t,e,n,i),ko();e=e.child}return e;case 5:return go(e),null===t&&Po(e),n=e.type,r=e.pendingProps,s=null!==t?t.memoizedProps:null,o=r.children,Vr(n,r)?o=null:null!==s&&Vr(n,s)&&(e.flags|=16),Aa(t,e),xa(t,e,o,i),e.child;case 6:return null===t&&Po(e),null;case 13:return Fa(t,e,i);case 4:return yo(e,e.stateNode.containerInfo),n=e.pendingProps,null===t?e.child=uo(e,null,n,i):xa(t,e,n,i),e.child;case 11:return n=e.type,r=e.pendingProps,Sa(t,e,n,r=e.elementType===n?r:Ts(n,r),i);case 7:return xa(t,e,e.pendingProps,i),e.child;case 8:case 12:return xa(t,e,e.pendingProps.children,i),e.child;case 10:t:{n=e.type._context,r=e.pendingProps,o=e.memoizedProps,s=r.value;var a=e.type._context;if(Hr(Fs,a._currentValue),a._currentValue=s,null!==o)if(a=o.value,0===(s=Xn(a,s)?0:0|("function"==typeof n._calculateChangedBits?n._calculateChangedBits(a,s):1073741823))){if(o.children===r.children&&!$r.current){e=ja(t,e,i);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var u=l.firstContext;null!==u;){if(u.context===n&&0!=(u.observedBits&s)){1===a.tag&&((u=Xs(-1,i&-i)).tag=2,Hs(a,u)),a.lanes|=i,null!==(u=a.alternate)&&(u.lanes|=i),Ns(a.return,i),l.lanes|=i;break}u=u.next}}else o=10===a.tag&&a.type===e.type?null:a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}xa(t,e,r.children,i),e=e.child}return e;case 9:return r=e.type,n=(s=e.pendingProps).children,js(e,i),n=n(r=qs(r,s.unstable_observedBits)),e.flags|=1,xa(t,e,n,i),e.child;case 14:return s=Ts(r=e.type,e.pendingProps),wa(t,e,r,s=Ts(r.type,s),n,i);case 15:return Ba(t,e,e.type,e.pendingProps,n,i);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Ts(n,r),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,ts(n)?(t=!0,rs(e)):t=!1,js(e,i),io(e,n,r),ro(e,n,r,i),Ma(null,e,n,!0,t,i);case 19:return Na(t,e,i);case 23:case 24:return Ca(t,e,i)}throw Error(W(156,e.tag))},Nu.prototype.render=function(t){Ru(t,this._internalRoot,null,null)},Nu.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Ru(null,t,null,(function(){e[Rr]=null}))},Ne=function(t){13===t.tag&&($l(t,4,Zl()),Ou(t,4))},je=function(t){13===t.tag&&($l(t,67108864,Zl()),Ou(t,67108864))},qe=function(t){if(13===t.tag){var e=Zl(),i=Ql(t);$l(t,i,e),Ou(t,i)}},Ue=function(t,e){return e()},_e=function(t,e,i){switch(e){case"input":if(jt(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var r=jr(n);if(!r)throw Error(W(90));Rt(n),jt(n,r)}}}break;case"textarea":Zt(t,i);break;case"select":null!=(e=i.value)&&Wt(t,!!i.multiple,e,!1)}},ge=nu,be=function(t,e,i,n,r){var s=dl;dl|=4;try{return Ms(98,t.bind(null,e,i,n,r))}finally{0===(dl=s)&&(Il(),ks())}},xe=function(){0==(49&dl)&&(function(){if(null!==Nl){var t=Nl;Nl=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,Kl(t,As())}))}ks()}(),vu())},Se=function(t,e){var i=dl;dl|=2;try{return t(e)}finally{0===(dl=i)&&(Il(),ks())}};var Ju={Events:[Or,Nr,jr,ye,ve,vu,{current:!1}]},Wu={findFiberByHostInstance:zr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},Xu={bundleType:Wu.bundleType,version:Wu.version,rendererPackageName:Wu.rendererPackageName,rendererConfig:Wu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:at.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=ze(t))?null:t.stateNode},findFiberByHostInstance:Wu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{os=Hu.inject(Xu),as=Hu}catch(ie){}}O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ju,O.createPortal=Uu,O.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(W(188));throw Error(W(268,Object.keys(t)))}return t=null===(t=ze(e))?null:t.stateNode},O.flushSync=function(t,e){var i=dl;if(0!=(48&i))return t(e);dl|=1;try{if(t)return Ms(99,t.bind(null,e))}finally{dl=i,ks()}},O.hydrate=function(t,e,i){if(!ju(e))throw Error(W(200));return qu(null,t,e,!0,i)},O.render=function(t,e,i){if(!ju(e))throw Error(W(200));return qu(null,t,e,!1,i)},O.unmountComponentAtNode=function(t){if(!ju(t))throw Error(W(40));return!!t._reactRootContainer&&(ru((function(){qu(null,null,t,!1,(function(){t._reactRootContainer=null,t[Rr]=null}))})),!0)},O.unstable_batchedUpdates=nu,O.unstable_createPortal=function(t,e){return Uu(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},O.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!ju(i))throw Error(W(200));if(null==t||void 0===t._reactInternals)throw Error(W(38));return qu(t,e,i,!1,n)},O.version="17.0.2",function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),z.exports=O;var Zu=z.exports,Qu={exports:{}};!function(t){var e=function(t){var e,i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(k){l=function(t,e,i){return t[e]=i}}function u(t,e,i,n){var r=e&&e.prototype instanceof p?e:p,s=Object.create(r.prototype),o=new P(n||[]);return s._invoke=function(t,e,i){var n=h;return function(r,s){if(n===_)throw new Error("Generator is already running");if(n===f){if("throw"===r)throw s;return I()}for(i.method=r,i.arg=s;;){var o=i.delegate;if(o){var a=C(o,i);if(a){if(a===d)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===h)throw n=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=_;var l=c(t,e,i);if("normal"===l.type){if(n=i.done?f:m,l.arg===d)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=f,i.method="throw",i.arg=l.arg)}}}(t,i,o),s}function c(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(k){return{type:"throw",arg:k}}}t.wrap=u;var h="suspendedStart",m="suspendedYield",_="executing",f="completed",d={};function p(){}function y(){}function v(){}var g={};l(g,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(M([])));x&&x!==i&&n.call(x,s)&&(g=x);var S=v.prototype=p.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function B(t,e){function i(r,s,o,a){var l=c(t[r],t,s);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var r;this._invoke=function(t,n){function s(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(s,s):s()}}function C(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,C(t,i),"throw"===i.method))return d;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=c(n,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,d;var s=r.arg;return s?s.done?(i[t.resultName]=s.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,d):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,d)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function V(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function M(t){if(t){var i=t[s];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function i(){for(;++r<t.length;)if(n.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}return{next:I}}function I(){return{value:e,done:!0}}return y.prototype=v,l(S,"constructor",v),l(v,"constructor",y),y.displayName=l(v,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,a,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},w(B.prototype),l(B.prototype,o,(function(){return this})),t.AsyncIterator=B,t.async=function(e,i,n,r,s){void 0===s&&(s=Promise);var o=new B(u(e,i,n,r),s);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},w(S),l(S,a,"Generator"),l(S,s,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=M,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(V),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(n,r){return a.type="throw",a.arg=t,i.next=n,r&&(i.method="next",i.arg=e),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),V(i),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;V(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:M(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),d}},t}(Qu.exports);try{regeneratorRuntime=e}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}();var $u=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=5)}([function(t,e,i){t.exports=i(3)()},function(t,e,i){!function(t){function e(t,e){return void 0!==t?t:e}const i=1e37,n=1e-5,r=n*n,s=3.14159265359,o=.1,a=.008,l=2/180*s,u=2*a,c=.2,h=8/180*s,m=.5*s,_=m*m,f=-1,d=.75,p=.25,y=256,v=.01,g=2/180*s;class b{constructor(t=0,e=0,i=0){this.major=0,this.minor=0,this.revision=0,this.major=t,this.minor=e,this.revision=i}toString(){return this.major+"."+this.minor+"."+this.revision}}const x=new b(2,3,2);function S(t,e){const i=[];for(let n=0;n<t;++n)i.push(e(n));return i}function w(t,e=0){const i=[];for(let n=0;n<t;++n)i.push(e);return i}const B=s/180,C=180/s,A=2*s,V=Math.abs,P=Math.min,M=Math.max;function I(t,e,i){return t<e?e:t>i?i:t}const k=isFinite;function D(t){return t*t}function G(t){return 1/Math.sqrt(t)}const T=Math.sqrt,F=Math.pow,L=Math.cos,R=Math.sin,E=Math.acos,z=Math.asin,O=Math.atan2;class N{constructor(t=0,e=0){this.x=t,this.y=e}Clone(){return new N(this.x,this.y)}SetZero(){return this.x=0,this.y=0,this}Set(t,e){return this.x=t,this.y=e,this}Copy(t){return this.x=t.x,this.y=t.y,this}SelfAdd(t){return this.x+=t.x,this.y+=t.y,this}SelfAddXY(t,e){return this.x+=t,this.y+=e,this}SelfSub(t){return this.x-=t.x,this.y-=t.y,this}SelfSubXY(t,e){return this.x-=t,this.y-=e,this}SelfMul(t){return this.x*=t,this.y*=t,this}SelfMulAdd(t,e){return this.x+=t*e.x,this.y+=t*e.y,this}SelfMulSub(t,e){return this.x-=t*e.x,this.y-=t*e.y,this}Dot(t){return this.x*t.x+this.y*t.y}Cross(t){return this.x*t.y-this.y*t.x}Length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}LengthSquared(){const t=this.x,e=this.y;return t*t+e*e}Normalize(){const t=this.Length();if(t>=n){const e=1/t;this.x*=e,this.y*=e}return t}SelfNormalize(){const t=this.Length();if(t>=n){const e=1/t;this.x*=e,this.y*=e}return this}SelfRotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.x;return this.x=e*n-i*this.y,this.y=i*n+e*this.y,this}SelfRotateCosSin(t,e){const i=this.x;return this.x=t*i-e*this.y,this.y=e*i+t*this.y,this}IsValid(){return isFinite(this.x)&&isFinite(this.y)}SelfCrossVS(t){const e=this.x;return this.x=t*this.y,this.y=-t*e,this}SelfCrossSV(t){const e=this.x;return this.x=-t*this.y,this.y=t*e,this}SelfMinV(t){return this.x=P(this.x,t.x),this.y=P(this.y,t.y),this}SelfMaxV(t){return this.x=M(this.x,t.x),this.y=M(this.y,t.y),this}SelfAbs(){return this.x=V(this.x),this.y=V(this.y),this}SelfNeg(){return this.x=-this.x,this.y=-this.y,this}SelfSkew(){const t=this.x;return this.x=-this.y,this.y=t,this}static MakeArray(t){return S(t,(t=>new N))}static AbsV(t,e){return e.x=V(t.x),e.y=V(t.y),e}static MinV(t,e,i){return i.x=P(t.x,e.x),i.y=P(t.y,e.y),i}static MaxV(t,e,i){return i.x=M(t.x,e.x),i.y=M(t.y,e.y),i}static ClampV(t,e,i,n){return n.x=I(t.x,e.x,i.x),n.y=I(t.y,e.y,i.y),n}static RotateV(t,e,i){const n=t.x,r=t.y,s=Math.cos(e),o=Math.sin(e);return i.x=s*n-o*r,i.y=o*n+s*r,i}static DotVV(t,e){return t.x*e.x+t.y*e.y}static CrossVV(t,e){return t.x*e.y-t.y*e.x}static CrossVS(t,e,i){const n=t.x;return i.x=e*t.y,i.y=-e*n,i}static CrossVOne(t,e){const i=t.x;return e.x=t.y,e.y=-i,e}static CrossSV(t,e,i){const n=e.x;return i.x=-t*e.y,i.y=t*n,i}static CrossOneV(t,e){const i=t.x;return e.x=-t.y,e.y=i,e}static AddVV(t,e,i){return i.x=t.x+e.x,i.y=t.y+e.y,i}static SubVV(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i}static MulSV(t,e,i){return i.x=e.x*t,i.y=e.y*t,i}static MulVS(t,e,i){return i.x=t.x*e,i.y=t.y*e,i}static AddVMulSV(t,e,i,n){return n.x=t.x+e*i.x,n.y=t.y+e*i.y,n}static SubVMulSV(t,e,i,n){return n.x=t.x-e*i.x,n.y=t.y-e*i.y,n}static AddVCrossSV(t,e,i,n){const r=i.x;return n.x=t.x-e*i.y,n.y=t.y+e*r,n}static MidVV(t,e,i){return i.x=.5*(t.x+e.x),i.y=.5*(t.y+e.y),i}static ExtVV(t,e,i){return i.x=.5*(e.x-t.x),i.y=.5*(e.y-t.y),i}static IsEqualToV(t,e){return t.x===e.x&&t.y===e.y}static DistanceVV(t,e){const i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}static DistanceSquaredVV(t,e){const i=t.x-e.x,n=t.y-e.y;return i*i+n*n}static NegV(t,e){return e.x=-t.x,e.y=-t.y,e}}N.ZERO=new N(0,0),N.UNITX=new N(1,0),N.UNITY=new N(0,1),N.s_t0=new N,N.s_t1=new N,N.s_t2=new N,N.s_t3=new N;const j=new N(0,0);class q{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}Clone(){return new q(this.x,this.y,this.z)}SetZero(){return this.x=0,this.y=0,this.z=0,this}SetXYZ(t,e,i){return this.x=t,this.y=e,this.z=i,this}Copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}SelfNeg(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}SelfAdd(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}SelfAddXYZ(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this}SelfSub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}SelfSubXYZ(t,e,i){return this.x-=t,this.y-=e,this.z-=i,this}SelfMul(t){return this.x*=t,this.y*=t,this.z*=t,this}static DotV3V3(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static CrossV3V3(t,e,i){const n=t.x,r=t.y,s=t.z,o=e.x,a=e.y,l=e.z;return i.x=r*l-s*a,i.y=s*o-n*l,i.z=n*a-r*o,i}}q.ZERO=new q(0,0,0),q.s_t0=new q;class U{constructor(){this.ex=new N(1,0),this.ey=new N(0,1)}Clone(){return(new U).Copy(this)}static FromVV(t,e){return(new U).SetVV(t,e)}static FromSSSS(t,e,i,n){return(new U).SetSSSS(t,e,i,n)}static FromAngle(t){return(new U).SetAngle(t)}SetSSSS(t,e,i,n){return this.ex.Set(t,i),this.ey.Set(e,n),this}SetVV(t,e){return this.ex.Copy(t),this.ey.Copy(e),this}SetAngle(t){const e=Math.cos(t),i=Math.sin(t);return this.ex.Set(e,i),this.ey.Set(-i,e),this}Copy(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this}SetIdentity(){return this.ex.Set(1,0),this.ey.Set(0,1),this}SetZero(){return this.ex.SetZero(),this.ey.SetZero(),this}GetAngle(){return Math.atan2(this.ex.y,this.ex.x)}GetInverse(t){const e=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y;let s=e*r-i*n;return 0!==s&&(s=1/s),t.ex.x=s*r,t.ey.x=-s*i,t.ex.y=-s*n,t.ey.y=s*e,t}Solve(t,e,i){const n=this.ex.x,r=this.ey.x,s=this.ex.y,o=this.ey.y;let a=n*o-r*s;return 0!==a&&(a=1/a),i.x=a*(o*t-r*e),i.y=a*(n*e-s*t),i}SelfAbs(){return this.ex.SelfAbs(),this.ey.SelfAbs(),this}SelfInv(){return this.GetInverse(this),this}SelfAddM(t){return this.ex.SelfAdd(t.ex),this.ey.SelfAdd(t.ey),this}SelfSubM(t){return this.ex.SelfSub(t.ex),this.ey.SelfSub(t.ey),this}static AbsM(t,e){const i=t.ex,n=t.ey;return e.ex.x=V(i.x),e.ex.y=V(i.y),e.ey.x=V(n.x),e.ey.y=V(n.y),e}static MulMV(t,e,i){const n=t.ex,r=t.ey,s=e.x,o=e.y;return i.x=n.x*s+r.x*o,i.y=n.y*s+r.y*o,i}static MulTMV(t,e,i){const n=t.ex,r=t.ey,s=e.x,o=e.y;return i.x=n.x*s+n.y*o,i.y=r.x*s+r.y*o,i}static AddMM(t,e,i){const n=t.ex,r=t.ey,s=e.ex,o=e.ey;return i.ex.x=n.x+s.x,i.ex.y=n.y+s.y,i.ey.x=r.x+o.x,i.ey.y=r.y+o.y,i}static MulMM(t,e,i){const n=t.ex.x,r=t.ex.y,s=t.ey.x,o=t.ey.y,a=e.ex.x,l=e.ex.y,u=e.ey.x,c=e.ey.y;return i.ex.x=n*a+s*l,i.ex.y=r*a+o*l,i.ey.x=n*u+s*c,i.ey.y=r*u+o*c,i}static MulTMM(t,e,i){const n=t.ex.x,r=t.ex.y,s=t.ey.x,o=t.ey.y,a=e.ex.x,l=e.ex.y,u=e.ey.x,c=e.ey.y;return i.ex.x=n*a+r*l,i.ex.y=s*a+o*l,i.ey.x=n*u+r*c,i.ey.y=s*u+o*c,i}}U.IDENTITY=new U;class J{constructor(){this.ex=new q(1,0,0),this.ey=new q(0,1,0),this.ez=new q(0,0,1)}Clone(){return(new J).Copy(this)}SetVVV(t,e,i){return this.ex.Copy(t),this.ey.Copy(e),this.ez.Copy(i),this}Copy(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this.ez.Copy(t.ez),this}SetIdentity(){return this.ex.SetXYZ(1,0,0),this.ey.SetXYZ(0,1,0),this.ez.SetXYZ(0,0,1),this}SetZero(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this}SelfAddM(t){return this.ex.SelfAdd(t.ex),this.ey.SelfAdd(t.ey),this.ez.SelfAdd(t.ez),this}Solve33(t,e,i,n){const r=this.ex.x,s=this.ex.y,o=this.ex.z,a=this.ey.x,l=this.ey.y,u=this.ey.z,c=this.ez.x,h=this.ez.y,m=this.ez.z;let _=r*(l*m-u*h)+s*(u*c-a*m)+o*(a*h-l*c);return 0!==_&&(_=1/_),n.x=_*(t*(l*m-u*h)+e*(u*c-a*m)+i*(a*h-l*c)),n.y=_*(r*(e*m-i*h)+s*(i*c-t*m)+o*(t*h-e*c)),n.z=_*(r*(l*i-u*e)+s*(u*t-a*i)+o*(a*e-l*t)),n}Solve22(t,e,i){const n=this.ex.x,r=this.ey.x,s=this.ex.y,o=this.ey.y;let a=n*o-r*s;return 0!==a&&(a=1/a),i.x=a*(o*t-r*e),i.y=a*(n*e-s*t),i}GetInverse22(t){const e=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y;let s=e*r-i*n;0!==s&&(s=1/s),t.ex.x=s*r,t.ey.x=-s*i,t.ex.z=0,t.ex.y=-s*n,t.ey.y=s*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0}GetSymInverse33(t){let e=q.DotV3V3(this.ex,q.CrossV3V3(this.ey,this.ez,q.s_t0));0!==e&&(e=1/e);const i=this.ex.x,n=this.ey.x,r=this.ez.x,s=this.ey.y,o=this.ez.y,a=this.ez.z;t.ex.x=e*(s*a-o*o),t.ex.y=e*(r*o-n*a),t.ex.z=e*(n*o-r*s),t.ey.x=t.ex.y,t.ey.y=e*(i*a-r*r),t.ey.z=e*(r*n-i*o),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*s-n*n)}static MulM33V3(t,e,i){const n=e.x,r=e.y,s=e.z;return i.x=t.ex.x*n+t.ey.x*r+t.ez.x*s,i.y=t.ex.y*n+t.ey.y*r+t.ez.y*s,i.z=t.ex.z*n+t.ey.z*r+t.ez.z*s,i}static MulM33XYZ(t,e,i,n,r){return r.x=t.ex.x*e+t.ey.x*i+t.ez.x*n,r.y=t.ex.y*e+t.ey.y*i+t.ez.y*n,r.z=t.ex.z*e+t.ey.z*i+t.ez.z*n,r}static MulM33V2(t,e,i){const n=e.x,r=e.y;return i.x=t.ex.x*n+t.ey.x*r,i.y=t.ex.y*n+t.ey.y*r,i}static MulM33XY(t,e,i,n){return n.x=t.ex.x*e+t.ey.x*i,n.y=t.ex.y*e+t.ey.y*i,n}}J.IDENTITY=new J;class W{constructor(t=0){this.s=0,this.c=1,t&&(this.s=Math.sin(t),this.c=Math.cos(t))}Clone(){return(new W).Copy(this)}Copy(t){return this.s=t.s,this.c=t.c,this}SetAngle(t){return this.s=Math.sin(t),this.c=Math.cos(t),this}SetIdentity(){return this.s=0,this.c=1,this}GetAngle(){return Math.atan2(this.s,this.c)}GetXAxis(t){return t.x=this.c,t.y=this.s,t}GetYAxis(t){return t.x=-this.s,t.y=this.c,t}static MulRR(t,e,i){const n=t.c,r=t.s,s=e.c,o=e.s;return i.s=r*s+n*o,i.c=n*s-r*o,i}static MulTRR(t,e,i){const n=t.c,r=t.s,s=e.c,o=e.s;return i.s=n*o-r*s,i.c=n*s+r*o,i}static MulRV(t,e,i){const n=t.c,r=t.s,s=e.x,o=e.y;return i.x=n*s-r*o,i.y=r*s+n*o,i}static MulTRV(t,e,i){const n=t.c,r=t.s,s=e.x,o=e.y;return i.x=n*s+r*o,i.y=-r*s+n*o,i}}W.IDENTITY=new W;class X{constructor(){this.p=new N,this.q=new W}Clone(){return(new X).Copy(this)}Copy(t){return this.p.Copy(t.p),this.q.Copy(t.q),this}SetIdentity(){return this.p.SetZero(),this.q.SetIdentity(),this}SetPositionRotation(t,e){return this.p.Copy(t),this.q.Copy(e),this}SetPositionAngle(t,e){return this.p.Copy(t),this.q.SetAngle(e),this}SetPosition(t){return this.p.Copy(t),this}SetPositionXY(t,e){return this.p.Set(t,e),this}SetRotation(t){return this.q.Copy(t),this}SetRotationAngle(t){return this.q.SetAngle(t),this}GetPosition(){return this.p}GetRotation(){return this.q}GetRotationAngle(){return this.q.GetAngle()}GetAngle(){return this.q.GetAngle()}static MulXV(t,e,i){const n=t.q.c,r=t.q.s,s=e.x,o=e.y;return i.x=n*s-r*o+t.p.x,i.y=r*s+n*o+t.p.y,i}static MulTXV(t,e,i){const n=t.q.c,r=t.q.s,s=e.x-t.p.x,o=e.y-t.p.y;return i.x=n*s+r*o,i.y=-r*s+n*o,i}static MulXX(t,e,i){return W.MulRR(t.q,e.q,i.q),N.AddVV(W.MulRV(t.q,e.p,i.p),t.p,i.p),i}static MulTXX(t,e,i){return W.MulTRR(t.q,e.q,i.q),W.MulTRV(t.q,N.SubVV(e.p,t.p,i.p),i.p),i}}X.IDENTITY=new X;class H{constructor(){this.localCenter=new N,this.c0=new N,this.c=new N,this.a0=0,this.a=0,this.alpha0=0}Clone(){return(new H).Copy(this)}Copy(t){return this.localCenter.Copy(t.localCenter),this.c0.Copy(t.c0),this.c.Copy(t.c),this.a0=t.a0,this.a=t.a,this.alpha0=t.alpha0,this}GetTransform(t,e){const i=1-e;t.p.x=i*this.c0.x+e*this.c.x,t.p.y=i*this.c0.y+e*this.c.y;const n=i*this.a0+e*this.a;return t.q.SetAngle(n),t.p.SelfSub(W.MulRV(t.q,this.localCenter,N.s_t0)),t}Advance(t){const e=(t-this.alpha0)/(1-this.alpha0),i=1-e;this.c0.x=i*this.c0.x+e*this.c.x,this.c0.y=i*this.c0.y+e*this.c.y,this.a0=i*this.a0+e*this.a,this.alpha0=t}Normalize(){const t=A*Math.floor(this.a0/A);this.a0-=t,this.a-=t}}class Z{constructor(t=.5,e=.5,i=.5,n=1){this.r=t,this.g=e,this.b=i,this.a=n}Clone(){return(new Z).Copy(this)}Copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}IsEqual(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}IsZero(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a}Set(t,e,i,n=this.a){this.SetRGBA(t,e,i,n)}SetByteRGB(t,e,i){return this.r=t/255,this.g=e/255,this.b=i/255,this}SetByteRGBA(t,e,i,n){return this.r=t/255,this.g=e/255,this.b=i/255,this.a=n/255,this}SetRGB(t,e,i){return this.r=t,this.g=e,this.b=i,this}SetRGBA(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this}SelfAdd(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}Add(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e.a=this.a+t.a,e}SelfSub(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}Sub(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,e}SelfMul(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}Mul(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,e}Mix(t,e){Z.MixColors(this,t,e)}static MixColors(t,e,i){const n=i*(e.r-t.r),r=i*(e.g-t.g),s=i*(e.b-t.b),o=i*(e.a-t.a);t.r+=n,t.g+=r,t.b+=s,t.a+=o,e.r-=n,e.g-=r,e.b-=s,e.a-=o}MakeStyleString(t=this.a){return Z.MakeStyleString(this.r,this.g,this.b,t)}static MakeStyleString(t,e,i,n=1){return t*=255,e*=255,i*=255,n<1?`rgba(${t},${e},${i},${n})`:`rgb(${t},${e},${i})`}}var Q;Z.ZERO=new Z(0,0,0,0),Z.RED=new Z(1,0,0),Z.GREEN=new Z(0,1,0),Z.BLUE=new Z(0,0,1),(Q=t.b2DrawFlags||(t.b2DrawFlags={}))[Q.e_none=0]="e_none",Q[Q.e_shapeBit=1]="e_shapeBit",Q[Q.e_jointBit=2]="e_jointBit",Q[Q.e_aabbBit=4]="e_aabbBit",Q[Q.e_pairBit=8]="e_pairBit",Q[Q.e_centerOfMassBit=16]="e_centerOfMassBit",Q[Q.e_particleBit=32]="e_particleBit",Q[Q.e_controllerBit=64]="e_controllerBit",Q[Q.e_all=63]="e_all";class ${constructor(){this.m_start=Date.now()}Reset(){return this.m_start=Date.now(),this}GetMilliseconds(){return Date.now()-this.m_start}}class Y{constructor(t){this.m_stack=[],this.m_count=0,this.m_stack=S(t,(t=>null)),this.m_count=0}Reset(){return this.m_count=0,this}Push(t){this.m_stack[this.m_count]=t,this.m_count++}Pop(){this.m_count--;const t=this.m_stack[this.m_count];if(this.m_stack[this.m_count]=null,null===t)throw new Error;return t}GetCount(){return this.m_count}}class K{constructor(){this.m_buffer=N.MakeArray(2),this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0}Copy(t){return t.m_vertices===t.m_buffer?(this.m_vertices=this.m_buffer,this.m_buffer[0].Copy(t.m_buffer[0]),this.m_buffer[1].Copy(t.m_buffer[1])):this.m_vertices=t.m_vertices,this.m_count=t.m_count,this.m_radius=t.m_radius,this}Reset(){return this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0,this}SetShape(t,e){t.SetupDistanceProxy(this,e)}SetVerticesRadius(t,e,i){this.m_vertices=t,this.m_count=e,this.m_radius=i}GetSupport(t){let e=0,i=N.DotVV(this.m_vertices[0],t);for(let n=1;n<this.m_count;++n){const r=N.DotVV(this.m_vertices[n],t);r>i&&(e=n,i=r)}return e}GetSupportVertex(t){let e=0,i=N.DotVV(this.m_vertices[0],t);for(let n=1;n<this.m_count;++n){const r=N.DotVV(this.m_vertices[n],t);r>i&&(e=n,i=r)}return this.m_vertices[e]}GetVertexCount(){return this.m_count}GetVertex(t){return this.m_vertices[t]}}class tt{constructor(){this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}Reset(){return this.metric=0,this.count=0,this}}class et{constructor(){this.proxyA=new K,this.proxyB=new K,this.transformA=new X,this.transformB=new X,this.useRadii=!1}Reset(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this}}class it{constructor(){this.pointA=new N,this.pointB=new N,this.distance=0,this.iterations=0}Reset(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this}}t.b2_gjkCalls=0,t.b2_gjkIters=0,t.b2_gjkMaxIters=0;class nt{constructor(){this.wA=new N,this.wB=new N,this.w=new N,this.a=0,this.indexA=0,this.indexB=0}Copy(t){return this.wA.Copy(t.wA),this.wB.Copy(t.wB),this.w.Copy(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB,this}}class rt{constructor(){this.m_v1=new nt,this.m_v2=new nt,this.m_v3=new nt,this.m_vertices=[],this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}ReadCache(t,e,i,r,s){this.m_count=t.count;const o=this.m_vertices;for(let n=0;n<this.m_count;++n){const a=o[n];a.indexA=t.indexA[n],a.indexB=t.indexB[n];const l=e.GetVertex(a.indexA),u=r.GetVertex(a.indexB);X.MulXV(i,l,a.wA),X.MulXV(s,u,a.wB),N.SubVV(a.wB,a.wA,a.w),a.a=0}if(this.m_count>1){const e=t.metric,i=this.GetMetric();(i<.5*e||2*e<i||i<n)&&(this.m_count=0)}if(0===this.m_count){const t=o[0];t.indexA=0,t.indexB=0;const n=e.GetVertex(0),a=r.GetVertex(0);X.MulXV(i,n,t.wA),X.MulXV(s,a,t.wB),N.SubVV(t.wB,t.wA,t.w),t.a=1,this.m_count=1}}WriteCache(t){t.metric=this.GetMetric(),t.count=this.m_count;const e=this.m_vertices;for(let i=0;i<this.m_count;++i)t.indexA[i]=e[i].indexA,t.indexB[i]=e[i].indexB}GetSearchDirection(t){switch(this.m_count){case 1:return N.NegV(this.m_v1.w,t);case 2:{const e=N.SubVV(this.m_v2.w,this.m_v1.w,t);return N.CrossVV(e,N.NegV(this.m_v1.w,N.s_t0))>0?N.CrossOneV(e,t):N.CrossVOne(e,t)}default:return t.SetZero()}}GetClosestPoint(t){switch(this.m_count){case 0:return t.SetZero();case 1:return t.Copy(this.m_v1.w);case 2:return t.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:default:return t.SetZero()}}GetWitnessPoints(t,e){switch(this.m_count){case 0:break;case 1:t.Copy(this.m_v1.wA),e.Copy(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y}}GetMetric(){switch(this.m_count){case 0:case 1:return 0;case 2:return N.DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return N.CrossVV(N.SubVV(this.m_v2.w,this.m_v1.w,N.s_t0),N.SubVV(this.m_v3.w,this.m_v1.w,N.s_t1));default:return 0}}Solve2(){const t=this.m_v1.w,e=this.m_v2.w,i=N.SubVV(e,t,rt.s_e12),n=-N.DotVV(t,i);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);const r=N.DotVV(e,i);if(r<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);const s=1/(r+n);this.m_v1.a=r*s,this.m_v2.a=n*s,this.m_count=2}Solve3(){const t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=N.SubVV(e,t,rt.s_e12),r=N.DotVV(t,n),s=N.DotVV(e,n),o=-r,a=N.SubVV(i,t,rt.s_e13),l=N.DotVV(t,a),u=N.DotVV(i,a),c=-l,h=N.SubVV(i,e,rt.s_e23),m=N.DotVV(e,h),_=N.DotVV(i,h),f=-m,d=N.CrossVV(n,a),p=d*N.CrossVV(e,i),y=d*N.CrossVV(i,t),v=d*N.CrossVV(t,e);if(o<=0&&c<=0)return this.m_v1.a=1,void(this.m_count=1);if(s>0&&o>0&&v<=0){const t=1/(s+o);return this.m_v1.a=s*t,this.m_v2.a=o*t,void(this.m_count=2)}if(u>0&&c>0&&y<=0){const t=1/(u+c);return this.m_v1.a=u*t,this.m_v3.a=c*t,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(s<=0&&f<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(u<=0&&_<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(_>0&&f>0&&p<=0){const t=1/(_+f);return this.m_v2.a=_*t,this.m_v3.a=f*t,this.m_count=2,void this.m_v1.Copy(this.m_v3)}const g=1/(p+y+v);this.m_v1.a=p*g,this.m_v2.a=y*g,this.m_v3.a=v*g,this.m_count=3}}rt.s_e12=new N,rt.s_e13=new N,rt.s_e23=new N;const st=new rt,ot=[0,0,0],at=[0,0,0],lt=new N,ut=new N,ct=new N,ht=new N,mt=new N;function _t(e,i,s){++t.b2_gjkCalls;const o=s.proxyA,a=s.proxyB,l=s.transformA,u=s.transformB,c=st;c.ReadCache(i,o,l,a,u);const h=c.m_vertices,m=ot,_=at;let f=0,d=0;for(;d<20;){f=c.m_count;for(let t=0;t<f;++t)m[t]=h[t].indexA,_[t]=h[t].indexB;switch(c.m_count){case 1:break;case 2:c.Solve2();break;case 3:c.Solve3()}if(3===c.m_count)break;const e=c.GetSearchDirection(ut);if(e.LengthSquared()<r)break;const i=h[c.m_count];i.indexA=o.GetSupport(W.MulTRV(l.q,N.NegV(e,N.s_t0),ht)),X.MulXV(l,o.GetVertex(i.indexA),i.wA),i.indexB=a.GetSupport(W.MulTRV(u.q,e,mt)),X.MulXV(u,a.GetVertex(i.indexB),i.wB),N.SubVV(i.wB,i.wA,i.w),++d,++t.b2_gjkIters;let n=!1;for(let t=0;t<f;++t)if(i.indexA===m[t]&&i.indexB===_[t]){n=!0;break}if(n)break;++c.m_count}if(t.b2_gjkMaxIters=M(t.b2_gjkMaxIters,d),c.GetWitnessPoints(e.pointA,e.pointB),e.distance=N.DistanceVV(e.pointA,e.pointB),e.iterations=d,c.WriteCache(i),s.useRadii){const t=o.m_radius,i=a.m_radius;if(e.distance>t+i&&e.distance>n){e.distance-=t+i;const n=N.SubVV(e.pointB,e.pointA,ct);n.Normalize(),e.pointA.SelfMulAdd(t,n),e.pointB.SelfMulSub(i,n)}else{const t=N.MidVV(e.pointA,e.pointB,lt);e.pointA.Copy(t),e.pointB.Copy(t),e.distance=0}}}const ft=new N,dt=new rt,pt=new N,yt=new N,vt=new N,gt=new N,bt=new N,xt=new N;var St,wt,Bt;(St=t.b2ContactFeatureType||(t.b2ContactFeatureType={}))[St.e_vertex=0]="e_vertex",St[St.e_face=1]="e_face";class Ct{constructor(){this._key=0,this._key_invalid=!1,this._indexA=0,this._indexB=0,this._typeA=0,this._typeB=0}get key(){return this._key_invalid&&(this._key_invalid=!1,this._key=this._indexA|this._indexB<<8|this._typeA<<16|this._typeB<<24),this._key}set key(t){this._key=t,this._key_invalid=!1,this._indexA=255&this._key,this._indexB=this._key>>8&255,this._typeA=this._key>>16&255,this._typeB=this._key>>24&255}get indexA(){return this._indexA}set indexA(t){this._indexA=t,this._key_invalid=!0}get indexB(){return this._indexB}set indexB(t){this._indexB=t,this._key_invalid=!0}get typeA(){return this._typeA}set typeA(t){this._typeA=t,this._key_invalid=!0}get typeB(){return this._typeB}set typeB(t){this._typeB=t,this._key_invalid=!0}}class At{constructor(){this.cf=new Ct}Copy(t){return this.key=t.key,this}Clone(){return(new At).Copy(this)}get key(){return this.cf.key}set key(t){this.cf.key=t}}class Vt{constructor(){this.localPoint=new N,this.normalImpulse=0,this.tangentImpulse=0,this.id=new At}static MakeArray(t){return S(t,(t=>new Vt))}Reset(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0}Copy(t){return this.localPoint.Copy(t.localPoint),this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.Copy(t.id),this}}(wt=t.b2ManifoldType||(t.b2ManifoldType={}))[wt.e_unknown=-1]="e_unknown",wt[wt.e_circles=0]="e_circles",wt[wt.e_faceA=1]="e_faceA",wt[wt.e_faceB=2]="e_faceB";class Pt{constructor(){this.points=Vt.MakeArray(2),this.localNormal=new N,this.localPoint=new N,this.type=t.b2ManifoldType.e_unknown,this.pointCount=0}Reset(){for(let t=0;t<2;++t)this.points[t].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=t.b2ManifoldType.e_unknown,this.pointCount=0}Copy(t){this.pointCount=t.pointCount;for(let e=0;e<2;++e)this.points[e].Copy(t.points[e]);return this.localNormal.Copy(t.localNormal),this.localPoint.Copy(t.localPoint),this.type=t.type,this}Clone(){return(new Pt).Copy(this)}}class Mt{constructor(){this.normal=new N,this.points=N.MakeArray(2),this.separations=w(2)}Initialize(e,i,n,s,o){if(0!==e.pointCount)switch(e.type){case t.b2ManifoldType.e_circles:{this.normal.Set(1,0);const t=X.MulXV(i,e.localPoint,Mt.Initialize_s_pointA),a=X.MulXV(s,e.points[0].localPoint,Mt.Initialize_s_pointB);N.DistanceSquaredVV(t,a)>r&&N.SubVV(a,t,this.normal).SelfNormalize();const l=N.AddVMulSV(t,n,this.normal,Mt.Initialize_s_cA),u=N.SubVMulSV(a,o,this.normal,Mt.Initialize_s_cB);N.MidVV(l,u,this.points[0]),this.separations[0]=N.DotVV(N.SubVV(u,l,N.s_t0),this.normal);break}case t.b2ManifoldType.e_faceA:{W.MulRV(i.q,e.localNormal,this.normal);const t=X.MulXV(i,e.localPoint,Mt.Initialize_s_planePoint);for(let i=0;i<e.pointCount;++i){const r=X.MulXV(s,e.points[i].localPoint,Mt.Initialize_s_clipPoint),a=n-N.DotVV(N.SubVV(r,t,N.s_t0),this.normal),l=N.AddVMulSV(r,a,this.normal,Mt.Initialize_s_cA),u=N.SubVMulSV(r,o,this.normal,Mt.Initialize_s_cB);N.MidVV(l,u,this.points[i]),this.separations[i]=N.DotVV(N.SubVV(u,l,N.s_t0),this.normal)}break}case t.b2ManifoldType.e_faceB:{W.MulRV(s.q,e.localNormal,this.normal);const t=X.MulXV(s,e.localPoint,Mt.Initialize_s_planePoint);for(let r=0;r<e.pointCount;++r){const s=X.MulXV(i,e.points[r].localPoint,Mt.Initialize_s_clipPoint),a=o-N.DotVV(N.SubVV(s,t,N.s_t0),this.normal),l=N.AddVMulSV(s,a,this.normal,Mt.Initialize_s_cB),u=N.SubVMulSV(s,n,this.normal,Mt.Initialize_s_cA);N.MidVV(u,l,this.points[r]),this.separations[r]=N.DotVV(N.SubVV(u,l,N.s_t0),this.normal)}this.normal.SelfNeg();break}}}}Mt.Initialize_s_pointA=new N,Mt.Initialize_s_pointB=new N,Mt.Initialize_s_cA=new N,Mt.Initialize_s_cB=new N,Mt.Initialize_s_planePoint=new N,Mt.Initialize_s_clipPoint=new N,(Bt=t.b2PointState||(t.b2PointState={}))[Bt.b2_nullState=0]="b2_nullState",Bt[Bt.b2_addState=1]="b2_addState",Bt[Bt.b2_persistState=2]="b2_persistState",Bt[Bt.b2_removeState=3]="b2_removeState";class It{constructor(){this.v=new N,this.id=new At}static MakeArray(t){return S(t,(t=>new It))}Copy(t){return this.v.Copy(t.v),this.id.Copy(t.id),this}}class kt{constructor(){this.p1=new N,this.p2=new N,this.maxFraction=1}Copy(t){return this.p1.Copy(t.p1),this.p2.Copy(t.p2),this.maxFraction=t.maxFraction,this}}class Dt{constructor(){this.normal=new N,this.fraction=0}Copy(t){return this.normal.Copy(t.normal),this.fraction=t.fraction,this}}class Gt{constructor(){this.lowerBound=new N,this.upperBound=new N,this.m_cache_center=new N,this.m_cache_extent=new N}Copy(t){return this.lowerBound.Copy(t.lowerBound),this.upperBound.Copy(t.upperBound),this}IsValid(){const t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y;let i=t>=0&&e>=0;return i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()}GetCenter(){return N.MidVV(this.lowerBound,this.upperBound,this.m_cache_center)}GetExtents(){return N.ExtVV(this.lowerBound,this.upperBound,this.m_cache_extent)}GetPerimeter(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))}Combine1(t){return this.lowerBound.x=P(this.lowerBound.x,t.lowerBound.x),this.lowerBound.y=P(this.lowerBound.y,t.lowerBound.y),this.upperBound.x=M(this.upperBound.x,t.upperBound.x),this.upperBound.y=M(this.upperBound.y,t.upperBound.y),this}Combine2(t,e){return this.lowerBound.x=P(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=P(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=M(t.upperBound.x,e.upperBound.x),this.upperBound.y=M(t.upperBound.y,e.upperBound.y),this}static Combine(t,e,i){return i.Combine2(t,e),i}Contains(t){let e=!0;return(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y}RayCast(t,e){let r=-i,s=i;const o=e.p1.x,a=e.p1.y,l=e.p2.x-e.p1.x,u=e.p2.y-e.p1.y,c=V(l),h=V(u),m=t.normal;if(c<n){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else{const t=1/l;let e=(this.lowerBound.x-o)*t,i=(this.upperBound.x-o)*t,n=-1;if(e>i){const t=e;e=i,i=t,n=1}if(e>r&&(m.x=n,m.y=0,r=e),s=P(s,i),r>s)return!1}if(h<n){if(a<this.lowerBound.y||this.upperBound.y<a)return!1}else{const t=1/u;let e=(this.lowerBound.y-a)*t,i=(this.upperBound.y-a)*t,n=-1;if(e>i){const t=e;e=i,i=t,n=1}if(e>r&&(m.x=0,m.y=n,r=e),s=P(s,i),r>s)return!1}return!(r<0||e.maxFraction<r||(t.fraction=r,0))}TestContain(t){return!(t.x<this.lowerBound.x||this.upperBound.x<t.x||t.y<this.lowerBound.y||this.upperBound.y<t.y)}TestOverlap(t){const e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,r=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0||n>0||r>0)}}function Tt(t,e){const i=e.lowerBound.x-t.upperBound.x,n=e.lowerBound.y-t.upperBound.y,r=t.lowerBound.x-e.upperBound.x,s=t.lowerBound.y-e.upperBound.y;return!(i>0||n>0||r>0||s>0)}function Ft(e,i,n,r,s){let o=0;const a=i[0],l=i[1],u=N.DotVV(n,a.v)-r,c=N.DotVV(n,l.v)-r;if(u<=0&&e[o++].Copy(a),c<=0&&e[o++].Copy(l),u*c<0){const i=u/(u-c),n=e[o].v;n.x=a.v.x+i*(l.v.x-a.v.x),n.y=a.v.y+i*(l.v.y-a.v.y);const r=e[o].id;r.cf.indexA=s,r.cf.indexB=a.id.cf.indexB,r.cf.typeA=t.b2ContactFeatureType.e_vertex,r.cf.typeB=t.b2ContactFeatureType.e_face,++o}return o}const Lt=new et,Rt=new tt,Et=new it;function zt(t,e,i,r,s,o){const a=Lt.Reset();a.proxyA.SetShape(t,e),a.proxyB.SetShape(i,r),a.transformA.Copy(s),a.transformB.Copy(o),a.useRadii=!0;const l=Rt.Reset();l.count=0;const u=Et.Reset();return _t(u,l,a),u.distance<10*n}function Ot(t){if(null===t)throw new Error;return t}class Nt{constructor(t=0){this.m_id=0,this.aabb=new Gt,this.parent=null,this.child1=null,this.child2=null,this.height=0,this.m_id=t}IsLeaf(){return null===this.child1}}class jt{constructor(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0,this.m_stack=new Y(256)}Query(t,e){if(null===this.m_root)return;const i=this.m_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){const n=i.Pop();if(n.aabb.TestOverlap(t))if(n.IsLeaf()){if(!e(n))return}else i.Push(Ot(n.child1)),i.Push(Ot(n.child2))}}QueryPoint(t,e){if(null===this.m_root)return;const i=this.m_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){const n=i.Pop();if(n.aabb.TestContain(t))if(n.IsLeaf()){if(!e(n))return}else i.Push(Ot(n.child1)),i.Push(Ot(n.child2))}}RayCast(t,e){if(null===this.m_root)return;const i=t.p1,n=t.p2,r=N.SubVV(n,i,jt.s_r);r.Normalize();const s=N.CrossOneV(r,jt.s_v),o=N.AbsV(s,jt.s_abs_v);let a=t.maxFraction;const l=jt.s_segmentAABB;let u=i.x+a*(n.x-i.x),c=i.y+a*(n.y-i.y);l.lowerBound.x=P(i.x,u),l.lowerBound.y=P(i.y,c),l.upperBound.x=M(i.x,u),l.upperBound.y=M(i.y,c);const h=this.m_stack.Reset();for(h.Push(this.m_root);h.GetCount()>0;){const r=h.Pop();if(!Tt(r.aabb,l))continue;const m=r.aabb.GetCenter(),_=r.aabb.GetExtents();if(!(V(N.DotVV(s,N.SubVV(i,m,N.s_t0)))-N.DotVV(o,_)>0))if(r.IsLeaf()){const s=jt.s_subInput;s.p1.Copy(t.p1),s.p2.Copy(t.p2),s.maxFraction=a;const o=e(s,r);if(0===o)return;o>0&&(a=o,u=i.x+a*(n.x-i.x),c=i.y+a*(n.y-i.y),l.lowerBound.x=P(i.x,u),l.lowerBound.y=P(i.y,c),l.upperBound.x=M(i.x,u),l.upperBound.y=M(i.y,c))}else h.Push(Ot(r.child1)),h.Push(Ot(r.child2))}}AllocateNode(){if(this.m_freeList){const t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t.height=0,delete t.userData,t}return new Nt(jt.s_node_id++)}FreeNode(t){t.parent=this.m_freeList,t.child1=null,t.child2=null,t.height=-1,delete t.userData,this.m_freeList=t}CreateProxy(t,e){const i=this.AllocateNode();return i.aabb.lowerBound.x=t.lowerBound.x-.1,i.aabb.lowerBound.y=t.lowerBound.y-.1,i.aabb.upperBound.x=t.upperBound.x+.1,i.aabb.upperBound.y=t.upperBound.y+.1,i.userData=e,i.height=0,this.InsertLeaf(i),i}DestroyProxy(t){this.RemoveLeaf(t),this.FreeNode(t)}MoveProxy(t,e,i){if(t.aabb.Contains(e))return!1;this.RemoveLeaf(t);const n=o+2*(i.x>0?i.x:-i.x),r=o+2*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-r,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+r,this.InsertLeaf(t),!0}InsertLeaf(t){if(++this.m_insertionCount,null===this.m_root)return this.m_root=t,void(this.m_root.parent=null);const e=t.aabb;let i=this.m_root;for(;!i.IsLeaf();){const t=Ot(i.child1),n=Ot(i.child2),r=i.aabb.GetPerimeter(),s=jt.s_combinedAABB;s.Combine2(i.aabb,e);const o=s.GetPerimeter(),a=2*o,l=2*(o-r);let u;const c=jt.s_aabb;let h,m,_;if(t.IsLeaf()?(c.Combine2(e,t.aabb),u=c.GetPerimeter()+l):(c.Combine2(e,t.aabb),h=t.aabb.GetPerimeter(),m=c.GetPerimeter(),u=m-h+l),n.IsLeaf()?(c.Combine2(e,n.aabb),_=c.GetPerimeter()+l):(c.Combine2(e,n.aabb),h=n.aabb.GetPerimeter(),m=c.GetPerimeter(),_=m-h+l),a<u&&a<_)break;i=u<_?t:n}const n=i,r=n.parent,s=this.AllocateNode();s.parent=r,delete s.userData,s.aabb.Combine2(e,n.aabb),s.height=n.height+1,r?(r.child1===n?r.child1=s:r.child2=s,s.child1=n,s.child2=t,n.parent=s,t.parent=s):(s.child1=n,s.child2=t,n.parent=s,t.parent=s,this.m_root=s);let o=t.parent;for(;null!==o;){const t=Ot((o=this.Balance(o)).child1),e=Ot(o.child2);o.height=1+M(t.height,e.height),o.aabb.Combine2(t.aabb,e.aabb),o=o.parent}}RemoveLeaf(t){if(t===this.m_root)return void(this.m_root=null);const e=Ot(t.parent),i=e&&e.parent;let n;if(n=e.child1===t?Ot(e.child2):Ot(e.child1),i){i.child1===e?i.child1=n:i.child2=n,n.parent=i,this.FreeNode(e);let t=i;for(;t;){const e=Ot((t=this.Balance(t)).child1),i=Ot(t.child2);t.aabb.Combine2(e.aabb,i.aabb),t.height=1+M(e.height,i.height),t=t.parent}}else this.m_root=n,n.parent=null,this.FreeNode(e)}Balance(t){if(t.IsLeaf()||t.height<2)return t;const e=Ot(t.child1),i=Ot(t.child2),n=i.height-e.height;if(n>1){const n=Ot(i.child1),r=Ot(i.child2);return i.child1=t,i.parent=t.parent,t.parent=i,null!==i.parent?i.parent.child1===t?i.parent.child1=i:i.parent.child2=i:this.m_root=i,n.height>r.height?(i.child2=n,t.child2=r,r.parent=t,t.aabb.Combine2(e.aabb,r.aabb),i.aabb.Combine2(t.aabb,n.aabb),t.height=1+M(e.height,r.height),i.height=1+M(t.height,n.height)):(i.child2=r,t.child2=n,n.parent=t,t.aabb.Combine2(e.aabb,n.aabb),i.aabb.Combine2(t.aabb,r.aabb),t.height=1+M(e.height,n.height),i.height=1+M(t.height,r.height)),i}if(n<-1){const n=Ot(e.child1),r=Ot(e.child2);return e.child1=t,e.parent=t.parent,t.parent=e,null!==e.parent?e.parent.child1===t?e.parent.child1=e:e.parent.child2=e:this.m_root=e,n.height>r.height?(e.child2=n,t.child1=r,r.parent=t,t.aabb.Combine2(i.aabb,r.aabb),e.aabb.Combine2(t.aabb,n.aabb),t.height=1+M(i.height,r.height),e.height=1+M(t.height,n.height)):(e.child2=r,t.child1=n,n.parent=t,t.aabb.Combine2(i.aabb,n.aabb),e.aabb.Combine2(t.aabb,r.aabb),t.height=1+M(i.height,n.height),e.height=1+M(t.height,r.height)),e}return t}GetHeight(){return null===this.m_root?0:this.m_root.height}static GetAreaNode(t){if(null===t)return 0;if(t.IsLeaf())return 0;let e=t.aabb.GetPerimeter();return e+=jt.GetAreaNode(t.child1),e+jt.GetAreaNode(t.child2)}GetAreaRatio(){if(null===this.m_root)return 0;const t=this.m_root.aabb.GetPerimeter();return jt.GetAreaNode(this.m_root)/t}ComputeHeightNode(t){if(!t||t.IsLeaf())return 0;const e=this.ComputeHeightNode(t.child1),i=this.ComputeHeightNode(t.child2);return 1+M(e,i)}ComputeHeight(){return this.ComputeHeightNode(this.m_root)}ValidateStructure(t){if(null===t)return;this.m_root;const e=t;if(e.IsLeaf())return;const i=Ot(e.child1),n=Ot(e.child2);this.ValidateStructure(i),this.ValidateStructure(n)}ValidateMetrics(t){if(null===t)return;const e=t;if(e.IsLeaf())return;const i=Ot(e.child1),n=Ot(e.child2);jt.s_aabb.Combine2(i.aabb,n.aabb),this.ValidateMetrics(i),this.ValidateMetrics(n)}Validate(){}static GetMaxBalanceNode(t,e){if(null===t)return e;if(t.height<=1)return e;const i=Ot(t.child1),n=Ot(t.child2),r=V(n.height-i.height);return M(e,r)}GetMaxBalance(){return jt.GetMaxBalanceNode(this.m_root,0)}RebuildBottomUp(){this.Validate()}static ShiftOriginNode(t,e){if(null===t)return;if(t.height<=1)return;const i=t.child1,n=t.child2;jt.ShiftOriginNode(i,e),jt.ShiftOriginNode(n,e),t.aabb.lowerBound.SelfSub(e),t.aabb.upperBound.SelfSub(e)}ShiftOrigin(t){jt.ShiftOriginNode(this.m_root,t)}}jt.s_r=new N,jt.s_v=new N,jt.s_abs_v=new N,jt.s_segmentAABB=new Gt,jt.s_subInput=new kt,jt.s_combinedAABB=new Gt,jt.s_aabb=new Gt,jt.s_node_id=0;class qt{constructor(t,e){this.proxyA=t,this.proxyB=e}}class Ut{constructor(){this.m_tree=new jt,this.m_proxyCount=0,this.m_moveCount=0,this.m_moveBuffer=[],this.m_pairCount=0,this.m_pairBuffer=[]}CreateProxy(t,e){const i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i}DestroyProxy(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)}MoveProxy(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)}TouchProxy(t){this.BufferMove(t)}GetProxyCount(){return this.m_proxyCount}UpdatePairs(t){this.m_pairCount=0;for(let i=0;i<this.m_moveCount;++i){const t=this.m_moveBuffer[i];if(null===t)continue;const e=t.aabb;this.m_tree.Query(e,(e=>{if(e.m_id===t.m_id)return!0;let i,n;if(e.m_id<t.m_id?(i=e,n=t):(i=t,n=e),this.m_pairCount===this.m_pairBuffer.length)this.m_pairBuffer[this.m_pairCount]=new qt(i,n);else{const t=this.m_pairBuffer[this.m_pairCount];t.proxyA=i,t.proxyB=n}return++this.m_pairCount,!0}))}this.m_moveCount=0,this.m_pairBuffer.length=this.m_pairCount,this.m_pairBuffer.sort(Jt);let e=0;for(;e<this.m_pairCount;){const i=this.m_pairBuffer[e];for(t(i.proxyA.userData,i.proxyB.userData),++e;e<this.m_pairCount;){const t=this.m_pairBuffer[e];if(t.proxyA.m_id!==i.proxyA.m_id||t.proxyB.m_id!==i.proxyB.m_id)break;++e}}}Query(t,e){this.m_tree.Query(t,e)}QueryPoint(t,e){this.m_tree.QueryPoint(t,e)}RayCast(t,e){this.m_tree.RayCast(t,e)}GetTreeHeight(){return this.m_tree.GetHeight()}GetTreeBalance(){return this.m_tree.GetMaxBalance()}GetTreeQuality(){return this.m_tree.GetAreaRatio()}ShiftOrigin(t){this.m_tree.ShiftOrigin(t)}BufferMove(t){this.m_moveBuffer[this.m_moveCount]=t,++this.m_moveCount}UnBufferMove(t){const e=this.m_moveBuffer.indexOf(t);this.m_moveBuffer[e]=null}}function Jt(t,e){return t.proxyA.m_id===e.proxyA.m_id?t.proxyB.m_id-e.proxyB.m_id:t.proxyA.m_id-e.proxyA.m_id}t.b2_toiTime=0,t.b2_toiMaxTime=0,t.b2_toiCalls=0,t.b2_toiIters=0,t.b2_toiMaxIters=0,t.b2_toiRootIters=0,t.b2_toiMaxRootIters=0;const Wt=new X,Xt=new X,Ht=new N,Zt=new N,Qt=new N,$t=new N,Yt=new N;class Kt{constructor(){this.proxyA=new K,this.proxyB=new K,this.sweepA=new H,this.sweepB=new H,this.tMax=0}}var te,ee;(te=t.b2TOIOutputState||(t.b2TOIOutputState={}))[te.e_unknown=0]="e_unknown",te[te.e_failed=1]="e_failed",te[te.e_overlapped=2]="e_overlapped",te[te.e_touching=3]="e_touching",te[te.e_separated=4]="e_separated";class ie{constructor(){this.state=t.b2TOIOutputState.e_unknown,this.t=0}}(ee=t.b2SeparationFunctionType||(t.b2SeparationFunctionType={}))[ee.e_unknown=-1]="e_unknown",ee[ee.e_points=0]="e_points",ee[ee.e_faceA=1]="e_faceA",ee[ee.e_faceB=2]="e_faceB";class ne{constructor(){this.m_sweepA=new H,this.m_sweepB=new H,this.m_type=t.b2SeparationFunctionType.e_unknown,this.m_localPoint=new N,this.m_axis=new N}Initialize(e,i,n,r,s,o){this.m_proxyA=i,this.m_proxyB=r;const a=e.count;this.m_sweepA.Copy(n),this.m_sweepB.Copy(s);const l=Wt,u=Xt;if(this.m_sweepA.GetTransform(l,o),this.m_sweepB.GetTransform(u,o),1===a){this.m_type=t.b2SeparationFunctionType.e_points;const i=this.m_proxyA.GetVertex(e.indexA[0]),n=this.m_proxyB.GetVertex(e.indexB[0]),r=X.MulXV(l,i,Ht),s=X.MulXV(u,n,Zt);N.SubVV(s,r,this.m_axis);const o=this.m_axis.Normalize();return this.m_localPoint.SetZero(),o}if(e.indexA[0]===e.indexA[1]){this.m_type=t.b2SeparationFunctionType.e_faceB;const i=this.m_proxyB.GetVertex(e.indexB[0]),n=this.m_proxyB.GetVertex(e.indexB[1]);N.CrossVOne(N.SubVV(n,i,N.s_t0),this.m_axis).SelfNormalize();const r=W.MulRV(u.q,this.m_axis,Qt);N.MidVV(i,n,this.m_localPoint);const s=X.MulXV(u,this.m_localPoint,Zt),o=this.m_proxyA.GetVertex(e.indexA[0]),a=X.MulXV(l,o,Ht);let c=N.DotVV(N.SubVV(a,s,N.s_t0),r);return c<0&&(this.m_axis.SelfNeg(),c=-c),c}{this.m_type=t.b2SeparationFunctionType.e_faceA;const i=this.m_proxyA.GetVertex(e.indexA[0]),n=this.m_proxyA.GetVertex(e.indexA[1]);N.CrossVOne(N.SubVV(n,i,N.s_t0),this.m_axis).SelfNormalize();const r=W.MulRV(l.q,this.m_axis,Qt);N.MidVV(i,n,this.m_localPoint);const s=X.MulXV(l,this.m_localPoint,Ht),o=this.m_proxyB.GetVertex(e.indexB[0]),a=X.MulXV(u,o,Zt);let c=N.DotVV(N.SubVV(a,s,N.s_t0),r);return c<0&&(this.m_axis.SelfNeg(),c=-c),c}}FindMinSeparation(e,i,n){const r=Wt,s=Xt;switch(this.m_sweepA.GetTransform(r,n),this.m_sweepB.GetTransform(s,n),this.m_type){case t.b2SeparationFunctionType.e_points:{const t=W.MulTRV(r.q,this.m_axis,$t),n=W.MulTRV(s.q,N.NegV(this.m_axis,N.s_t0),Yt);e[0]=this.m_proxyA.GetSupport(t),i[0]=this.m_proxyB.GetSupport(n);const o=this.m_proxyA.GetVertex(e[0]),a=this.m_proxyB.GetVertex(i[0]),l=X.MulXV(r,o,Ht),u=X.MulXV(s,a,Zt);return N.DotVV(N.SubVV(u,l,N.s_t0),this.m_axis)}case t.b2SeparationFunctionType.e_faceA:{const t=W.MulRV(r.q,this.m_axis,Qt),n=X.MulXV(r,this.m_localPoint,Ht),o=W.MulTRV(s.q,N.NegV(t,N.s_t0),Yt);e[0]=-1,i[0]=this.m_proxyB.GetSupport(o);const a=this.m_proxyB.GetVertex(i[0]),l=X.MulXV(s,a,Zt);return N.DotVV(N.SubVV(l,n,N.s_t0),t)}case t.b2SeparationFunctionType.e_faceB:{const t=W.MulRV(s.q,this.m_axis,Qt),n=X.MulXV(s,this.m_localPoint,Zt),o=W.MulTRV(r.q,N.NegV(t,N.s_t0),$t);i[0]=-1,e[0]=this.m_proxyA.GetSupport(o);const a=this.m_proxyA.GetVertex(e[0]),l=X.MulXV(r,a,Ht);return N.DotVV(N.SubVV(l,n,N.s_t0),t)}default:return e[0]=-1,i[0]=-1,0}}Evaluate(e,i,n){const r=Wt,s=Xt;switch(this.m_sweepA.GetTransform(r,n),this.m_sweepB.GetTransform(s,n),this.m_type){case t.b2SeparationFunctionType.e_points:{const t=this.m_proxyA.GetVertex(e),n=this.m_proxyB.GetVertex(i),o=X.MulXV(r,t,Ht),a=X.MulXV(s,n,Zt);return N.DotVV(N.SubVV(a,o,N.s_t0),this.m_axis)}case t.b2SeparationFunctionType.e_faceA:{const t=W.MulRV(r.q,this.m_axis,Qt),e=X.MulXV(r,this.m_localPoint,Ht),n=this.m_proxyB.GetVertex(i),o=X.MulXV(s,n,Zt);return N.DotVV(N.SubVV(o,e,N.s_t0),t)}case t.b2SeparationFunctionType.e_faceB:{const t=W.MulRV(s.q,this.m_axis,Qt),i=X.MulXV(s,this.m_localPoint,Zt),n=this.m_proxyA.GetVertex(e),o=X.MulXV(r,n,Ht);return N.DotVV(N.SubVV(o,i,N.s_t0),t)}default:return 0}}}const re=new $,se=new tt,oe=new et,ae=new it,le=new ne,ue=[0],ce=[0],he=new H,me=new H;function _e(e,i){const n=re.Reset();++t.b2_toiCalls,e.state=t.b2TOIOutputState.e_unknown,e.t=i.tMax;const r=i.proxyA,s=i.proxyB,o=M(8,r.m_count,s.m_count),l=he.Copy(i.sweepA),u=me.Copy(i.sweepB);l.Normalize(),u.Normalize();const c=i.tMax,h=r.m_radius+s.m_radius,m=M(a,h-3*a),_=.002;let f=0,d=0;const p=se;p.count=0;const y=oe;for(y.proxyA.Copy(i.proxyA),y.proxyB.Copy(i.proxyB),y.useRadii=!1;;){const i=Wt,n=Xt;l.GetTransform(i,f),u.GetTransform(n,f),y.transformA.Copy(i),y.transformB.Copy(n);const a=ae;if(_t(a,p,y),a.distance<=0){e.state=t.b2TOIOutputState.e_overlapped,e.t=0;break}if(a.distance<m+_){e.state=t.b2TOIOutputState.e_touching,e.t=f;break}const h=le;h.Initialize(p,r,l,s,u,f);let v=!1,g=c,b=0;for(;;){const i=ue,n=ce;let r=h.FindMinSeparation(i,n,g);if(r>m+_){e.state=t.b2TOIOutputState.e_separated,e.t=c,v=!0;break}if(r>m-_){f=g;break}let s=h.Evaluate(i[0],n[0],f);if(s<m-_){e.state=t.b2TOIOutputState.e_failed,e.t=f,v=!0;break}if(s<=m+_){e.state=t.b2TOIOutputState.e_touching,e.t=f,v=!0;break}let a=0,l=f,u=g;for(;;){let e=0;e=1&a?l+(m-s)*(u-l)/(r-s):.5*(l+u),++a,++t.b2_toiRootIters;const o=h.Evaluate(i[0],n[0],e);if(V(o-m)<_){g=e;break}if(o>m?(l=e,s=o):(u=e,r=o),50===a)break}if(t.b2_toiMaxRootIters=M(t.b2_toiMaxRootIters,a),++b===o)break}if(++d,++t.b2_toiIters,v)break;if(20===d){e.state=t.b2TOIOutputState.e_failed,e.t=f;break}}t.b2_toiMaxIters=M(t.b2_toiMaxIters,d);const v=n.GetMilliseconds();t.b2_toiMaxTime=M(t.b2_toiMaxTime,v),t.b2_toiTime+=v}const fe=new N,de=new N;function pe(e,i,n,r,s){e.pointCount=0;const o=X.MulXV(n,i.m_p,fe),a=X.MulXV(s,r.m_p,de),l=N.DistanceSquaredVV(o,a),u=i.m_radius+r.m_radius;l>u*u||(e.type=t.b2ManifoldType.e_circles,e.localPoint.Copy(i.m_p),e.localNormal.SetZero(),e.pointCount=1,e.points[0].localPoint.Copy(r.m_p),e.points[0].id.key=0)}const ye=new N,ve=new N,ge=new N;function be(e,r,s,o,a){e.pointCount=0;const l=X.MulXV(a,o.m_p,ye),u=X.MulTXV(s,l,ve);let c=0,h=-i;const m=r.m_radius+o.m_radius,_=r.m_count,f=r.m_vertices,d=r.m_normals;for(let t=0;t<_;++t){const e=N.DotVV(d[t],N.SubVV(u,f[t],N.s_t0));if(e>m)return;e>h&&(h=e,c=t)}const p=c,y=(p+1)%_,v=f[p],g=f[y];if(h<n)return e.pointCount=1,e.type=t.b2ManifoldType.e_faceA,e.localNormal.Copy(d[c]),N.MidVV(v,g,e.localPoint),e.points[0].localPoint.Copy(o.m_p),void(e.points[0].id.key=0);const b=N.DotVV(N.SubVV(u,v,N.s_t0),N.SubVV(g,v,N.s_t1)),x=N.DotVV(N.SubVV(u,g,N.s_t0),N.SubVV(v,g,N.s_t1));if(b<=0){if(N.DistanceSquaredVV(u,v)>m*m)return;e.pointCount=1,e.type=t.b2ManifoldType.e_faceA,N.SubVV(u,v,e.localNormal).SelfNormalize(),e.localPoint.Copy(v),e.points[0].localPoint.Copy(o.m_p),e.points[0].id.key=0}else if(x<=0){if(N.DistanceSquaredVV(u,g)>m*m)return;e.pointCount=1,e.type=t.b2ManifoldType.e_faceA,N.SubVV(u,g,e.localNormal).SelfNormalize(),e.localPoint.Copy(g),e.points[0].localPoint.Copy(o.m_p),e.points[0].id.key=0}else{const i=N.MidVV(v,g,ge);if(N.DotVV(N.SubVV(u,i,N.s_t1),d[p])>m)return;e.pointCount=1,e.type=t.b2ManifoldType.e_faceA,e.localNormal.Copy(d[p]).SelfNormalize(),e.localPoint.Copy(i),e.points[0].localPoint.Copy(o.m_p),e.points[0].id.key=0}}const xe=new N,Se=new N,we=new N,Be=new N;function Ce(t,e,n,r,s){const o=t.m_vertices,a=t.m_normals,l=r.m_count,u=r.m_vertices,c=W.MulRV(e.q,a[n],xe),h=W.MulTRV(s.q,c,Se);let m=0,_=i;for(let i=0;i<l;++i){const t=N.DotVV(u[i],h);t<_&&(_=t,m=i)}const f=X.MulXV(e,o[n],we),d=X.MulXV(s,u[m],Be);return N.DotVV(N.SubVV(d,f,N.s_t0),c)}const Ae=new N,Ve=new N;function Pe(t,e,n,r,s){const o=e.m_count,a=e.m_normals,l=N.SubVV(X.MulXV(s,r.m_centroid,N.s_t0),X.MulXV(n,e.m_centroid,N.s_t1),Ae),u=W.MulTRV(n.q,l,Ve);let c=0,h=-i;for(let i=0;i<o;++i){const t=N.DotVV(a[i],u);t>h&&(h=t,c=i)}let m=Ce(e,n,c,r,s);const _=(c+o-1)%o,f=Ce(e,n,_,r,s),d=(c+1)%o,p=Ce(e,n,d,r,s);let y=0,v=0,g=0;if(f>m&&f>p)g=-1,y=_,v=f;else{if(!(p>m))return t[0]=c,m;g=1,y=d,v=p}for(;(m=Ce(e,n,c=-1===g?(y+o-1)%o:(y+1)%o,r,s))>v;)y=c,v=m;return t[0]=y,v}const Me=new N,Ie=It.MakeArray(2),ke=It.MakeArray(2),De=It.MakeArray(2),Ge=[0],Te=[0],Fe=new N,Le=new N,Re=new N,Ee=new N,ze=new N,Oe=new N,Ne=new N,je=new N;function qe(e,n,r,s,o){e.pointCount=0;const a=n.m_radius+s.m_radius,l=Ge;l[0]=0;const u=Pe(l,n,r,s,o);if(u>a)return;const c=Te;c[0]=0;const h=Pe(c,s,o,n,r);if(h>a)return;let m,_,f,d,p=0,y=0;h>.98*u+.001?(m=s,_=n,f=o,d=r,p=c[0],e.type=t.b2ManifoldType.e_faceB,y=1):(m=n,_=s,f=r,d=o,p=l[0],e.type=t.b2ManifoldType.e_faceA,y=0);const v=Ie;!function(e,n,r,s,o,a){const l=n.m_normals,u=o.m_count,c=o.m_vertices,h=o.m_normals,m=W.MulTRV(a.q,W.MulRV(r.q,l[s],N.s_t0),Me);let _=0,f=i;for(let t=0;t<u;++t){const e=N.DotVV(m,h[t]);e<f&&(f=e,_=t)}const d=_,p=(d+1)%u,y=e[0];X.MulXV(a,c[d],y.v);const v=y.id.cf;v.indexA=s,v.indexB=d,v.typeA=t.b2ContactFeatureType.e_face,v.typeB=t.b2ContactFeatureType.e_vertex;const g=e[1];X.MulXV(a,c[p],g.v);const b=g.id.cf;b.indexA=s,b.indexB=p,b.typeA=t.b2ContactFeatureType.e_face,b.typeB=t.b2ContactFeatureType.e_vertex}(v,m,f,p,_,d);const g=m.m_count,b=m.m_vertices,x=p,S=(p+1)%g,w=b[x],B=b[S],C=N.SubVV(B,w,Fe);C.Normalize();const A=N.CrossVOne(C,Le),V=N.MidVV(w,B,Re),P=W.MulRV(f.q,C,ze),M=N.CrossVOne(P,Ee),I=X.MulXV(f,w,Ne),k=X.MulXV(f,B,je),D=N.DotVV(M,I),G=-N.DotVV(P,I)+a,T=N.DotVV(P,k)+a,F=ke,L=De;if(Ft(F,v,N.NegV(P,Oe),G,x)<2)return;if(Ft(L,F,P,T,S)<2)return;e.localNormal.Copy(A),e.localPoint.Copy(V);let R=0;for(let t=0;t<2;++t){const i=L[t];if(N.DotVV(M,i.v)-D<=a){const t=e.points[R];if(X.MulTXV(d,i.v,t.localPoint),t.id.Copy(i.id),y){const e=t.id.cf;t.id.cf.indexA=e.indexB,t.id.cf.indexB=e.indexA,t.id.cf.typeA=e.typeB,t.id.cf.typeB=e.typeA}++R}}e.pointCount=R}const Ue=new N,Je=new N,We=new N,Xe=new N,He=new N,Ze=new N,Qe=new N,$e=new At;function Ye(e,i,n,r,s){e.pointCount=0;const o=X.MulTXV(n,X.MulXV(s,r.m_p,N.s_t0),Ue),a=i.m_vertex1,l=i.m_vertex2,u=N.SubVV(l,a,Je),c=N.DotVV(u,N.SubVV(l,o,N.s_t0)),h=N.DotVV(u,N.SubVV(o,a,N.s_t0)),m=i.m_radius+r.m_radius,_=$e;if(_.cf.indexB=0,_.cf.typeB=t.b2ContactFeatureType.e_vertex,h<=0){const n=a,s=N.SubVV(o,n,We);if(N.DotVV(s,s)>m*m)return;if(i.m_hasVertex0){const t=i.m_vertex0,e=a,n=N.SubVV(e,t,Xe);if(N.DotVV(n,N.SubVV(e,o,N.s_t0))>0)return}return _.cf.indexA=0,_.cf.typeA=t.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=t.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(n),e.points[0].id.Copy(_),void e.points[0].localPoint.Copy(r.m_p)}if(c<=0){const n=l,s=N.SubVV(o,n,We);if(N.DotVV(s,s)>m*m)return;if(i.m_hasVertex3){const t=i.m_vertex3,e=l,n=N.SubVV(t,e,He);if(N.DotVV(n,N.SubVV(o,e,N.s_t0))>0)return}return _.cf.indexA=1,_.cf.typeA=t.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=t.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(n),e.points[0].id.Copy(_),void e.points[0].localPoint.Copy(r.m_p)}const f=N.DotVV(u,u),d=Ze;d.x=1/f*(c*a.x+h*l.x),d.y=1/f*(c*a.y+h*l.y);const p=N.SubVV(o,d,We);if(N.DotVV(p,p)>m*m)return;const y=Qe.Set(-u.y,u.x);N.DotVV(y,N.SubVV(o,a,N.s_t0))<0&&y.Set(-y.x,-y.y),y.Normalize(),_.cf.indexA=0,_.cf.typeA=t.b2ContactFeatureType.e_face,e.pointCount=1,e.type=t.b2ManifoldType.e_faceA,e.localNormal.Copy(y),e.localPoint.Copy(a),e.points[0].id.Copy(_),e.points[0].localPoint.Copy(r.m_p)}class Ke{constructor(){this.type=0,this.index=0,this.separation=0}}class ti{constructor(){this.vertices=[],this.normals=[],this.count=0}}class ei{constructor(){this.m_polygonB=new ti,this.m_xf=new X,this.m_centroidB=new N,this.m_v0=new N,this.m_v1=new N,this.m_v2=new N,this.m_v3=new N,this.m_normal0=new N,this.m_normal1=new N,this.m_normal2=new N,this.m_normal=new N,this.m_type1=0,this.m_type2=0,this.m_lowerLimit=new N,this.m_upperLimit=new N,this.m_radius=0,this.m_front=!1}Collide(e,i,n,r,s){X.MulTXX(n,s,this.m_xf),X.MulXV(this.m_xf,r.m_centroid,this.m_centroidB),this.m_v0.Copy(i.m_vertex0),this.m_v1.Copy(i.m_vertex1),this.m_v2.Copy(i.m_vertex2),this.m_v3.Copy(i.m_vertex3);const o=i.m_hasVertex0,a=i.m_hasVertex3,l=N.SubVV(this.m_v2,this.m_v1,ei.s_edge1);l.Normalize(),this.m_normal1.Set(l.y,-l.x);const u=N.DotVV(this.m_normal1,N.SubVV(this.m_centroidB,this.m_v1,N.s_t0));let c=0,h=0,m=!1,_=!1;if(o){const t=N.SubVV(this.m_v1,this.m_v0,ei.s_edge0);t.Normalize(),this.m_normal0.Set(t.y,-t.x),m=N.CrossVV(t,l)>=0,c=N.DotVV(this.m_normal0,N.SubVV(this.m_centroidB,this.m_v0,N.s_t0))}if(a){const t=N.SubVV(this.m_v3,this.m_v2,ei.s_edge2);t.Normalize(),this.m_normal2.Set(t.y,-t.x),_=N.CrossVV(l,t)>0,h=N.DotVV(this.m_normal2,N.SubVV(this.m_centroidB,this.m_v2,N.s_t0))}o&&a?m&&_?(this.m_front=c>=0||u>=0||h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):m?(this.m_front=c>=0||u>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):_?(this.m_front=h>=0||c>=0&&u>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):(this.m_front=c>=0&&u>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):o?m?(this.m_front=c>=0||u>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):(this.m_front=c>=0&&u>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):a?_?(this.m_front=u>=0||h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=u>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=u>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1))),this.m_polygonB.count=r.m_count;for(let t=0;t<r.m_count;++t)this.m_polygonB.vertices.length<=t&&this.m_polygonB.vertices.push(new N),this.m_polygonB.normals.length<=t&&this.m_polygonB.normals.push(new N),X.MulXV(this.m_xf,r.m_vertices[t],this.m_polygonB.vertices[t]),W.MulRV(this.m_xf.q,r.m_normals[t],this.m_polygonB.normals[t]);this.m_radius=r.m_radius+i.m_radius,e.pointCount=0;const f=this.ComputeEdgeSeparation(ei.s_edgeAxis);if(0===f.type)return;if(f.separation>this.m_radius)return;const d=this.ComputePolygonSeparation(ei.s_polygonAxis);if(0!==d.type&&d.separation>this.m_radius)return;let p;p=0===d.type?f:d.separation>.98*f.separation+.001?d:f;const y=ei.s_ie,v=ei.s_rf;if(1===p.type){e.type=t.b2ManifoldType.e_faceA;let i=0,n=N.DotVV(this.m_normal,this.m_polygonB.normals[0]);for(let t=1;t<this.m_polygonB.count;++t){const e=N.DotVV(this.m_normal,this.m_polygonB.normals[t]);e<n&&(n=e,i=t)}const r=i,s=(r+1)%this.m_polygonB.count,o=y[0];o.v.Copy(this.m_polygonB.vertices[r]),o.id.cf.indexA=0,o.id.cf.indexB=r,o.id.cf.typeA=t.b2ContactFeatureType.e_face,o.id.cf.typeB=t.b2ContactFeatureType.e_vertex;const a=y[1];a.v.Copy(this.m_polygonB.vertices[s]),a.id.cf.indexA=0,a.id.cf.indexB=s,a.id.cf.typeA=t.b2ContactFeatureType.e_face,a.id.cf.typeB=t.b2ContactFeatureType.e_vertex,this.m_front?(v.i1=0,v.i2=1,v.v1.Copy(this.m_v1),v.v2.Copy(this.m_v2),v.normal.Copy(this.m_normal1)):(v.i1=1,v.i2=0,v.v1.Copy(this.m_v2),v.v2.Copy(this.m_v1),v.normal.Copy(this.m_normal1).SelfNeg())}else{e.type=t.b2ManifoldType.e_faceB;const i=y[0];i.v.Copy(this.m_v1),i.id.cf.indexA=0,i.id.cf.indexB=p.index,i.id.cf.typeA=t.b2ContactFeatureType.e_vertex,i.id.cf.typeB=t.b2ContactFeatureType.e_face;const n=y[1];n.v.Copy(this.m_v2),n.id.cf.indexA=0,n.id.cf.indexB=p.index,n.id.cf.typeA=t.b2ContactFeatureType.e_vertex,n.id.cf.typeB=t.b2ContactFeatureType.e_face,v.i1=p.index,v.i2=(v.i1+1)%this.m_polygonB.count,v.v1.Copy(this.m_polygonB.vertices[v.i1]),v.v2.Copy(this.m_polygonB.vertices[v.i2]),v.normal.Copy(this.m_polygonB.normals[v.i1])}v.sideNormal1.Set(v.normal.y,-v.normal.x),v.sideNormal2.Copy(v.sideNormal1).SelfNeg(),v.sideOffset1=N.DotVV(v.sideNormal1,v.v1),v.sideOffset2=N.DotVV(v.sideNormal2,v.v2);const g=ei.s_clipPoints1,b=ei.s_clipPoints2;if(Ft(g,y,v.sideNormal1,v.sideOffset1,v.i1)<2)return;if(Ft(b,g,v.sideNormal2,v.sideOffset2,v.i2)<2)return;1===p.type?(e.localNormal.Copy(v.normal),e.localPoint.Copy(v.v1)):(e.localNormal.Copy(r.m_normals[v.i1]),e.localPoint.Copy(r.m_vertices[v.i1]));let x=0;for(let t=0;t<2;++t)if(N.DotVV(v.normal,N.SubVV(b[t].v,v.v1,N.s_t0))<=this.m_radius){const i=e.points[x];1===p.type?(X.MulTXV(this.m_xf,b[t].v,i.localPoint),i.id=b[t].id):(i.localPoint.Copy(b[t].v),i.id.cf.typeA=b[t].id.cf.typeB,i.id.cf.typeB=b[t].id.cf.typeA,i.id.cf.indexA=b[t].id.cf.indexB,i.id.cf.indexB=b[t].id.cf.indexA),++x}e.pointCount=x}ComputeEdgeSeparation(t){const e=t;e.type=1,e.index=this.m_front?0:1,e.separation=i;for(let i=0;i<this.m_polygonB.count;++i){const t=N.DotVV(this.m_normal,N.SubVV(this.m_polygonB.vertices[i],this.m_v1,N.s_t0));t<e.separation&&(e.separation=t)}return e}ComputePolygonSeparation(t){const e=t;e.type=0,e.index=-1,e.separation=-i;const n=ei.s_perp.Set(-this.m_normal.y,this.m_normal.x);for(let i=0;i<this.m_polygonB.count;++i){const t=N.NegV(this.m_polygonB.normals[i],ei.s_n),r=N.DotVV(t,N.SubVV(this.m_polygonB.vertices[i],this.m_v1,N.s_t0)),s=N.DotVV(t,N.SubVV(this.m_polygonB.vertices[i],this.m_v2,N.s_t0)),o=P(r,s);if(o>this.m_radius)return e.type=2,e.index=i,e.separation=o,e;if(N.DotVV(t,n)>=0){if(N.DotVV(N.SubVV(t,this.m_upperLimit,N.s_t0),this.m_normal)<-l)continue}else if(N.DotVV(N.SubVV(t,this.m_lowerLimit,N.s_t0),this.m_normal)<-l)continue;o>e.separation&&(e.type=2,e.index=i,e.separation=o)}return e}}ei.s_edge1=new N,ei.s_edge0=new N,ei.s_edge2=new N,ei.s_ie=It.MakeArray(2),ei.s_rf=new class{constructor(){this.i1=0,this.i2=0,this.v1=new N,this.v2=new N,this.normal=new N,this.sideNormal1=new N,this.sideOffset1=0,this.sideNormal2=new N,this.sideOffset2=0}},ei.s_clipPoints1=It.MakeArray(2),ei.s_clipPoints2=It.MakeArray(2),ei.s_edgeAxis=new Ke,ei.s_polygonAxis=new Ke,ei.s_n=new N,ei.s_perp=new N;const ii=new ei;function ni(t,e,i,n,r){ii.Collide(t,e,i,n,r)}class ri{constructor(){this.mass=0,this.center=new N(0,0),this.I=0}}var si,oi,ai,li;(si=t.b2ShapeType||(t.b2ShapeType={}))[si.e_unknown=-1]="e_unknown",si[si.e_circleShape=0]="e_circleShape",si[si.e_edgeShape=1]="e_edgeShape",si[si.e_polygonShape=2]="e_polygonShape",si[si.e_chainShape=3]="e_chainShape",si[si.e_shapeTypeCount=4]="e_shapeTypeCount";class ui{constructor(e,i){this.m_type=t.b2ShapeType.e_unknown,this.m_radius=0,this.m_type=e,this.m_radius=i}Copy(t){return this.m_radius=t.m_radius,this}GetType(){return this.m_type}}class ci extends ui{constructor(e=0){super(t.b2ShapeType.e_circleShape,e),this.m_p=new N}Set(t,e=this.m_radius){return this.m_p.Copy(t),this.m_radius=e,this}Clone(){return(new ci).Copy(this)}Copy(t){return super.Copy(t),this.m_p.Copy(t.m_p),this}GetChildCount(){return 1}TestPoint(t,e){const i=X.MulXV(t,this.m_p,ci.TestPoint_s_center),n=N.SubVV(e,i,ci.TestPoint_s_d);return N.DotVV(n,n)<=D(this.m_radius)}ComputeDistance(t,e,i,n){const r=X.MulXV(t,this.m_p,ci.ComputeDistance_s_center);return N.SubVV(e,r,i),i.Normalize()-this.m_radius}RayCast(t,e,i,r){const s=X.MulXV(i,this.m_p,ci.RayCast_s_position),o=N.SubVV(e.p1,s,ci.RayCast_s_s),a=N.DotVV(o,o)-D(this.m_radius),l=N.SubVV(e.p2,e.p1,ci.RayCast_s_r),u=N.DotVV(o,l),c=N.DotVV(l,l),h=u*u-c*a;if(h<0||c<n)return!1;let m=-(u+T(h));return 0<=m&&m<=e.maxFraction*c&&(m/=c,t.fraction=m,N.AddVMulSV(o,m,l,t.normal).SelfNormalize(),!0)}ComputeAABB(t,e,i){const n=X.MulXV(e,this.m_p,ci.ComputeAABB_s_p);t.lowerBound.Set(n.x-this.m_radius,n.y-this.m_radius),t.upperBound.Set(n.x+this.m_radius,n.y+this.m_radius)}ComputeMass(t,e){const i=D(this.m_radius);t.mass=e*s*i,t.center.Copy(this.m_p),t.I=t.mass*(.5*i+N.DotVV(this.m_p,this.m_p))}SetupDistanceProxy(t,e){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_p),t.m_count=1,t.m_radius=this.m_radius}ComputeSubmergedArea(t,e,i,r){const o=X.MulXV(i,this.m_p,new N),a=-(N.DotVV(t,o)-e);if(a<-this.m_radius+n)return 0;if(a>this.m_radius)return r.Copy(o),s*this.m_radius*this.m_radius;const l=this.m_radius*this.m_radius,u=a*a,c=l*(z(a/this.m_radius)+s/2)+a*T(l-u),h=-2/3*F(l-u,1.5)/c;return r.x=o.x+t.x*h,r.y=o.y+t.y*h,c}Dump(t){t("    const shape: b2CircleShape = new b2CircleShape();\n"),t("    shape.m_radius = %.15f;\n",this.m_radius),t("    shape.m_p.Set(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)}}ci.TestPoint_s_center=new N,ci.TestPoint_s_d=new N,ci.ComputeDistance_s_center=new N,ci.RayCast_s_position=new N,ci.RayCast_s_s=new N,ci.RayCast_s_r=new N,ci.ComputeAABB_s_p=new N;class hi extends ui{constructor(){super(t.b2ShapeType.e_polygonShape,u),this.m_centroid=new N(0,0),this.m_vertices=[],this.m_normals=[],this.m_count=0}Clone(){return(new hi).Copy(this)}Copy(t){super.Copy(t),this.m_centroid.Copy(t.m_centroid),this.m_count=t.m_count,this.m_vertices=N.MakeArray(this.m_count),this.m_normals=N.MakeArray(this.m_count);for(let e=0;e<this.m_count;++e)this.m_vertices[e].Copy(t.m_vertices[e]),this.m_normals[e].Copy(t.m_normals[e]);return this}GetChildCount(){return 1}Set(t,e=t.length,i=0){if(e<3)return this.SetAsBox(1,1);let n=e;const r=[];for(let c=0;c<n;++c){const e=t[i+c];let n=!0;for(let t=0;t<r.length;++t)if(N.DistanceSquaredVV(e,r[t])<16e-6){n=!1;break}n&&r.push(e)}if((n=r.length)<3)return this.SetAsBox(1,1);let s=0,o=r[0].x;for(let c=1;c<n;++c){const t=r[c].x;(t>o||t===o&&r[c].y<r[s].y)&&(s=c,o=t)}const a=[];let l=0,u=s;for(;;){a[l]=u;let t=0;for(let e=1;e<n;++e){if(t===u){t=e;continue}const i=N.SubVV(r[t],r[a[l]],hi.Set_s_r),n=N.SubVV(r[e],r[a[l]],hi.Set_s_v),s=N.CrossVV(i,n);s<0&&(t=e),0===s&&n.LengthSquared()>i.LengthSquared()&&(t=e)}if(++l,u=t,t===s)break}this.m_count=l,this.m_vertices=N.MakeArray(this.m_count),this.m_normals=N.MakeArray(this.m_count);for(let c=0;c<l;++c)this.m_vertices[c].Copy(r[a[c]]);for(let c=0;c<l;++c){const t=this.m_vertices[c],e=this.m_vertices[(c+1)%l],i=N.SubVV(e,t,N.s_t0);N.CrossVOne(i,this.m_normals[c]).SelfNormalize()}return hi.ComputeCentroid(this.m_vertices,l,this.m_centroid),this}SetAsArray(t,e=t.length){return this.Set(t,e)}SetAsBox(t,e,i,n=0){if(this.m_count=4,this.m_vertices=N.MakeArray(this.m_count),this.m_normals=N.MakeArray(this.m_count),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero(),i){this.m_centroid.Copy(i);const t=new X;t.SetPosition(i),t.SetRotationAngle(n);for(let e=0;e<this.m_count;++e)X.MulXV(t,this.m_vertices[e],this.m_vertices[e]),W.MulRV(t.q,this.m_normals[e],this.m_normals[e])}return this}TestPoint(t,e){const i=X.MulTXV(t,e,hi.TestPoint_s_pLocal);for(let n=0;n<this.m_count;++n){if(N.DotVV(this.m_normals[n],N.SubVV(i,this.m_vertices[n],N.s_t0))>0)return!1}return!0}ComputeDistance(t,e,n,r){const s=X.MulTXV(t,e,hi.ComputeDistance_s_pLocal);let o=-i;const a=hi.ComputeDistance_s_normalForMaxDistance.Copy(s);for(let i=0;i<this.m_count;++i){const t=N.DotVV(this.m_normals[i],N.SubVV(s,this.m_vertices[i],N.s_t0));t>o&&(o=t,a.Copy(this.m_normals[i]))}if(o>0){const e=hi.ComputeDistance_s_minDistance.Copy(a);let i=o*o;for(let t=0;t<this.m_count;++t){const n=N.SubVV(s,this.m_vertices[t],hi.ComputeDistance_s_distance),r=n.LengthSquared();i>r&&(e.Copy(n),i=r)}return W.MulRV(t.q,e,n),n.Normalize(),Math.sqrt(i)}return W.MulRV(t.q,a,n),o}RayCast(t,e,i,n){const r=X.MulTXV(i,e.p1,hi.RayCast_s_p1),s=X.MulTXV(i,e.p2,hi.RayCast_s_p2),o=N.SubVV(s,r,hi.RayCast_s_d);let a=0,l=e.maxFraction,u=-1;for(let c=0;c<this.m_count;++c){const t=N.DotVV(this.m_normals[c],N.SubVV(this.m_vertices[c],r,N.s_t0)),e=N.DotVV(this.m_normals[c],o);if(0===e){if(t<0)return!1}else e<0&&t<a*e?(a=t/e,u=c):e>0&&t<l*e&&(l=t/e);if(l<a)return!1}return u>=0&&(t.fraction=a,W.MulRV(i.q,this.m_normals[u],t.normal),!0)}ComputeAABB(t,e,i){const n=X.MulXV(e,this.m_vertices[0],t.lowerBound),r=t.upperBound.Copy(n);for(let o=0;o<this.m_count;++o){const t=X.MulXV(e,this.m_vertices[o],hi.ComputeAABB_s_v);N.MinV(t,n,n),N.MaxV(t,r,r)}const s=this.m_radius;n.SelfSubXY(s,s),r.SelfAddXY(s,s)}ComputeMass(t,e){const i=hi.ComputeMass_s_center.SetZero();let n=0,r=0;const s=hi.ComputeMass_s_s.SetZero();for(let o=0;o<this.m_count;++o)s.SelfAdd(this.m_vertices[o]);s.SelfMul(1/this.m_count);for(let o=0;o<this.m_count;++o){const t=N.SubVV(this.m_vertices[o],s,hi.ComputeMass_s_e1),e=N.SubVV(this.m_vertices[(o+1)%this.m_count],s,hi.ComputeMass_s_e2),a=N.CrossVV(t,e),l=.5*a;n+=l,i.SelfAdd(N.MulSV(l*(1/3),N.AddVV(t,e,N.s_t0),N.s_t1));const u=t.x,c=t.y,h=e.x,m=e.y;r+=1/3*.25*a*(u*u+h*u+h*h+(c*c+m*c+m*m))}t.mass=e*n,i.SelfMul(1/n),N.AddVV(i,s,t.center),t.I=e*r,t.I+=t.mass*(N.DotVV(t.center,t.center)-N.DotVV(i,i))}Validate(){for(let t=0;t<this.m_count;++t){const e=t,i=(t+1)%this.m_count,n=this.m_vertices[e],r=N.SubVV(this.m_vertices[i],n,hi.Validate_s_e);for(let t=0;t<this.m_count;++t){if(t===e||t===i)continue;const s=N.SubVV(this.m_vertices[t],n,hi.Validate_s_v);if(N.CrossVV(r,s)<0)return!1}}return!0}SetupDistanceProxy(t,e){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}ComputeSubmergedArea(t,e,i,r){const s=W.MulTRV(i.q,t,hi.ComputeSubmergedArea_s_normalL),o=e-N.DotVV(t,i.p),a=[];let l=0,u=-1,c=-1,h=!1;for(let w=0;w<this.m_count;++w){a[w]=N.DotVV(s,this.m_vertices[w])-o;const t=a[w]<-n;w>0&&(t?h||(u=w-1,l++):h&&(c=w-1,l++)),h=t}switch(l){case 0:if(h){const t=hi.ComputeSubmergedArea_s_md;return this.ComputeMass(t,1),X.MulXV(i,t.center,r),t.mass}return 0;case 1:-1===u?u=this.m_count-1:c=this.m_count-1}const m=(u+1)%this.m_count,_=(c+1)%this.m_count,f=(0-a[u])/(a[m]-a[u]),d=(0-a[c])/(a[_]-a[c]),p=hi.ComputeSubmergedArea_s_intoVec.Set(this.m_vertices[u].x*(1-f)+this.m_vertices[m].x*f,this.m_vertices[u].y*(1-f)+this.m_vertices[m].y*f),y=hi.ComputeSubmergedArea_s_outoVec.Set(this.m_vertices[c].x*(1-d)+this.m_vertices[_].x*d,this.m_vertices[c].y*(1-d)+this.m_vertices[_].y*d);let v=0;const g=hi.ComputeSubmergedArea_s_center.SetZero();let b,x=this.m_vertices[m],S=m;for(;S!==_;){S=(S+1)%this.m_count,b=S===_?y:this.m_vertices[S];const t=.5*((x.x-p.x)*(b.y-p.y)-(x.y-p.y)*(b.x-p.x));v+=t,g.x+=t*(p.x+x.x+b.x)/3,g.y+=t*(p.y+x.y+b.y)/3,x=b}return g.SelfMul(1/v),X.MulXV(i,g,r),v}Dump(t){t("    const shape: b2PolygonShape = new b2PolygonShape();\n"),t("    const vs: b2Vec2[] = [];\n");for(let e=0;e<this.m_count;++e)t("    vs[%d] = new b2Vec2(%.15f, %.15f);\n",e,this.m_vertices[e].x,this.m_vertices[e].y);t("    shape.Set(vs, %d);\n",this.m_count)}static ComputeCentroid(t,e,i){const n=i;n.SetZero();let r=0;const s=hi.ComputeCentroid_s_pRef.SetZero();for(let o=0;o<e;++o){const i=s,a=t[o],l=t[(o+1)%e],u=N.SubVV(a,i,hi.ComputeCentroid_s_e1),c=N.SubVV(l,i,hi.ComputeCentroid_s_e2),h=.5*N.CrossVV(u,c);r+=h,n.x+=h*(1/3)*(i.x+a.x+l.x),n.y+=h*(1/3)*(i.y+a.y+l.y)}return n.SelfMul(1/r),n}}hi.Set_s_r=new N,hi.Set_s_v=new N,hi.TestPoint_s_pLocal=new N,hi.ComputeDistance_s_pLocal=new N,hi.ComputeDistance_s_normalForMaxDistance=new N,hi.ComputeDistance_s_minDistance=new N,hi.ComputeDistance_s_distance=new N,hi.RayCast_s_p1=new N,hi.RayCast_s_p2=new N,hi.RayCast_s_d=new N,hi.ComputeAABB_s_v=new N,hi.ComputeMass_s_center=new N,hi.ComputeMass_s_s=new N,hi.ComputeMass_s_e1=new N,hi.ComputeMass_s_e2=new N,hi.Validate_s_e=new N,hi.Validate_s_v=new N,hi.ComputeSubmergedArea_s_normalL=new N,hi.ComputeSubmergedArea_s_md=new ri,hi.ComputeSubmergedArea_s_intoVec=new N,hi.ComputeSubmergedArea_s_outoVec=new N,hi.ComputeSubmergedArea_s_center=new N,hi.ComputeCentroid_s_pRef=new N,hi.ComputeCentroid_s_e1=new N,hi.ComputeCentroid_s_e2=new N;class mi extends ui{constructor(){super(t.b2ShapeType.e_edgeShape,u),this.m_vertex1=new N,this.m_vertex2=new N,this.m_vertex0=new N,this.m_vertex3=new N,this.m_hasVertex0=!1,this.m_hasVertex3=!1}Set(t,e){return this.m_vertex1.Copy(t),this.m_vertex2.Copy(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this}Clone(){return(new mi).Copy(this)}Copy(t){return super.Copy(t),this.m_vertex1.Copy(t.m_vertex1),this.m_vertex2.Copy(t.m_vertex2),this.m_vertex0.Copy(t.m_vertex0),this.m_vertex3.Copy(t.m_vertex3),this.m_hasVertex0=t.m_hasVertex0,this.m_hasVertex3=t.m_hasVertex3,this}GetChildCount(){return 1}TestPoint(t,e){return!1}ComputeDistance(t,e,i,n){const r=X.MulXV(t,this.m_vertex1,mi.ComputeDistance_s_v1),s=X.MulXV(t,this.m_vertex2,mi.ComputeDistance_s_v2),o=N.SubVV(e,r,mi.ComputeDistance_s_d),a=N.SubVV(s,r,mi.ComputeDistance_s_s),l=N.DotVV(o,a);if(l>0){const t=N.DotVV(a,a);l>t?N.SubVV(e,s,o):o.SelfMulSub(l/t,a)}return i.Copy(o),i.Normalize()}RayCast(t,e,i,n){const r=X.MulTXV(i,e.p1,mi.RayCast_s_p1),s=X.MulTXV(i,e.p2,mi.RayCast_s_p2),o=N.SubVV(s,r,mi.RayCast_s_d),a=this.m_vertex1,l=this.m_vertex2,u=N.SubVV(l,a,mi.RayCast_s_e),c=t.normal.Set(u.y,-u.x).SelfNormalize(),h=N.DotVV(c,N.SubVV(a,r,N.s_t0)),m=N.DotVV(c,o);if(0===m)return!1;const _=h/m;if(_<0||e.maxFraction<_)return!1;const f=N.AddVMulSV(r,_,o,mi.RayCast_s_q),d=N.SubVV(l,a,mi.RayCast_s_r),p=N.DotVV(d,d);if(0===p)return!1;const y=N.DotVV(N.SubVV(f,a,N.s_t0),d)/p;return!(y<0||1<y||(t.fraction=_,W.MulRV(i.q,t.normal,t.normal),h>0&&t.normal.SelfNeg(),0))}ComputeAABB(t,e,i){const n=X.MulXV(e,this.m_vertex1,mi.ComputeAABB_s_v1),r=X.MulXV(e,this.m_vertex2,mi.ComputeAABB_s_v2);N.MinV(n,r,t.lowerBound),N.MaxV(n,r,t.upperBound);const s=this.m_radius;t.lowerBound.SelfSubXY(s,s),t.upperBound.SelfAddXY(s,s)}ComputeMass(t,e){t.mass=0,N.MidVV(this.m_vertex1,this.m_vertex2,t.center),t.I=0}SetupDistanceProxy(t,e){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_vertex1),t.m_vertices[1].Copy(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}ComputeSubmergedArea(t,e,i,n){return n.SetZero(),0}Dump(t){t("    const shape: b2EdgeShape = new b2EdgeShape();\n"),t("    shape.m_radius = %.15f;\n",this.m_radius),t("    shape.m_vertex0.Set(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y),t("    shape.m_vertex1.Set(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y),t("    shape.m_vertex2.Set(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y),t("    shape.m_vertex3.Set(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y),t("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0),t("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)}}mi.ComputeDistance_s_v1=new N,mi.ComputeDistance_s_v2=new N,mi.ComputeDistance_s_d=new N,mi.ComputeDistance_s_s=new N,mi.RayCast_s_p1=new N,mi.RayCast_s_p2=new N,mi.RayCast_s_d=new N,mi.RayCast_s_e=new N,mi.RayCast_s_q=new N,mi.RayCast_s_r=new N,mi.ComputeAABB_s_v1=new N,mi.ComputeAABB_s_v2=new N;class _i extends ui{constructor(){super(t.b2ShapeType.e_chainShape,u),this.m_vertices=[],this.m_count=0,this.m_prevVertex=new N,this.m_nextVertex=new N,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1}CreateLoop(t,e=t.length,i=0){if(e<3)return this;this.m_count=e+1,this.m_vertices=N.MakeArray(this.m_count);for(let n=0;n<e;++n)this.m_vertices[n].Copy(t[i+n]);return this.m_vertices[e].Copy(this.m_vertices[0]),this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this}CreateChain(t,e=t.length,i=0){this.m_count=e,this.m_vertices=N.MakeArray(e);for(let n=0;n<e;++n)this.m_vertices[n].Copy(t[i+n]);return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex.SetZero(),this.m_nextVertex.SetZero(),this}SetPrevVertex(t){return this.m_prevVertex.Copy(t),this.m_hasPrevVertex=!0,this}SetNextVertex(t){return this.m_nextVertex.Copy(t),this.m_hasNextVertex=!0,this}Clone(){return(new _i).Copy(this)}Copy(t){return super.Copy(t),this.CreateChain(t.m_vertices,t.m_count),this.m_prevVertex.Copy(t.m_prevVertex),this.m_nextVertex.Copy(t.m_nextVertex),this.m_hasPrevVertex=t.m_hasPrevVertex,this.m_hasNextVertex=t.m_hasNextVertex,this}GetChildCount(){return this.m_count-1}GetChildEdge(e,i){e.m_type=t.b2ShapeType.e_edgeShape,e.m_radius=this.m_radius,e.m_vertex1.Copy(this.m_vertices[i]),e.m_vertex2.Copy(this.m_vertices[i+1]),i>0?(e.m_vertex0.Copy(this.m_vertices[i-1]),e.m_hasVertex0=!0):(e.m_vertex0.Copy(this.m_prevVertex),e.m_hasVertex0=this.m_hasPrevVertex),i<this.m_count-2?(e.m_vertex3.Copy(this.m_vertices[i+2]),e.m_hasVertex3=!0):(e.m_vertex3.Copy(this.m_nextVertex),e.m_hasVertex3=this.m_hasNextVertex)}TestPoint(t,e){return!1}ComputeDistance(t,e,i,n){const r=_i.ComputeDistance_s_edgeShape;return this.GetChildEdge(r,n),r.ComputeDistance(t,e,i,0)}RayCast(t,e,i,n){const r=_i.RayCast_s_edgeShape;return r.m_vertex1.Copy(this.m_vertices[n]),r.m_vertex2.Copy(this.m_vertices[(n+1)%this.m_count]),r.RayCast(t,e,i,0)}ComputeAABB(t,e,i){const n=this.m_vertices[i],r=this.m_vertices[(i+1)%this.m_count],s=X.MulXV(e,n,_i.ComputeAABB_s_v1),o=X.MulXV(e,r,_i.ComputeAABB_s_v2);N.MinV(s,o,t.lowerBound),N.MaxV(s,o,t.upperBound)}ComputeMass(t,e){t.mass=0,t.center.SetZero(),t.I=0}SetupDistanceProxy(t,e){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_vertices[e]),e+1<this.m_count?t.m_vertices[1].Copy(this.m_vertices[e+1]):t.m_vertices[1].Copy(this.m_vertices[0]),t.m_count=2,t.m_radius=this.m_radius}ComputeSubmergedArea(t,e,i,n){return n.SetZero(),0}Dump(t){t("    const shape: b2ChainShape = new b2ChainShape();\n"),t("    const vs: b2Vec2[] = [];\n");for(let e=0;e<this.m_count;++e)t("    vs[%d] = new bVec2(%.15f, %.15f);\n",e,this.m_vertices[e].x,this.m_vertices[e].y);t("    shape.CreateChain(vs, %d);\n",this.m_count),t("    shape.m_prevVertex.Set(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y),t("    shape.m_nextVertex.Set(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y),t("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false"),t("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")}}_i.ComputeDistance_s_edgeShape=new mi,_i.RayCast_s_edgeShape=new mi,_i.ComputeAABB_s_v1=new N,_i.ComputeAABB_s_v2=new N;class fi{constructor(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}Clone(){return(new fi).Copy(this)}Copy(t){return this.categoryBits=t.categoryBits,this.maskBits=t.maskBits,this.groupIndex=t.groupIndex||0,this}}fi.DEFAULT=new fi;class di{constructor(){this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter=new fi}}class pi{constructor(t){this.aabb=new Gt,this.childIndex=0,this.fixture=t}}class yi{constructor(t,e){this.m_density=0,this.m_next=null,this.m_friction=0,this.m_restitution=0,this.m_proxies=[],this.m_proxyCount=0,this.m_filter=new fi,this.m_isSensor=!1,this.m_userData=null,this.m_body=e,this.m_shape=t.shape.Clone()}GetType(){return this.m_shape.GetType()}GetShape(){return this.m_shape}SetSensor(t){t!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=t)}IsSensor(){return this.m_isSensor}SetFilterData(t){this.m_filter.Copy(t),this.Refilter()}GetFilterData(){return this.m_filter}Refilter(){let t=this.m_body.GetContactList();for(;t;){const e=t.contact,i=e.GetFixtureA(),n=e.GetFixtureB();i!==this&&n!==this||e.FlagForFiltering(),t=t.next}const e=this.m_body.GetWorld();if(null===e)return;const i=e.m_contactManager.m_broadPhase;for(let n=0;n<this.m_proxyCount;++n)i.TouchProxy(this.m_proxies[n].treeNode)}GetBody(){return this.m_body}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}TestPoint(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)}ComputeDistance(t,e,i){return this.m_shape.ComputeDistance(this.m_body.GetTransform(),t,e,i)}RayCast(t,e,i){return this.m_shape.RayCast(t,e,this.m_body.GetTransform(),i)}GetMassData(t=new ri){return this.m_shape.ComputeMass(t,this.m_density),t}SetDensity(t){this.m_density=t}GetDensity(){return this.m_density}GetFriction(){return this.m_friction}SetFriction(t){this.m_friction=t}GetRestitution(){return this.m_restitution}SetRestitution(t){this.m_restitution=t}GetAABB(t){return this.m_proxies[t].aabb}Dump(t,e){t("    const fd: b2FixtureDef = new b2FixtureDef();\n"),t("    fd.friction = %.15f;\n",this.m_friction),t("    fd.restitution = %.15f;\n",this.m_restitution),t("    fd.density = %.15f;\n",this.m_density),t("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),t("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),t("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),t("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(t),t("\n"),t("    fd.shape = shape;\n"),t("\n"),t("    bodies[%d].CreateFixture(fd);\n",e)}Create(t){this.m_userData=t.userData,this.m_friction=e(t.friction,.2),this.m_restitution=e(t.restitution,0),this.m_next=null,this.m_filter.Copy(e(t.filter,fi.DEFAULT)),this.m_isSensor=e(t.isSensor,!1),this.m_proxies=S(this.m_shape.GetChildCount(),(t=>new pi(this))),this.m_proxyCount=0,this.m_density=e(t.density,0)}Destroy(){}CreateProxies(t){const e=this.m_body.m_world.m_contactManager.m_broadPhase;this.m_proxyCount=this.m_shape.GetChildCount();for(let i=0;i<this.m_proxyCount;++i){const n=this.m_proxies[i]=new pi(this);this.m_shape.ComputeAABB(n.aabb,t,i),n.treeNode=e.CreateProxy(n.aabb,n),n.childIndex=i}}DestroyProxies(){const t=this.m_body.m_world.m_contactManager.m_broadPhase;for(let e=0;e<this.m_proxyCount;++e){const i=this.m_proxies[e];delete i.treeNode.userData,t.DestroyProxy(i.treeNode),delete i.treeNode}this.m_proxyCount=0}TouchProxies(){const t=this.m_body.m_world.m_contactManager.m_broadPhase,e=this.m_proxyCount;for(let i=0;i<e;++i)t.TouchProxy(this.m_proxies[i].treeNode)}Synchronize(t,e){if(0===this.m_proxyCount)return;const i=this.m_body.m_world.m_contactManager.m_broadPhase;for(let n=0;n<this.m_proxyCount;++n){const r=this.m_proxies[n],s=yi.Synchronize_s_aabb1,o=yi.Synchronize_s_aabb2;this.m_shape.ComputeAABB(s,t,n),this.m_shape.ComputeAABB(o,e,n),r.aabb.Combine2(s,o);const a=N.SubVV(e.p,t.p,yi.Synchronize_s_displacement);i.MoveProxy(r.treeNode,r.aabb,a)}}}yi.Synchronize_s_aabb1=new Gt,yi.Synchronize_s_aabb2=new Gt,yi.Synchronize_s_displacement=new N,(oi=t.b2BodyType||(t.b2BodyType={}))[oi.b2_unknown=-1]="b2_unknown",oi[oi.b2_staticBody=0]="b2_staticBody",oi[oi.b2_kinematicBody=1]="b2_kinematicBody",oi[oi.b2_dynamicBody=2]="b2_dynamicBody";class vi{constructor(i,n){this.m_type=t.b2BodyType.b2_staticBody,this.m_islandFlag=!1,this.m_awakeFlag=!1,this.m_autoSleepFlag=!1,this.m_bulletFlag=!1,this.m_fixedRotationFlag=!1,this.m_activeFlag=!1,this.m_toiFlag=!1,this.m_islandIndex=0,this.m_xf=new X,this.m_xf0=new X,this.m_sweep=new H,this.m_linearVelocity=new N,this.m_angularVelocity=0,this.m_force=new N,this.m_torque=0,this.m_prev=null,this.m_next=null,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_jointList=null,this.m_contactList=null,this.m_mass=1,this.m_invMass=1,this.m_I=0,this.m_invI=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_gravityScale=1,this.m_sleepTime=0,this.m_userData=null,this.m_controllerList=null,this.m_controllerCount=0,this.m_bulletFlag=e(i.bullet,!1),this.m_fixedRotationFlag=e(i.fixedRotation,!1),this.m_autoSleepFlag=e(i.allowSleep,!0),this.m_awakeFlag=e(i.awake,!0),this.m_activeFlag=e(i.active,!0),this.m_world=n,this.m_xf.p.Copy(e(i.position,N.ZERO)),this.m_xf.q.SetAngle(e(i.angle,0)),this.m_xf0.Copy(this.m_xf),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a=this.m_xf.q.GetAngle(),this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(e(i.linearVelocity,N.ZERO)),this.m_angularVelocity=e(i.angularVelocity,0),this.m_linearDamping=e(i.linearDamping,0),this.m_angularDamping=e(i.angularDamping,0),this.m_gravityScale=e(i.gravityScale,1),this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=e(i.type,t.b2BodyType.b2_staticBody),i.type===t.b2BodyType.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_userData=i.userData,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_controllerList=null,this.m_controllerCount=0}CreateFixture(t,e=0){return t instanceof ui?this.CreateFixtureShapeDensity(t,e):this.CreateFixtureDef(t)}CreateFixtureDef(t){if(this.m_world.IsLocked())throw new Error;const e=new yi(t,this);return e.Create(t),this.m_activeFlag&&e.CreateProxies(this.m_xf),e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_density>0&&this.ResetMassData(),this.m_world.m_newFixture=!0,e}CreateFixtureShapeDensity(t,e=0){const i=vi.CreateFixtureShapeDensity_s_def;return i.shape=t,i.density=e,this.CreateFixtureDef(i)}DestroyFixture(t){if(this.m_world.IsLocked())throw new Error;let e=this.m_fixtureList,i=null;for(;null!==e;){if(e===t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next;break}i=e,e=e.m_next}let n=this.m_contactList;for(;n;){const e=n.contact;n=n.next;const i=e.GetFixtureA(),r=e.GetFixtureB();t!==i&&t!==r||this.m_world.m_contactManager.Destroy(e)}this.m_activeFlag&&t.DestroyProxies(),t.m_next=null,t.Destroy(),--this.m_fixtureCount,this.ResetMassData()}SetTransformVec(t,e){this.SetTransformXY(t.x,t.y,e)}SetTransformXY(t,e,i){if(this.m_world.IsLocked())throw new Error;this.m_xf.q.SetAngle(i),this.m_xf.p.Set(t,e),this.m_xf0.Copy(this.m_xf),X.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=i,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=i;for(let n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}SetTransform(t){this.SetTransformVec(t.p,t.GetAngle())}GetTransform(){return this.m_xf}GetPosition(){return this.m_xf.p}SetPosition(t){this.SetTransformVec(t,this.GetAngle())}SetPositionXY(t,e){this.SetTransformXY(t,e,this.GetAngle())}GetAngle(){return this.m_sweep.a}SetAngle(t){this.SetTransformVec(this.GetPosition(),t)}GetWorldCenter(){return this.m_sweep.c}GetLocalCenter(){return this.m_sweep.localCenter}SetLinearVelocity(e){this.m_type!==t.b2BodyType.b2_staticBody&&(N.DotVV(e,e)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(e))}GetLinearVelocity(){return this.m_linearVelocity}SetAngularVelocity(e){this.m_type!==t.b2BodyType.b2_staticBody&&(e*e>0&&this.SetAwake(!0),this.m_angularVelocity=e)}GetAngularVelocity(){return this.m_angularVelocity}GetDefinition(t){return t.type=this.GetType(),t.allowSleep=this.m_autoSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.gravityScale=this.m_gravityScale,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=this.m_fixedRotationFlag,t.bullet=this.m_bulletFlag,t.awake=this.m_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.Copy(this.GetLinearVelocity()),t.position.Copy(this.GetPosition()),t.userData=this.GetUserData(),t}ApplyForce(e,i,n=!0){this.m_type===t.b2BodyType.b2_dynamicBody&&(n&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x))}ApplyForceToCenter(e,i=!0){this.m_type===t.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=e.x,this.m_force.y+=e.y))}ApplyTorque(e,i=!0){this.m_type===t.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_torque+=e))}ApplyLinearImpulse(e,i,n=!0){this.m_type===t.b2BodyType.b2_dynamicBody&&(n&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x)))}ApplyLinearImpulseToCenter(e,i=!0){this.m_type===t.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y))}ApplyAngularImpulse(e,i=!0){this.m_type===t.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*e))}GetMass(){return this.m_mass}GetInertia(){return this.m_I+this.m_mass*N.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)}GetMassData(t){return t.mass=this.m_mass,t.I=this.m_I+this.m_mass*N.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter),t.center.Copy(this.m_sweep.localCenter),t}SetMassData(e){if(this.m_world.IsLocked())throw new Error;if(this.m_type!==t.b2BodyType.b2_dynamicBody)return;this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&!this.m_fixedRotationFlag&&(this.m_I=e.I-this.m_mass*N.DotVV(e.center,e.center),this.m_invI=1/this.m_I);const i=vi.SetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e.center),X.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),N.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,N.SubVV(this.m_sweep.c,i,N.s_t0),this.m_linearVelocity)}ResetMassData(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===t.b2BodyType.b2_staticBody||this.m_type===t.b2BodyType.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);const e=vi.ResetMassData_s_localCenter.SetZero();for(let t=this.m_fixtureList;t;t=t.m_next){if(0===t.m_density)continue;const i=t.GetMassData(vi.ResetMassData_s_massData);this.m_mass+=i.mass,e.x+=i.center.x*i.mass,e.y+=i.center.y*i.mass,this.m_I+=i.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&!this.m_fixedRotationFlag?(this.m_I-=this.m_mass*N.DotVV(e,e),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);const i=vi.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e),X.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),N.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,N.SubVV(this.m_sweep.c,i,N.s_t0),this.m_linearVelocity)}GetWorldPoint(t,e){return X.MulXV(this.m_xf,t,e)}GetWorldVector(t,e){return W.MulRV(this.m_xf.q,t,e)}GetLocalPoint(t,e){return X.MulTXV(this.m_xf,t,e)}GetLocalVector(t,e){return W.MulTRV(this.m_xf.q,t,e)}GetLinearVelocityFromWorldPoint(t,e){return N.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,N.SubVV(t,this.m_sweep.c,N.s_t0),e)}GetLinearVelocityFromLocalPoint(t,e){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t,e),e)}GetLinearDamping(){return this.m_linearDamping}SetLinearDamping(t){this.m_linearDamping=t}GetAngularDamping(){return this.m_angularDamping}SetAngularDamping(t){this.m_angularDamping=t}GetGravityScale(){return this.m_gravityScale}SetGravityScale(t){this.m_gravityScale=t}SetType(e){if(this.m_world.IsLocked())throw new Error;if(this.m_type===e)return;this.m_type=e,this.ResetMassData(),this.m_type===t.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;let i=this.m_contactList;for(;i;){const t=i;i=i.next,this.m_world.m_contactManager.Destroy(t.contact)}this.m_contactList=null;for(let t=this.m_fixtureList;t;t=t.m_next)t.TouchProxies()}GetType(){return this.m_type}SetBullet(t){this.m_bulletFlag=t}IsBullet(){return this.m_bulletFlag}SetSleepingAllowed(t){this.m_autoSleepFlag=t,t||this.SetAwake(!0)}IsSleepingAllowed(){return this.m_autoSleepFlag}SetAwake(t){t?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)}IsAwake(){return this.m_awakeFlag}SetActive(t){if(this.m_world.IsLocked())throw new Error;if(t!==this.IsActive())if(this.m_activeFlag=t,t)for(let e=this.m_fixtureList;e;e=e.m_next)e.CreateProxies(this.m_xf);else{for(let e=this.m_fixtureList;e;e=e.m_next)e.DestroyProxies();let t=this.m_contactList;for(;t;){const e=t;t=t.next,this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null}}IsActive(){return this.m_activeFlag}SetFixedRotation(t){this.m_fixedRotationFlag!==t&&(this.m_fixedRotationFlag=t,this.m_angularVelocity=0,this.ResetMassData())}IsFixedRotation(){return this.m_fixedRotationFlag}GetFixtureList(){return this.m_fixtureList}GetJointList(){return this.m_jointList}GetContactList(){return this.m_contactList}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}GetWorld(){return this.m_world}Dump(e){const i=this.m_islandIndex;e("{\n"),e("  const bd: b2BodyDef = new b2BodyDef();\n");let n="";switch(this.m_type){case t.b2BodyType.b2_staticBody:n="b2BodyType.b2_staticBody";break;case t.b2BodyType.b2_kinematicBody:n="b2BodyType.b2_kinematicBody";break;case t.b2BodyType.b2_dynamicBody:n="b2BodyType.b2_dynamicBody"}e("  bd.type = %s;\n",n),e("  bd.position.Set(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y),e("  bd.angle = %.15f;\n",this.m_sweep.a),e("  bd.linearVelocity.Set(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y),e("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity),e("  bd.linearDamping = %.15f;\n",this.m_linearDamping),e("  bd.angularDamping = %.15f;\n",this.m_angularDamping),e("  bd.allowSleep = %s;\n",this.m_autoSleepFlag?"true":"false"),e("  bd.awake = %s;\n",this.m_awakeFlag?"true":"false"),e("  bd.fixedRotation = %s;\n",this.m_fixedRotationFlag?"true":"false"),e("  bd.bullet = %s;\n",this.m_bulletFlag?"true":"false"),e("  bd.active = %s;\n",this.m_activeFlag?"true":"false"),e("  bd.gravityScale = %.15f;\n",this.m_gravityScale),e("\n"),e("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex),e("\n");for(let t=this.m_fixtureList;t;t=t.m_next)e("  {\n"),t.Dump(e,i),e("  }\n");e("}\n")}SynchronizeFixtures(){const t=vi.SynchronizeFixtures_s_xf1;t.q.SetAngle(this.m_sweep.a0),W.MulRV(t.q,this.m_sweep.localCenter,t.p),N.SubVV(this.m_sweep.c0,t.p,t.p);for(let e=this.m_fixtureList;e;e=e.m_next)e.Synchronize(t,this.m_xf)}SynchronizeTransform(){this.m_xf.q.SetAngle(this.m_sweep.a),W.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),N.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}ShouldCollide(e){return(this.m_type!==t.b2BodyType.b2_staticBody||e.m_type!==t.b2BodyType.b2_staticBody)&&this.ShouldCollideConnected(e)}ShouldCollideConnected(t){for(let e=this.m_jointList;e;e=e.next)if(e.other===t&&!e.joint.m_collideConnected)return!1;return!0}Advance(t){this.m_sweep.Advance(t),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.SetAngle(this.m_sweep.a),W.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),N.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}GetControllerList(){return this.m_controllerList}GetControllerCount(){return this.m_controllerCount}}vi.CreateFixtureShapeDensity_s_def=new di,vi.SetMassData_s_oldCenter=new N,vi.ResetMassData_s_localCenter=new N,vi.ResetMassData_s_oldCenter=new N,vi.ResetMassData_s_massData=new ri,vi.SynchronizeFixtures_s_xf1=new X,(li=t.b2JointType||(t.b2JointType={}))[li.e_unknownJoint=0]="e_unknownJoint",li[li.e_revoluteJoint=1]="e_revoluteJoint",li[li.e_prismaticJoint=2]="e_prismaticJoint",li[li.e_distanceJoint=3]="e_distanceJoint",li[li.e_pulleyJoint=4]="e_pulleyJoint",li[li.e_mouseJoint=5]="e_mouseJoint",li[li.e_gearJoint=6]="e_gearJoint",li[li.e_wheelJoint=7]="e_wheelJoint",li[li.e_weldJoint=8]="e_weldJoint",li[li.e_frictionJoint=9]="e_frictionJoint",li[li.e_ropeJoint=10]="e_ropeJoint",li[li.e_motorJoint=11]="e_motorJoint",li[li.e_areaJoint=12]="e_areaJoint",(ai=t.b2LimitState||(t.b2LimitState={}))[ai.e_inactiveLimit=0]="e_inactiveLimit",ai[ai.e_atLowerLimit=1]="e_atLowerLimit",ai[ai.e_atUpperLimit=2]="e_atUpperLimit",ai[ai.e_equalLimits=3]="e_equalLimits";class gi{constructor(t,e){this.prev=null,this.next=null,this.joint=t,this.other=e}}class bi{constructor(e){this.type=t.b2JointType.e_unknownJoint,this.userData=null,this.collideConnected=!1,this.type=e}}class xi{constructor(i){this.m_type=t.b2JointType.e_unknownJoint,this.m_prev=null,this.m_next=null,this.m_index=0,this.m_islandFlag=!1,this.m_collideConnected=!1,this.m_userData=null,this.m_type=i.type,this.m_edgeA=new gi(this,i.bodyB),this.m_edgeB=new gi(this,i.bodyA),this.m_bodyA=i.bodyA,this.m_bodyB=i.bodyB,this.m_collideConnected=e(i.collideConnected,!1),this.m_userData=i.userData}GetType(){return this.m_type}GetBodyA(){return this.m_bodyA}GetBodyB(){return this.m_bodyB}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}IsActive(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()}GetCollideConnected(){return this.m_collideConnected}Dump(t){t("// Dump is not supported for this joint type.\n")}ShiftOrigin(t){}}class Si extends bi{constructor(){super(t.b2JointType.e_distanceJoint),this.localAnchorA=new N,this.localAnchorB=new N,this.length=1,this.frequencyHz=0,this.dampingRatio=0}Initialize(t,e,i,n){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(n,this.localAnchorB),this.length=N.DistanceVV(i,n),this.frequencyHz=0,this.dampingRatio=0}}class wi extends xi{constructor(t){super(t),this.m_frequencyHz=0,this.m_dampingRatio=0,this.m_bias=0,this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_gamma=0,this.m_impulse=0,this.m_length=0,this.m_indexA=0,this.m_indexB=0,this.m_u=new N,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_frequencyHz=e(t.frequencyHz,0),this.m_dampingRatio=e(t.dampingRatio,0),this.m_localAnchorA.Copy(t.localAnchorA),this.m_localAnchorB.Copy(t.localAnchorB),this.m_length=t.length}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*this.m_impulse*this.m_u.x,e.y=t*this.m_impulse*this.m_u.y,e}GetReactionTorque(t){return 0}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetLength(t){this.m_length=t}Length(){return this.m_length}SetFrequency(t){this.m_frequencyHz=t}GetFrequency(){return this.m_frequencyHz}SetDampingRatio(t){this.m_dampingRatio=t}GetDampingRatio(){return this.m_dampingRatio}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2DistanceJointDef = new b2DistanceJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.length = %.15f;\n",this.m_length),t("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),t("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].c,i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v;let r=t.velocities[this.m_indexA].w;const o=t.positions[this.m_indexB].c,l=t.positions[this.m_indexB].a,u=t.velocities[this.m_indexB].v;let c=t.velocities[this.m_indexB].w;const h=this.m_qA.SetAngle(i),m=this.m_qB.SetAngle(l);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),W.MulRV(h,this.m_lalcA,this.m_rA),N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),W.MulRV(m,this.m_lalcB,this.m_rB),this.m_u.x=o.x+this.m_rB.x-e.x-this.m_rA.x,this.m_u.y=o.y+this.m_rB.y-e.y-this.m_rA.y;const _=this.m_u.Length();_>a?this.m_u.SelfMul(1/_):this.m_u.SetZero();const f=N.CrossVV(this.m_rA,this.m_u),d=N.CrossVV(this.m_rB,this.m_u);let p=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*d*d;if(this.m_mass=0!==p?1/p:0,this.m_frequencyHz>0){const e=_-this.m_length,i=2*s*this.m_frequencyHz,n=2*this.m_mass*this.m_dampingRatio*i,r=this.m_mass*i*i,o=t.step.dt;this.m_gamma=o*(n+o*r),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=e*o*r*this.m_gamma,p+=this.m_gamma,this.m_mass=0!==p?1/p:0}else this.m_gamma=0,this.m_bias=0;if(t.step.warmStarting){this.m_impulse*=t.step.dtRatio;const e=N.MulSV(this.m_impulse,this.m_u,wi.InitVelocityConstraints_s_P);n.SelfMulSub(this.m_invMassA,e),r-=this.m_invIA*N.CrossVV(this.m_rA,e),u.SelfMulAdd(this.m_invMassB,e),c+=this.m_invIB*N.CrossVV(this.m_rB,e)}else this.m_impulse=0;t.velocities[this.m_indexA].w=r,t.velocities[this.m_indexB].w=c}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=N.AddVCrossSV(e,i,this.m_rA,wi.SolveVelocityConstraints_s_vpA),o=N.AddVCrossSV(n,r,this.m_rB,wi.SolveVelocityConstraints_s_vpB),a=N.DotVV(this.m_u,N.SubVV(o,s,N.s_t0)),l=-this.m_mass*(a+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=l;const u=N.MulSV(l,this.m_u,wi.SolveVelocityConstraints_s_P);e.SelfMulSub(this.m_invMassA,u),i-=this.m_invIA*N.CrossVV(this.m_rA,u),n.SelfMulAdd(this.m_invMassB,u),r+=this.m_invIB*N.CrossVV(this.m_rB,u),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r}SolvePositionConstraints(t){if(this.m_frequencyHz>0)return!0;const e=t.positions[this.m_indexA].c;let i=t.positions[this.m_indexA].a;const n=t.positions[this.m_indexB].c;let r=t.positions[this.m_indexB].a;const s=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(r),l=W.MulRV(s,this.m_lalcA,this.m_rA),u=W.MulRV(o,this.m_lalcB,this.m_rB),h=this.m_u;h.x=n.x+u.x-e.x-l.x,h.y=n.y+u.y-e.y-l.y;let m=this.m_u.Normalize()-this.m_length;m=I(m,-c,c);const _=-this.m_mass*m,f=N.MulSV(_,h,wi.SolvePositionConstraints_s_P);return e.SelfMulSub(this.m_invMassA,f),i-=this.m_invIA*N.CrossVV(l,f),n.SelfMulAdd(this.m_invMassB,f),r+=this.m_invIB*N.CrossVV(u,f),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].a=r,V(m)<a}}wi.InitVelocityConstraints_s_P=new N,wi.SolveVelocityConstraints_s_vpA=new N,wi.SolveVelocityConstraints_s_vpB=new N,wi.SolveVelocityConstraints_s_P=new N,wi.SolvePositionConstraints_s_P=new N;class Bi extends xi{constructor(t){super(t),this.m_frequencyHz=0,this.m_dampingRatio=0,this.m_impulse=0,this.m_targetArea=0,this.m_bodies=t.bodies,this.m_frequencyHz=e(t.frequencyHz,0),this.m_dampingRatio=e(t.dampingRatio,0),this.m_targetLengths=w(t.bodies.length),this.m_normals=N.MakeArray(t.bodies.length),this.m_joints=[],this.m_deltas=N.MakeArray(t.bodies.length),this.m_delta=new N;const i=new Si;i.frequencyHz=this.m_frequencyHz,i.dampingRatio=this.m_dampingRatio,this.m_targetArea=0;for(let e=0;e<this.m_bodies.length;++e){const t=this.m_bodies[e],n=this.m_bodies[(e+1)%this.m_bodies.length],r=t.GetWorldCenter(),s=n.GetWorldCenter();this.m_targetLengths[e]=N.DistanceVV(r,s),this.m_targetArea+=N.CrossVV(r,s),i.Initialize(t,n,r,s),this.m_joints[e]=t.GetWorld().CreateJoint(i)}this.m_targetArea*=.5}GetAnchorA(t){return t}GetAnchorB(t){return t}GetReactionForce(t,e){return e}GetReactionTorque(t){return 0}SetFrequency(t){this.m_frequencyHz=t;for(let e=0;e<this.m_joints.length;++e)this.m_joints[e].SetFrequency(t)}GetFrequency(){return this.m_frequencyHz}SetDampingRatio(t){this.m_dampingRatio=t;for(let e=0;e<this.m_joints.length;++e)this.m_joints[e].SetDampingRatio(t)}GetDampingRatio(){return this.m_dampingRatio}Dump(t){t("Area joint dumping is not supported.\n")}InitVelocityConstraints(t){for(let e=0;e<this.m_bodies.length;++e){const i=this.m_bodies[(e+this.m_bodies.length-1)%this.m_bodies.length],n=this.m_bodies[(e+1)%this.m_bodies.length],r=t.positions[i.m_islandIndex].c,s=t.positions[n.m_islandIndex].c,o=this.m_deltas[e];N.SubVV(s,r,o)}if(t.step.warmStarting){this.m_impulse*=t.step.dtRatio;for(let e=0;e<this.m_bodies.length;++e){const i=this.m_bodies[e],n=t.velocities[i.m_islandIndex].v,r=this.m_deltas[e];n.x+=i.m_invMass*r.y*.5*this.m_impulse,n.y+=i.m_invMass*-r.x*.5*this.m_impulse}}else this.m_impulse=0}SolveVelocityConstraints(t){let e=0,i=0;for(let r=0;r<this.m_bodies.length;++r){const n=this.m_bodies[r],s=t.velocities[n.m_islandIndex].v,o=this.m_deltas[r];e+=o.LengthSquared()/n.GetMass(),i+=N.CrossVV(s,o)}const n=-2*i/e;this.m_impulse+=n;for(let r=0;r<this.m_bodies.length;++r){const e=this.m_bodies[r],i=t.velocities[e.m_islandIndex].v,s=this.m_deltas[r];i.x+=e.m_invMass*s.y*.5*n,i.y+=e.m_invMass*-s.x*.5*n}}SolvePositionConstraints(t){let e=0,i=0;for(let o=0;o<this.m_bodies.length;++o){const r=this.m_bodies[o],s=this.m_bodies[(o+1)%this.m_bodies.length],a=t.positions[r.m_islandIndex].c,l=t.positions[s.m_islandIndex].c,u=N.SubVV(l,a,this.m_delta);let c=u.Length();c<n&&(c=1),this.m_normals[o].x=u.y/c,this.m_normals[o].y=-u.x/c,e+=c,i+=N.CrossVV(a,l)}i*=.5;const r=.5*(this.m_targetArea-i)/e;let s=!0;for(let n=0;n<this.m_bodies.length;++n){const e=this.m_bodies[n],i=t.positions[e.m_islandIndex].c,o=(n+1)%this.m_bodies.length,l=N.AddVV(this.m_normals[n],this.m_normals[o],this.m_delta);l.SelfMul(r);const u=l.LengthSquared();u>D(c)&&l.SelfMul(c/T(u)),u>D(a)&&(s=!1),i.x+=l.x,i.y+=l.y}return s}}class Ci extends xi{constructor(t){super(t),this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_linearImpulse=new N,this.m_angularImpulse=0,this.m_maxForce=0,this.m_maxTorque=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new U,this.m_angularMass=0,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_K=new U,this.m_localAnchorA.Copy(t.localAnchorA),this.m_localAnchorB.Copy(t.localAnchorB),this.m_linearImpulse.SetZero(),this.m_maxForce=e(t.maxForce,0),this.m_maxTorque=e(t.maxTorque,0),this.m_linearMass.SetZero()}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].a,i=t.velocities[this.m_indexA].v;let n=t.velocities[this.m_indexA].w;const r=t.positions[this.m_indexB].a,s=t.velocities[this.m_indexB].v;let o=t.velocities[this.m_indexB].w;const a=this.m_qA.SetAngle(e),l=this.m_qB.SetAngle(r);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const u=W.MulRV(a,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const c=W.MulRV(l,this.m_lalcB,this.m_rB),h=this.m_invMassA,m=this.m_invMassB,_=this.m_invIA,f=this.m_invIB,d=this.m_K;if(d.ex.x=h+m+_*u.y*u.y+f*c.y*c.y,d.ex.y=-_*u.x*u.y-f*c.x*c.y,d.ey.x=d.ex.y,d.ey.y=h+m+_*u.x*u.x+f*c.x*c.x,d.GetInverse(this.m_linearMass),this.m_angularMass=_+f,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.step.warmStarting){this.m_linearImpulse.SelfMul(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio;const e=this.m_linearImpulse;i.SelfMulSub(h,e),n-=_*(N.CrossVV(this.m_rA,e)+this.m_angularImpulse),s.SelfMulAdd(m,e),o+=f*(N.CrossVV(this.m_rB,e)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=o}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=this.m_invMassA,o=this.m_invMassB,a=this.m_invIA,l=this.m_invIB,u=t.step.dt;{const t=r-i;let e=-this.m_angularMass*t;const n=this.m_angularImpulse,s=u*this.m_maxTorque;this.m_angularImpulse=I(this.m_angularImpulse+e,-s,s),e=this.m_angularImpulse-n,i-=a*e,r+=l*e}{const t=N.SubVV(N.AddVCrossSV(n,r,this.m_rB,N.s_t0),N.AddVCrossSV(e,i,this.m_rA,N.s_t1),Ci.SolveVelocityConstraints_s_Cdot_v2),c=U.MulMV(this.m_linearMass,t,Ci.SolveVelocityConstraints_s_impulseV).SelfNeg(),h=Ci.SolveVelocityConstraints_s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(c);const m=u*this.m_maxForce;this.m_linearImpulse.LengthSquared()>m*m&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(m)),N.SubVV(this.m_linearImpulse,h,c),e.SelfMulSub(s,c),i-=a*N.CrossVV(this.m_rA,c),n.SelfMulAdd(o,c),r+=l*N.CrossVV(this.m_rB,c)}t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r}SolvePositionConstraints(t){return!0}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*this.m_linearImpulse.x,e.y=t*this.m_linearImpulse.y,e}GetReactionTorque(t){return t*this.m_angularImpulse}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetMaxTorque(t){this.m_maxTorque=t}GetMaxTorque(){return this.m_maxTorque}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2FrictionJointDef = new b2FrictionJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.maxForce = %.15f;\n",this.m_maxForce),t("  jd.maxTorque = %.15f;\n",this.m_maxTorque),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}Ci.SolveVelocityConstraints_s_Cdot_v2=new N,Ci.SolveVelocityConstraints_s_impulseV=new N,Ci.SolveVelocityConstraints_s_oldImpulseV=new N;class Ai extends xi{constructor(i){let n,r;super(i),this.m_typeA=t.b2JointType.e_unknownJoint,this.m_typeB=t.b2JointType.e_unknownJoint,this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_localAnchorC=new N,this.m_localAnchorD=new N,this.m_localAxisC=new N,this.m_localAxisD=new N,this.m_referenceAngleA=0,this.m_referenceAngleB=0,this.m_constant=0,this.m_ratio=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_indexC=0,this.m_indexD=0,this.m_lcA=new N,this.m_lcB=new N,this.m_lcC=new N,this.m_lcD=new N,this.m_mA=0,this.m_mB=0,this.m_mC=0,this.m_mD=0,this.m_iA=0,this.m_iB=0,this.m_iC=0,this.m_iD=0,this.m_JvAC=new N,this.m_JvBD=new N,this.m_JwA=0,this.m_JwB=0,this.m_JwC=0,this.m_JwD=0,this.m_mass=0,this.m_qA=new W,this.m_qB=new W,this.m_qC=new W,this.m_qD=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_lalcC=new N,this.m_lalcD=new N,this.m_joint1=i.joint1,this.m_joint2=i.joint2,this.m_typeA=this.m_joint1.GetType(),this.m_typeB=this.m_joint2.GetType(),this.m_bodyC=this.m_joint1.GetBodyA(),this.m_bodyA=this.m_joint1.GetBodyB();const s=this.m_bodyA.m_xf,o=this.m_bodyA.m_sweep.a,a=this.m_bodyC.m_xf,l=this.m_bodyC.m_sweep.a;if(this.m_typeA===t.b2JointType.e_revoluteJoint){const t=i.joint1;this.m_localAnchorC.Copy(t.m_localAnchorA),this.m_localAnchorA.Copy(t.m_localAnchorB),this.m_referenceAngleA=t.m_referenceAngle,this.m_localAxisC.SetZero(),n=o-l-this.m_referenceAngleA}else{const t=i.joint1;this.m_localAnchorC.Copy(t.m_localAnchorA),this.m_localAnchorA.Copy(t.m_localAnchorB),this.m_referenceAngleA=t.m_referenceAngle,this.m_localAxisC.Copy(t.m_localXAxisA);const e=this.m_localAnchorC,r=W.MulTRV(a.q,N.AddVV(W.MulRV(s.q,this.m_localAnchorA,N.s_t0),N.SubVV(s.p,a.p,N.s_t1),N.s_t0),N.s_t0);n=N.DotVV(N.SubVV(r,e,N.s_t0),this.m_localAxisC)}this.m_bodyD=this.m_joint2.GetBodyA(),this.m_bodyB=this.m_joint2.GetBodyB();const u=this.m_bodyB.m_xf,c=this.m_bodyB.m_sweep.a,h=this.m_bodyD.m_xf,m=this.m_bodyD.m_sweep.a;if(this.m_typeB===t.b2JointType.e_revoluteJoint){const t=i.joint2;this.m_localAnchorD.Copy(t.m_localAnchorA),this.m_localAnchorB.Copy(t.m_localAnchorB),this.m_referenceAngleB=t.m_referenceAngle,this.m_localAxisD.SetZero(),r=c-m-this.m_referenceAngleB}else{const t=i.joint2;this.m_localAnchorD.Copy(t.m_localAnchorA),this.m_localAnchorB.Copy(t.m_localAnchorB),this.m_referenceAngleB=t.m_referenceAngle,this.m_localAxisD.Copy(t.m_localXAxisA);const e=this.m_localAnchorD,n=W.MulTRV(h.q,N.AddVV(W.MulRV(u.q,this.m_localAnchorB,N.s_t0),N.SubVV(u.p,h.p,N.s_t1),N.s_t0),N.s_t0);r=N.DotVV(N.SubVV(n,e,N.s_t0),this.m_localAxisD)}this.m_ratio=e(i.ratio,1),this.m_constant=n+this.m_ratio*r,this.m_impulse=0}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;const i=e.positions[this.m_indexA].a,n=e.velocities[this.m_indexA].v;let r=e.velocities[this.m_indexA].w;const s=e.positions[this.m_indexB].a,o=e.velocities[this.m_indexB].v;let a=e.velocities[this.m_indexB].w;const l=e.positions[this.m_indexC].a,u=e.velocities[this.m_indexC].v;let c=e.velocities[this.m_indexC].w;const h=e.positions[this.m_indexD].a,m=e.velocities[this.m_indexD].v;let _=e.velocities[this.m_indexD].w;const f=this.m_qA.SetAngle(i),d=this.m_qB.SetAngle(s),p=this.m_qC.SetAngle(l),y=this.m_qD.SetAngle(h);if(this.m_mass=0,this.m_typeA===t.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{const t=W.MulRV(p,this.m_localAxisC,Ai.InitVelocityConstraints_s_u);N.SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC);const e=W.MulRV(p,this.m_lalcC,Ai.InitVelocityConstraints_s_rC);N.SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA);const i=W.MulRV(f,this.m_lalcA,Ai.InitVelocityConstraints_s_rA);this.m_JvAC.Copy(t),this.m_JwC=N.CrossVV(e,t),this.m_JwA=N.CrossVV(i,t),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===t.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{const t=W.MulRV(y,this.m_localAxisD,Ai.InitVelocityConstraints_s_u);N.SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD);const e=W.MulRV(y,this.m_lalcD,Ai.InitVelocityConstraints_s_rD);N.SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB);const i=W.MulRV(d,this.m_lalcB,Ai.InitVelocityConstraints_s_rB);N.MulSV(this.m_ratio,t,this.m_JvBD),this.m_JwD=this.m_ratio*N.CrossVV(e,t),this.m_JwB=this.m_ratio*N.CrossVV(i,t),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,e.step.warmStarting?(n.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),r+=this.m_iA*this.m_impulse*this.m_JwA,o.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),a+=this.m_iB*this.m_impulse*this.m_JwB,u.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),c-=this.m_iC*this.m_impulse*this.m_JwC,m.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),_-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,e.velocities[this.m_indexA].w=r,e.velocities[this.m_indexB].w=a,e.velocities[this.m_indexC].w=c,e.velocities[this.m_indexD].w=_}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=t.velocities[this.m_indexC].v;let o=t.velocities[this.m_indexC].w;const a=t.velocities[this.m_indexD].v;let l=t.velocities[this.m_indexD].w,u=N.DotVV(this.m_JvAC,N.SubVV(e,s,N.s_t0))+N.DotVV(this.m_JvBD,N.SubVV(n,a,N.s_t0));u+=this.m_JwA*i-this.m_JwC*o+(this.m_JwB*r-this.m_JwD*l);const c=-this.m_mass*u;this.m_impulse+=c,e.SelfMulAdd(this.m_mA*c,this.m_JvAC),i+=this.m_iA*c*this.m_JwA,n.SelfMulAdd(this.m_mB*c,this.m_JvBD),r+=this.m_iB*c*this.m_JwB,s.SelfMulSub(this.m_mC*c,this.m_JvAC),o-=this.m_iC*c*this.m_JwC,a.SelfMulSub(this.m_mD*c,this.m_JvBD),l-=this.m_iD*c*this.m_JwD,t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r,t.velocities[this.m_indexC].w=o,t.velocities[this.m_indexD].w=l}SolvePositionConstraints(e){const i=e.positions[this.m_indexA].c;let n=e.positions[this.m_indexA].a;const r=e.positions[this.m_indexB].c;let s=e.positions[this.m_indexB].a;const o=e.positions[this.m_indexC].c;let a=e.positions[this.m_indexC].a;const l=e.positions[this.m_indexD].c;let u=e.positions[this.m_indexD].a;const c=this.m_qA.SetAngle(n),h=this.m_qB.SetAngle(s),m=this.m_qC.SetAngle(a),_=this.m_qD.SetAngle(u);let f,d;const p=this.m_JvAC,y=this.m_JvBD;let v,g,b,x,S=0;if(this.m_typeA===t.b2JointType.e_revoluteJoint)p.SetZero(),v=1,b=1,S+=this.m_iA+this.m_iC,f=n-a-this.m_referenceAngleA;else{const t=W.MulRV(m,this.m_localAxisC,Ai.SolvePositionConstraints_s_u),e=W.MulRV(m,this.m_lalcC,Ai.SolvePositionConstraints_s_rC),n=W.MulRV(c,this.m_lalcA,Ai.SolvePositionConstraints_s_rA);p.Copy(t),b=N.CrossVV(e,t),v=N.CrossVV(n,t),S+=this.m_mC+this.m_mA+this.m_iC*b*b+this.m_iA*v*v;const r=this.m_lalcC,s=W.MulTRV(m,N.AddVV(n,N.SubVV(i,o,N.s_t0),N.s_t0),N.s_t0);f=N.DotVV(N.SubVV(s,r,N.s_t0),this.m_localAxisC)}if(this.m_typeB===t.b2JointType.e_revoluteJoint)y.SetZero(),g=this.m_ratio,x=this.m_ratio,S+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),d=s-u-this.m_referenceAngleB;else{const t=W.MulRV(_,this.m_localAxisD,Ai.SolvePositionConstraints_s_u),e=W.MulRV(_,this.m_lalcD,Ai.SolvePositionConstraints_s_rD),i=W.MulRV(h,this.m_lalcB,Ai.SolvePositionConstraints_s_rB);N.MulSV(this.m_ratio,t,y),x=this.m_ratio*N.CrossVV(e,t),g=this.m_ratio*N.CrossVV(i,t),S+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*x*x+this.m_iB*g*g;const n=this.m_lalcD,s=W.MulTRV(_,N.AddVV(i,N.SubVV(r,l,N.s_t0),N.s_t0),N.s_t0);d=N.DotVV(N.SubVV(s,n,N.s_t0),this.m_localAxisD)}const w=f+this.m_ratio*d-this.m_constant;let B=0;return S>0&&(B=-w/S),i.SelfMulAdd(this.m_mA*B,p),n+=this.m_iA*B*v,r.SelfMulAdd(this.m_mB*B,y),s+=this.m_iB*B*g,o.SelfMulSub(this.m_mC*B,p),a-=this.m_iC*B*b,l.SelfMulSub(this.m_mD*B,y),u-=this.m_iD*B*x,e.positions[this.m_indexA].a=n,e.positions[this.m_indexB].a=s,e.positions[this.m_indexC].a=a,e.positions[this.m_indexD].a=u,!0}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return N.MulSV(t*this.m_impulse,this.m_JvAC,e)}GetReactionTorque(t){return t*this.m_impulse*this.m_JwA}GetJoint1(){return this.m_joint1}GetJoint2(){return this.m_joint2}GetRatio(){return this.m_ratio}SetRatio(t){this.m_ratio=t}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex,n=this.m_joint1.m_index,r=this.m_joint2.m_index;t("  const jd: b2GearJointDef = new b2GearJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.joint1 = joints[%d];\n",n),t("  jd.joint2 = joints[%d];\n",r),t("  jd.ratio = %.15f;\n",this.m_ratio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}Ai.InitVelocityConstraints_s_u=new N,Ai.InitVelocityConstraints_s_rA=new N,Ai.InitVelocityConstraints_s_rB=new N,Ai.InitVelocityConstraints_s_rC=new N,Ai.InitVelocityConstraints_s_rD=new N,Ai.SolvePositionConstraints_s_u=new N,Ai.SolvePositionConstraints_s_rA=new N,Ai.SolvePositionConstraints_s_rB=new N,Ai.SolvePositionConstraints_s_rC=new N,Ai.SolvePositionConstraints_s_rD=new N;class Vi extends xi{constructor(t){super(t),this.m_linearOffset=new N,this.m_angularOffset=0,this.m_linearImpulse=new N,this.m_angularImpulse=0,this.m_maxForce=0,this.m_maxTorque=0,this.m_correctionFactor=.3,this.m_indexA=0,this.m_indexB=0,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_linearError=new N,this.m_angularError=0,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new U,this.m_angularMass=0,this.m_qA=new W,this.m_qB=new W,this.m_K=new U,this.m_linearOffset.Copy(e(t.linearOffset,N.ZERO)),this.m_linearImpulse.SetZero(),this.m_maxForce=e(t.maxForce,0),this.m_maxTorque=e(t.maxTorque,0),this.m_correctionFactor=e(t.correctionFactor,.3)}GetAnchorA(t){const e=this.m_bodyA.GetPosition();return t.x=e.x,t.y=e.y,t}GetAnchorB(t){const e=this.m_bodyB.GetPosition();return t.x=e.x,t.y=e.y,t}GetReactionForce(t,e){return N.MulSV(t,this.m_linearImpulse,e)}GetReactionTorque(t){return t*this.m_angularImpulse}SetLinearOffset(t){N.IsEqualToV(t,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(t))}GetLinearOffset(){return this.m_linearOffset}SetAngularOffset(t){t!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=t)}GetAngularOffset(){return this.m_angularOffset}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetMaxTorque(t){this.m_maxTorque=t}GetMaxTorque(){return this.m_maxTorque}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].c,i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v;let r=t.velocities[this.m_indexA].w;const s=t.positions[this.m_indexB].c,o=t.positions[this.m_indexB].a,a=t.velocities[this.m_indexB].v;let l=t.velocities[this.m_indexB].w;const u=this.m_qA.SetAngle(i),c=this.m_qB.SetAngle(o),h=W.MulRV(u,N.SubVV(this.m_linearOffset,this.m_localCenterA,N.s_t0),this.m_rA),m=W.MulRV(c,N.NegV(this.m_localCenterB,N.s_t0),this.m_rB),_=this.m_invMassA,f=this.m_invMassB,d=this.m_invIA,p=this.m_invIB,y=this.m_K;if(y.ex.x=_+f+d*h.y*h.y+p*m.y*m.y,y.ex.y=-d*h.x*h.y-p*m.x*m.y,y.ey.x=y.ex.y,y.ey.y=_+f+d*h.x*h.x+p*m.x*m.x,y.GetInverse(this.m_linearMass),this.m_angularMass=d+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),N.SubVV(N.AddVV(s,m,N.s_t0),N.AddVV(e,h,N.s_t1),this.m_linearError),this.m_angularError=o-i-this.m_angularOffset,t.step.warmStarting){this.m_linearImpulse.SelfMul(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio;const e=this.m_linearImpulse;n.SelfMulSub(_,e),r-=d*(N.CrossVV(h,e)+this.m_angularImpulse),a.SelfMulAdd(f,e),l+=p*(N.CrossVV(m,e)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;t.velocities[this.m_indexA].w=r,t.velocities[this.m_indexB].w=l}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=this.m_invMassA,o=this.m_invMassB,a=this.m_invIA,l=this.m_invIB,u=t.step.dt,c=t.step.inv_dt;{const t=r-i+c*this.m_correctionFactor*this.m_angularError;let e=-this.m_angularMass*t;const n=this.m_angularImpulse,s=u*this.m_maxTorque;this.m_angularImpulse=I(this.m_angularImpulse+e,-s,s),e=this.m_angularImpulse-n,i-=a*e,r+=l*e}{const t=this.m_rA,h=this.m_rB,m=N.AddVV(N.SubVV(N.AddVV(n,N.CrossSV(r,h,N.s_t0),N.s_t0),N.AddVV(e,N.CrossSV(i,t,N.s_t1),N.s_t1),N.s_t2),N.MulSV(c*this.m_correctionFactor,this.m_linearError,N.s_t3),Vi.SolveVelocityConstraints_s_Cdot_v2),_=U.MulMV(this.m_linearMass,m,Vi.SolveVelocityConstraints_s_impulse_v2).SelfNeg(),f=Vi.SolveVelocityConstraints_s_oldImpulse_v2.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(_);const d=u*this.m_maxForce;this.m_linearImpulse.LengthSquared()>d*d&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(d)),N.SubVV(this.m_linearImpulse,f,_),e.SelfMulSub(s,_),i-=a*N.CrossVV(t,_),n.SelfMulAdd(o,_),r+=l*N.CrossVV(h,_)}t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r}SolvePositionConstraints(t){return!0}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2MotorJointDef = new b2MotorJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.linearOffset.Set(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y),t("  jd.angularOffset = %.15f;\n",this.m_angularOffset),t("  jd.maxForce = %.15f;\n",this.m_maxForce),t("  jd.maxTorque = %.15f;\n",this.m_maxTorque),t("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}Vi.SolveVelocityConstraints_s_Cdot_v2=new N,Vi.SolveVelocityConstraints_s_impulse_v2=new N,Vi.SolveVelocityConstraints_s_oldImpulse_v2=new N;class Pi extends xi{constructor(t){super(t),this.m_localAnchorB=new N,this.m_targetA=new N,this.m_frequencyHz=0,this.m_dampingRatio=0,this.m_beta=0,this.m_impulse=new N,this.m_maxForce=0,this.m_gamma=0,this.m_indexA=0,this.m_indexB=0,this.m_rB=new N,this.m_localCenterB=new N,this.m_invMassB=0,this.m_invIB=0,this.m_mass=new U,this.m_C=new N,this.m_qB=new W,this.m_lalcB=new N,this.m_K=new U,this.m_targetA.Copy(e(t.target,N.ZERO)),X.MulTXV(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB),this.m_maxForce=e(t.maxForce,0),this.m_impulse.SetZero(),this.m_frequencyHz=e(t.frequencyHz,0),this.m_dampingRatio=e(t.dampingRatio,0),this.m_beta=0,this.m_gamma=0}SetTarget(t){this.m_bodyB.IsAwake()||this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(t)}GetTarget(){return this.m_targetA}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetFrequency(t){this.m_frequencyHz=t}GetFrequency(){return this.m_frequencyHz}SetDampingRatio(t){this.m_dampingRatio=t}GetDampingRatio(){return this.m_dampingRatio}InitVelocityConstraints(t){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexB].c,i=t.positions[this.m_indexB].a,n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const o=this.m_qB.SetAngle(i),a=this.m_bodyB.GetMass(),l=2*s*this.m_frequencyHz,u=2*a*this.m_dampingRatio*l,c=a*(l*l),h=t.step.dt;this.m_gamma=h*(u+h*c),0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=h*c*this.m_gamma,N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),W.MulRV(o,this.m_lalcB,this.m_rB);const m=this.m_K;m.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,m.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,m.ey.x=m.ex.y,m.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,m.GetInverse(this.m_mass),this.m_C.x=e.x+this.m_rB.x-this.m_targetA.x,this.m_C.y=e.y+this.m_rB.y-this.m_targetA.y,this.m_C.SelfMul(this.m_beta),r*=.98,t.step.warmStarting?(this.m_impulse.SelfMul(t.step.dtRatio),n.x+=this.m_invMassB*this.m_impulse.x,n.y+=this.m_invMassB*this.m_impulse.y,r+=this.m_invIB*N.CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),t.velocities[this.m_indexB].w=r}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexB].v;let i=t.velocities[this.m_indexB].w;const n=N.AddVCrossSV(e,i,this.m_rB,Pi.SolveVelocityConstraints_s_Cdot),r=U.MulMV(this.m_mass,N.AddVV(n,N.AddVV(this.m_C,N.MulSV(this.m_gamma,this.m_impulse,N.s_t0),N.s_t0),N.s_t0).SelfNeg(),Pi.SolveVelocityConstraints_s_impulse),s=Pi.SolveVelocityConstraints_s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(r);const o=t.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>o*o&&this.m_impulse.SelfMul(o/this.m_impulse.Length()),N.SubVV(this.m_impulse,s,r),e.SelfMulAdd(this.m_invMassB,r),i+=this.m_invIB*N.CrossVV(this.m_rB,r),t.velocities[this.m_indexB].w=i}SolvePositionConstraints(t){return!0}GetAnchorA(t){return t.x=this.m_targetA.x,t.y=this.m_targetA.y,t}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return N.MulSV(t,this.m_impulse,e)}GetReactionTorque(t){return 0}Dump(t){t("Mouse joint dumping is not supported.\n")}ShiftOrigin(t){this.m_targetA.SelfSub(t)}}Pi.SolveVelocityConstraints_s_Cdot=new N,Pi.SolveVelocityConstraints_s_impulse=new N,Pi.SolveVelocityConstraints_s_oldImpulse=new N;class Mi extends xi{constructor(i){super(i),this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_localXAxisA=new N,this.m_localYAxisA=new N,this.m_referenceAngle=0,this.m_impulse=new q(0,0,0),this.m_motorImpulse=0,this.m_lowerTranslation=0,this.m_upperTranslation=0,this.m_maxMotorForce=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_enableMotor=!1,this.m_limitState=t.b2LimitState.e_inactiveLimit,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_axis=new N(0,0),this.m_perp=new N(0,0),this.m_s1=0,this.m_s2=0,this.m_a1=0,this.m_a2=0,this.m_K=new J,this.m_K3=new J,this.m_K2=new U,this.m_motorMass=0,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_rA=new N,this.m_rB=new N,this.m_localAnchorA.Copy(e(i.localAnchorA,N.ZERO)),this.m_localAnchorB.Copy(e(i.localAnchorB,N.ZERO)),this.m_localXAxisA.Copy(e(i.localAxisA,new N(1,0))).SelfNormalize(),N.CrossOneV(this.m_localXAxisA,this.m_localYAxisA),this.m_referenceAngle=e(i.referenceAngle,0),this.m_lowerTranslation=e(i.lowerTranslation,0),this.m_upperTranslation=e(i.upperTranslation,0),this.m_maxMotorForce=e(i.maxMotorForce,0),this.m_motorSpeed=e(i.motorSpeed,0),this.m_enableLimit=e(i.enableLimit,!1),this.m_enableMotor=e(i.enableMotor,!1)}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=e.positions[this.m_indexA].c,n=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v;let s=e.velocities[this.m_indexA].w;const o=e.positions[this.m_indexB].c,l=e.positions[this.m_indexB].a,u=e.velocities[this.m_indexB].v;let c=e.velocities[this.m_indexB].w;const h=this.m_qA.SetAngle(n),m=this.m_qB.SetAngle(l);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const _=W.MulRV(h,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const f=W.MulRV(m,this.m_lalcB,this.m_rB),d=N.AddVV(N.SubVV(o,i,N.s_t0),N.SubVV(f,_,N.s_t1),Mi.InitVelocityConstraints_s_d),p=this.m_invMassA,y=this.m_invMassB,v=this.m_invIA,g=this.m_invIB;if(W.MulRV(h,this.m_localXAxisA,this.m_axis),this.m_a1=N.CrossVV(N.AddVV(d,_,N.s_t0),this.m_axis),this.m_a2=N.CrossVV(f,this.m_axis),this.m_motorMass=p+y+v*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),W.MulRV(h,this.m_localYAxisA,this.m_perp),this.m_s1=N.CrossVV(N.AddVV(d,_,N.s_t0),this.m_perp),this.m_s2=N.CrossVV(f,this.m_perp),this.m_K.ex.x=p+y+v*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,this.m_K.ex.y=v*this.m_s1+g*this.m_s2,this.m_K.ex.z=v*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.ey.x=this.m_K.ex.y,this.m_K.ey.y=v+g,0===this.m_K.ey.y&&(this.m_K.ey.y=1),this.m_K.ey.z=v*this.m_a1+g*this.m_a2,this.m_K.ez.x=this.m_K.ex.z,this.m_K.ez.y=this.m_K.ey.z,this.m_K.ez.z=p+y+v*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_enableLimit){const e=N.DotVV(this.m_axis,d);V(this.m_upperTranslation-this.m_lowerTranslation)<2*a?this.m_limitState=t.b2LimitState.e_equalLimits:e<=this.m_lowerTranslation?this.m_limitState!==t.b2LimitState.e_atLowerLimit&&(this.m_limitState=t.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):e>=this.m_upperTranslation?this.m_limitState!==t.b2LimitState.e_atUpperLimit&&(this.m_limitState=t.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=t.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=t.b2LimitState.e_inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor||(this.m_motorImpulse=0),e.step.warmStarting){this.m_impulse.SelfMul(e.step.dtRatio),this.m_motorImpulse*=e.step.dtRatio;const t=N.AddVV(N.MulSV(this.m_impulse.x,this.m_perp,N.s_t0),N.MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,N.s_t1),Mi.InitVelocityConstraints_s_P),i=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,n=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;r.SelfMulSub(p,t),s-=v*i,u.SelfMulAdd(y,t),c+=g*n}else this.m_impulse.SetZero(),this.m_motorImpulse=0;e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=c}SolveVelocityConstraints(e){const i=e.velocities[this.m_indexA].v;let n=e.velocities[this.m_indexA].w;const r=e.velocities[this.m_indexB].v;let s=e.velocities[this.m_indexB].w;const o=this.m_invMassA,a=this.m_invMassB,l=this.m_invIA,u=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==t.b2LimitState.e_equalLimits){const t=N.DotVV(this.m_axis,N.SubVV(r,i,N.s_t0))+this.m_a2*s-this.m_a1*n;let c=this.m_motorMass*(this.m_motorSpeed-t);const h=this.m_motorImpulse,m=e.step.dt*this.m_maxMotorForce;this.m_motorImpulse=I(this.m_motorImpulse+c,-m,m),c=this.m_motorImpulse-h;const _=N.MulSV(c,this.m_axis,Mi.SolveVelocityConstraints_s_P),f=c*this.m_a1,d=c*this.m_a2;i.SelfMulSub(o,_),n-=l*f,r.SelfMulAdd(a,_),s+=u*d}const c=N.DotVV(this.m_perp,N.SubVV(r,i,N.s_t0))+this.m_s2*s-this.m_s1*n,h=s-n;if(this.m_enableLimit&&this.m_limitState!==t.b2LimitState.e_inactiveLimit){const e=N.DotVV(this.m_axis,N.SubVV(r,i,N.s_t0))+this.m_a2*s-this.m_a1*n,m=Mi.SolveVelocityConstraints_s_f1.Copy(this.m_impulse),_=this.m_K.Solve33(-c,-h,-e,Mi.SolveVelocityConstraints_s_df3);this.m_impulse.SelfAdd(_),this.m_limitState===t.b2LimitState.e_atLowerLimit?this.m_impulse.z=M(this.m_impulse.z,0):this.m_limitState===t.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=P(this.m_impulse.z,0));const f=-c-(this.m_impulse.z-m.z)*this.m_K.ez.x,d=-h-(this.m_impulse.z-m.z)*this.m_K.ez.y,p=this.m_K.Solve22(f,d,Mi.SolveVelocityConstraints_s_f2r);p.x+=m.x,p.y+=m.y,this.m_impulse.x=p.x,this.m_impulse.y=p.y,_.x=this.m_impulse.x-m.x,_.y=this.m_impulse.y-m.y,_.z=this.m_impulse.z-m.z;const y=N.AddVV(N.MulSV(_.x,this.m_perp,N.s_t0),N.MulSV(_.z,this.m_axis,N.s_t1),Mi.SolveVelocityConstraints_s_P),v=_.x*this.m_s1+_.y+_.z*this.m_a1,g=_.x*this.m_s2+_.y+_.z*this.m_a2;i.SelfMulSub(o,y),n-=l*v,r.SelfMulAdd(a,y),s+=u*g}else{const t=this.m_K.Solve22(-c,-h,Mi.SolveVelocityConstraints_s_df2);this.m_impulse.x+=t.x,this.m_impulse.y+=t.y;const e=N.MulSV(t.x,this.m_perp,Mi.SolveVelocityConstraints_s_P),m=t.x*this.m_s1+t.y,_=t.x*this.m_s2+t.y;i.SelfMulSub(o,e),n-=l*m,r.SelfMulAdd(a,e),s+=u*_}e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=s}SolvePositionConstraints(t){const e=t.positions[this.m_indexA].c;let i=t.positions[this.m_indexA].a;const n=t.positions[this.m_indexB].c;let r=t.positions[this.m_indexB].a;const s=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(r),u=this.m_invMassA,h=this.m_invMassB,m=this.m_invIA,_=this.m_invIB,f=W.MulRV(s,this.m_lalcA,this.m_rA),d=W.MulRV(o,this.m_lalcB,this.m_rB),p=N.SubVV(N.AddVV(n,d,N.s_t0),N.AddVV(e,f,N.s_t1),Mi.SolvePositionConstraints_s_d),y=W.MulRV(s,this.m_localXAxisA,this.m_axis),v=N.CrossVV(N.AddVV(p,f,N.s_t0),y),g=N.CrossVV(d,y),b=W.MulRV(s,this.m_localYAxisA,this.m_perp),x=N.CrossVV(N.AddVV(p,f,N.s_t0),b),S=N.CrossVV(d,b);let w=Mi.SolvePositionConstraints_s_impulse;const B=N.DotVV(b,p),C=r-i-this.m_referenceAngle;let A=V(B);const P=V(C);let k=!1,D=0;if(this.m_enableLimit){const t=N.DotVV(y,p);V(this.m_upperTranslation-this.m_lowerTranslation)<2*a?(D=I(t,-c,c),A=M(A,V(t)),k=!0):t<=this.m_lowerTranslation?(D=I(t-this.m_lowerTranslation+a,-c,0),A=M(A,this.m_lowerTranslation-t),k=!0):t>=this.m_upperTranslation&&(D=I(t-this.m_upperTranslation-a,0,c),A=M(A,t-this.m_upperTranslation),k=!0)}if(k){const t=u+h+m*x*x+_*S*S,e=m*x+_*S,i=m*x*v+_*S*g;let n=m+_;0===n&&(n=1);const r=m*v+_*g,s=u+h+m*v*v+_*g*g,o=this.m_K3;o.ex.SetXYZ(t,e,i),o.ey.SetXYZ(e,n,r),o.ez.SetXYZ(i,r,s),w=o.Solve33(-B,-C,-D,w)}else{const t=u+h+m*x*x+_*S*S,e=m*x+_*S;let i=m+_;0===i&&(i=1);const n=this.m_K2;n.ex.Set(t,e),n.ey.Set(e,i);const r=n.Solve(-B,-C,Mi.SolvePositionConstraints_s_impulse1);w.x=r.x,w.y=r.y,w.z=0}const G=N.AddVV(N.MulSV(w.x,b,N.s_t0),N.MulSV(w.z,y,N.s_t1),Mi.SolvePositionConstraints_s_P),T=w.x*x+w.y+w.z*v,F=w.x*S+w.y+w.z*g;return e.SelfMulSub(u,G),i-=m*T,n.SelfMulAdd(h,G),r+=_*F,t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].a=r,A<=a&&P<=l}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),e.y=t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y),e}GetReactionTorque(t){return t*this.m_impulse.y}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetLocalAxisA(){return this.m_localXAxisA}GetReferenceAngle(){return this.m_referenceAngle}GetJointTranslation(){const t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,Mi.GetJointTranslation_s_pA),e=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,Mi.GetJointTranslation_s_pB),i=N.SubVV(e,t,Mi.GetJointTranslation_s_d),n=this.m_bodyA.GetWorldVector(this.m_localXAxisA,Mi.GetJointTranslation_s_axis);return N.DotVV(i,n)}GetJointSpeed(){const t=this.m_bodyA,e=this.m_bodyB;N.SubVV(this.m_localAnchorA,t.m_sweep.localCenter,this.m_lalcA);const i=W.MulRV(t.m_xf.q,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,e.m_sweep.localCenter,this.m_lalcB);const n=W.MulRV(e.m_xf.q,this.m_lalcB,this.m_rB),r=N.AddVV(t.m_sweep.c,i,N.s_t0),s=N.AddVV(e.m_sweep.c,n,N.s_t1),o=N.SubVV(s,r,N.s_t2),a=t.GetWorldVector(this.m_localXAxisA,this.m_axis),l=t.m_linearVelocity,u=e.m_linearVelocity,c=t.m_angularVelocity,h=e.m_angularVelocity;return N.DotVV(o,N.CrossSV(c,a,N.s_t0))+N.DotVV(a,N.SubVV(N.AddVCrossSV(u,h,n,N.s_t0),N.AddVCrossSV(l,c,i,N.s_t1),N.s_t0))}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(t){t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)}GetLowerLimit(){return this.m_lowerTranslation}GetUpperLimit(){return this.m_upperTranslation}SetLimits(t,e){t===this.m_lowerTranslation&&e===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)}SetMotorSpeed(t){t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)}GetMotorSpeed(){return this.m_motorSpeed}SetMaxMotorForce(t){t!==this.m_maxMotorForce&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t)}GetMaxMotorForce(){return this.m_maxMotorForce}GetMotorForce(t){return t*this.m_motorImpulse}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2PrismaticJointDef = new b2PrismaticJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),t("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),t("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),t("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation),t("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation),t("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),t("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),t("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}Mi.InitVelocityConstraints_s_d=new N,Mi.InitVelocityConstraints_s_P=new N,Mi.SolveVelocityConstraints_s_P=new N,Mi.SolveVelocityConstraints_s_f2r=new N,Mi.SolveVelocityConstraints_s_f1=new q,Mi.SolveVelocityConstraints_s_df3=new q,Mi.SolveVelocityConstraints_s_df2=new N,Mi.SolvePositionConstraints_s_d=new N,Mi.SolvePositionConstraints_s_impulse=new q,Mi.SolvePositionConstraints_s_impulse1=new N,Mi.SolvePositionConstraints_s_P=new N,Mi.GetJointTranslation_s_pA=new N,Mi.GetJointTranslation_s_pB=new N,Mi.GetJointTranslation_s_d=new N,Mi.GetJointTranslation_s_axis=new N;class Ii extends xi{constructor(t){super(t),this.m_groundAnchorA=new N,this.m_groundAnchorB=new N,this.m_lengthA=0,this.m_lengthB=0,this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_constant=0,this.m_ratio=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_uA=new N,this.m_uB=new N,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_groundAnchorA.Copy(e(t.groundAnchorA,new N(-1,1))),this.m_groundAnchorB.Copy(e(t.groundAnchorB,new N(1,0))),this.m_localAnchorA.Copy(e(t.localAnchorA,new N(-1,0))),this.m_localAnchorB.Copy(e(t.localAnchorB,new N(1,0))),this.m_lengthA=e(t.lengthA,0),this.m_lengthB=e(t.lengthB,0),this.m_ratio=e(t.ratio,1),this.m_constant=e(t.lengthA,0)+this.m_ratio*e(t.lengthB,0),this.m_impulse=0}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].c,i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v;let r=t.velocities[this.m_indexA].w;const s=t.positions[this.m_indexB].c,o=t.positions[this.m_indexB].a,a=t.velocities[this.m_indexB].v;let l=t.velocities[this.m_indexB].w;const u=this.m_qA.SetAngle(i),c=this.m_qB.SetAngle(o);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),W.MulRV(u,this.m_lalcA,this.m_rA),N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),W.MulRV(c,this.m_lalcB,this.m_rB),this.m_uA.Copy(e).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA),this.m_uB.Copy(s).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);const h=this.m_uA.Length(),m=this.m_uB.Length();h>.08?this.m_uA.SelfMul(1/h):this.m_uA.SetZero(),m>.08?this.m_uB.SelfMul(1/m):this.m_uB.SetZero();const _=N.CrossVV(this.m_rA,this.m_uA),f=N.CrossVV(this.m_rB,this.m_uB),d=this.m_invMassA+this.m_invIA*_*_,p=this.m_invMassB+this.m_invIB*f*f;if(this.m_mass=d+this.m_ratio*this.m_ratio*p,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.step.warmStarting){this.m_impulse*=t.step.dtRatio;const e=N.MulSV(-this.m_impulse,this.m_uA,Ii.InitVelocityConstraints_s_PA),i=N.MulSV(-this.m_ratio*this.m_impulse,this.m_uB,Ii.InitVelocityConstraints_s_PB);n.SelfMulAdd(this.m_invMassA,e),r+=this.m_invIA*N.CrossVV(this.m_rA,e),a.SelfMulAdd(this.m_invMassB,i),l+=this.m_invIB*N.CrossVV(this.m_rB,i)}else this.m_impulse=0;t.velocities[this.m_indexA].w=r,t.velocities[this.m_indexB].w=l}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=N.AddVCrossSV(e,i,this.m_rA,Ii.SolveVelocityConstraints_s_vpA),o=N.AddVCrossSV(n,r,this.m_rB,Ii.SolveVelocityConstraints_s_vpB),a=-N.DotVV(this.m_uA,s)-this.m_ratio*N.DotVV(this.m_uB,o),l=-this.m_mass*a;this.m_impulse+=l;const u=N.MulSV(-l,this.m_uA,Ii.SolveVelocityConstraints_s_PA),c=N.MulSV(-this.m_ratio*l,this.m_uB,Ii.SolveVelocityConstraints_s_PB);e.SelfMulAdd(this.m_invMassA,u),i+=this.m_invIA*N.CrossVV(this.m_rA,u),n.SelfMulAdd(this.m_invMassB,c),r+=this.m_invIB*N.CrossVV(this.m_rB,c),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r}SolvePositionConstraints(t){const e=t.positions[this.m_indexA].c;let i=t.positions[this.m_indexA].a;const n=t.positions[this.m_indexB].c;let r=t.positions[this.m_indexB].a;const s=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(r);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const l=W.MulRV(s,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const u=W.MulRV(o,this.m_lalcB,this.m_rB),c=this.m_uA.Copy(e).SelfAdd(l).SelfSub(this.m_groundAnchorA),h=this.m_uB.Copy(n).SelfAdd(u).SelfSub(this.m_groundAnchorB),m=c.Length(),_=h.Length();m>.08?c.SelfMul(1/m):c.SetZero(),_>.08?h.SelfMul(1/_):h.SetZero();const f=N.CrossVV(l,c),d=N.CrossVV(u,h),p=this.m_invMassA+this.m_invIA*f*f,y=this.m_invMassB+this.m_invIB*d*d;let v=p+this.m_ratio*this.m_ratio*y;v>0&&(v=1/v);const g=this.m_constant-m-this.m_ratio*_,b=V(g),x=-v*g,S=N.MulSV(-x,c,Ii.SolvePositionConstraints_s_PA),w=N.MulSV(-this.m_ratio*x,h,Ii.SolvePositionConstraints_s_PB);return e.SelfMulAdd(this.m_invMassA,S),i+=this.m_invIA*N.CrossVV(l,S),n.SelfMulAdd(this.m_invMassB,w),r+=this.m_invIB*N.CrossVV(u,w),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].a=r,b<a}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*this.m_impulse*this.m_uB.x,e.y=t*this.m_impulse*this.m_uB.y,e}GetReactionTorque(t){return 0}GetGroundAnchorA(){return this.m_groundAnchorA}GetGroundAnchorB(){return this.m_groundAnchorB}GetLengthA(){return this.m_lengthA}GetLengthB(){return this.m_lengthB}GetRatio(){return this.m_ratio}GetCurrentLengthA(){const t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,Ii.GetCurrentLengthA_s_p),e=this.m_groundAnchorA;return N.DistanceVV(t,e)}GetCurrentLengthB(){const t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,Ii.GetCurrentLengthB_s_p),e=this.m_groundAnchorB;return N.DistanceVV(t,e)}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2PulleyJointDef = new b2PulleyJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.groundAnchorA.Set(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y),t("  jd.groundAnchorB.Set(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.lengthA = %.15f;\n",this.m_lengthA),t("  jd.lengthB = %.15f;\n",this.m_lengthB),t("  jd.ratio = %.15f;\n",this.m_ratio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}ShiftOrigin(t){this.m_groundAnchorA.SelfSub(t),this.m_groundAnchorB.SelfSub(t)}}Ii.InitVelocityConstraints_s_PA=new N,Ii.InitVelocityConstraints_s_PB=new N,Ii.SolveVelocityConstraints_s_vpA=new N,Ii.SolveVelocityConstraints_s_vpB=new N,Ii.SolveVelocityConstraints_s_PA=new N,Ii.SolveVelocityConstraints_s_PB=new N,Ii.SolvePositionConstraints_s_PA=new N,Ii.SolvePositionConstraints_s_PB=new N,Ii.GetCurrentLengthA_s_p=new N,Ii.GetCurrentLengthB_s_p=new N;class ki extends xi{constructor(i){super(i),this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_impulse=new q,this.m_motorImpulse=0,this.m_enableMotor=!1,this.m_maxMotorTorque=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_referenceAngle=0,this.m_lowerAngle=0,this.m_upperAngle=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new J,this.m_motorMass=0,this.m_limitState=t.b2LimitState.e_inactiveLimit,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_K=new U,this.m_localAnchorA.Copy(e(i.localAnchorA,N.ZERO)),this.m_localAnchorB.Copy(e(i.localAnchorB,N.ZERO)),this.m_referenceAngle=e(i.referenceAngle,0),this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=e(i.lowerAngle,0),this.m_upperAngle=e(i.upperAngle,0),this.m_maxMotorTorque=e(i.maxMotorTorque,0),this.m_motorSpeed=e(i.motorSpeed,0),this.m_enableLimit=e(i.enableLimit,!1),this.m_enableMotor=e(i.enableMotor,!1),this.m_limitState=t.b2LimitState.e_inactiveLimit}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=e.positions[this.m_indexA].a,n=e.velocities[this.m_indexA].v;let r=e.velocities[this.m_indexA].w;const s=e.positions[this.m_indexB].a,o=e.velocities[this.m_indexB].v;let a=e.velocities[this.m_indexB].w;const u=this.m_qA.SetAngle(i),c=this.m_qB.SetAngle(s);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),W.MulRV(u,this.m_lalcA,this.m_rA),N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),W.MulRV(c,this.m_lalcB,this.m_rB);const h=this.m_invMassA,m=this.m_invMassB,_=this.m_invIA,f=this.m_invIB,d=_+f===0;if(this.m_mass.ex.x=h+m+this.m_rA.y*this.m_rA.y*_+this.m_rB.y*this.m_rB.y*f,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*_-this.m_rB.y*this.m_rB.x*f,this.m_mass.ez.x=-this.m_rA.y*_-this.m_rB.y*f,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=h+m+this.m_rA.x*this.m_rA.x*_+this.m_rB.x*this.m_rB.x*f,this.m_mass.ez.y=this.m_rA.x*_+this.m_rB.x*f,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=_+f,this.m_motorMass=_+f,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_enableMotor&&!d||(this.m_motorImpulse=0),this.m_enableLimit&&!d){const e=s-i-this.m_referenceAngle;V(this.m_upperAngle-this.m_lowerAngle)<2*l?this.m_limitState=t.b2LimitState.e_equalLimits:e<=this.m_lowerAngle?(this.m_limitState!==t.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=t.b2LimitState.e_atLowerLimit):e>=this.m_upperAngle?(this.m_limitState!==t.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=t.b2LimitState.e_atUpperLimit):(this.m_limitState=t.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=t.b2LimitState.e_inactiveLimit;if(e.step.warmStarting){this.m_impulse.SelfMul(e.step.dtRatio),this.m_motorImpulse*=e.step.dtRatio;const t=ki.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);n.SelfMulSub(h,t),r-=_*(N.CrossVV(this.m_rA,t)+this.m_motorImpulse+this.m_impulse.z),o.SelfMulAdd(m,t),a+=f*(N.CrossVV(this.m_rB,t)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0;e.velocities[this.m_indexA].w=r,e.velocities[this.m_indexB].w=a}SolveVelocityConstraints(e){const i=e.velocities[this.m_indexA].v;let n=e.velocities[this.m_indexA].w;const r=e.velocities[this.m_indexB].v;let s=e.velocities[this.m_indexB].w;const o=this.m_invMassA,a=this.m_invMassB,l=this.m_invIA,u=this.m_invIB,c=l+u===0;if(this.m_enableMotor&&this.m_limitState!==t.b2LimitState.e_equalLimits&&!c){const t=s-n-this.m_motorSpeed;let i=-this.m_motorMass*t;const r=this.m_motorImpulse,o=e.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=I(this.m_motorImpulse+i,-o,o),i=this.m_motorImpulse-r,n-=l*i,s+=u*i}if(this.m_enableLimit&&this.m_limitState!==t.b2LimitState.e_inactiveLimit&&!c){const e=N.SubVV(N.AddVCrossSV(r,s,this.m_rB,N.s_t0),N.AddVCrossSV(i,n,this.m_rA,N.s_t1),ki.SolveVelocityConstraints_s_Cdot1),c=s-n,h=this.m_mass.Solve33(e.x,e.y,c,ki.SolveVelocityConstraints_s_impulse_v3).SelfNeg();if(this.m_limitState===t.b2LimitState.e_equalLimits)this.m_impulse.SelfAdd(h);else if(this.m_limitState===t.b2LimitState.e_atLowerLimit){if(this.m_impulse.z+h.z<0){const t=-e.x+this.m_impulse.z*this.m_mass.ez.x,i=-e.y+this.m_impulse.z*this.m_mass.ez.y,n=this.m_mass.Solve22(t,i,ki.SolveVelocityConstraints_s_reduced_v2);h.x=n.x,h.y=n.y,h.z=-this.m_impulse.z,this.m_impulse.x+=n.x,this.m_impulse.y+=n.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(h)}else if(this.m_limitState===t.b2LimitState.e_atUpperLimit){if(this.m_impulse.z+h.z>0){const t=-e.x+this.m_impulse.z*this.m_mass.ez.x,i=-e.y+this.m_impulse.z*this.m_mass.ez.y,n=this.m_mass.Solve22(t,i,ki.SolveVelocityConstraints_s_reduced_v2);h.x=n.x,h.y=n.y,h.z=-this.m_impulse.z,this.m_impulse.x+=n.x,this.m_impulse.y+=n.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(h)}const m=ki.SolveVelocityConstraints_s_P.Set(h.x,h.y);i.SelfMulSub(o,m),n-=l*(N.CrossVV(this.m_rA,m)+h.z),r.SelfMulAdd(a,m),s+=u*(N.CrossVV(this.m_rB,m)+h.z)}else{const t=N.SubVV(N.AddVCrossSV(r,s,this.m_rB,N.s_t0),N.AddVCrossSV(i,n,this.m_rA,N.s_t1),ki.SolveVelocityConstraints_s_Cdot_v2),e=this.m_mass.Solve22(-t.x,-t.y,ki.SolveVelocityConstraints_s_impulse_v2);this.m_impulse.x+=e.x,this.m_impulse.y+=e.y,i.SelfMulSub(o,e),n-=l*N.CrossVV(this.m_rA,e),r.SelfMulAdd(a,e),s+=u*N.CrossVV(this.m_rB,e)}e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=s}SolvePositionConstraints(e){const i=e.positions[this.m_indexA].c;let n=e.positions[this.m_indexA].a;const r=e.positions[this.m_indexB].c;let s=e.positions[this.m_indexB].a;const o=this.m_qA.SetAngle(n),u=this.m_qB.SetAngle(s);let c=0,m=0;const _=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&this.m_limitState!==t.b2LimitState.e_inactiveLimit&&!_){const e=s-n-this.m_referenceAngle;let i=0;if(this.m_limitState===t.b2LimitState.e_equalLimits){const t=I(e-this.m_lowerAngle,-h,h);i=-this.m_motorMass*t,c=V(t)}else if(this.m_limitState===t.b2LimitState.e_atLowerLimit){let t=e-this.m_lowerAngle;c=-t,t=I(t+l,-h,0),i=-this.m_motorMass*t}else if(this.m_limitState===t.b2LimitState.e_atUpperLimit){let t=e-this.m_upperAngle;c=t,t=I(t-l,0,h),i=-this.m_motorMass*t}n-=this.m_invIA*i,s+=this.m_invIB*i}{o.SetAngle(n),u.SetAngle(s),N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const t=W.MulRV(o,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const e=W.MulRV(u,this.m_lalcB,this.m_rB),a=N.SubVV(N.AddVV(r,e,N.s_t0),N.AddVV(i,t,N.s_t1),ki.SolvePositionConstraints_s_C_v2);m=a.Length();const l=this.m_invMassA,c=this.m_invMassB,h=this.m_invIA,_=this.m_invIB,f=this.m_K;f.ex.x=l+c+h*t.y*t.y+_*e.y*e.y,f.ex.y=-h*t.x*t.y-_*e.x*e.y,f.ey.x=f.ex.y,f.ey.y=l+c+h*t.x*t.x+_*e.x*e.x;const d=f.Solve(a.x,a.y,ki.SolvePositionConstraints_s_impulse).SelfNeg();i.SelfMulSub(l,d),n-=h*N.CrossVV(t,d),r.SelfMulAdd(c,d),s+=_*N.CrossVV(e,d)}return e.positions[this.m_indexA].a=n,e.positions[this.m_indexB].a=s,m<=a&&c<=l}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*this.m_impulse.x,e.y=t*this.m_impulse.y,e}GetReactionTorque(t){return t*this.m_impulse.z}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetReferenceAngle(){return this.m_referenceAngle}GetJointAngle(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle}GetJointSpeed(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)}GetMotorTorque(t){return t*this.m_motorImpulse}GetMotorSpeed(){return this.m_motorSpeed}SetMaxMotorTorque(t){t!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=t)}GetMaxMotorTorque(){return this.m_maxMotorTorque}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(t){t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)}GetLowerLimit(){return this.m_lowerAngle}GetUpperLimit(){return this.m_upperAngle}SetLimits(t,e){t===this.m_lowerAngle&&e===this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)}SetMotorSpeed(t){t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2RevoluteJointDef = new b2RevoluteJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),t("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),t("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle),t("  jd.upperAngle = %.15f;\n",this.m_upperAngle),t("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),t("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),t("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}ki.InitVelocityConstraints_s_P=new N,ki.SolveVelocityConstraints_s_P=new N,ki.SolveVelocityConstraints_s_Cdot_v2=new N,ki.SolveVelocityConstraints_s_Cdot1=new N,ki.SolveVelocityConstraints_s_impulse_v3=new q,ki.SolveVelocityConstraints_s_reduced_v2=new N,ki.SolveVelocityConstraints_s_impulse_v2=new N,ki.SolvePositionConstraints_s_C_v2=new N,ki.SolvePositionConstraints_s_impulse=new N;class Di extends xi{constructor(i){super(i),this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_maxLength=0,this.m_length=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_u=new N,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0,this.m_state=t.b2LimitState.e_inactiveLimit,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_localAnchorA.Copy(e(i.localAnchorA,new N(-1,0))),this.m_localAnchorB.Copy(e(i.localAnchorB,new N(1,0))),this.m_maxLength=e(i.maxLength,0)}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=e.positions[this.m_indexA].c,n=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v;let s=e.velocities[this.m_indexA].w;const o=e.positions[this.m_indexB].c,l=e.positions[this.m_indexB].a,u=e.velocities[this.m_indexB].v;let c=e.velocities[this.m_indexB].w;const h=this.m_qA.SetAngle(n),m=this.m_qB.SetAngle(l);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),W.MulRV(h,this.m_lalcA,this.m_rA),N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),W.MulRV(m,this.m_lalcB,this.m_rB),this.m_u.Copy(o).SelfAdd(this.m_rB).SelfSub(i).SelfSub(this.m_rA),this.m_length=this.m_u.Length();const _=this.m_length-this.m_maxLength;if(this.m_state=_>0?t.b2LimitState.e_atUpperLimit:t.b2LimitState.e_inactiveLimit,!(this.m_length>a))return this.m_u.SetZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.SelfMul(1/this.m_length);const f=N.CrossVV(this.m_rA,this.m_u),d=N.CrossVV(this.m_rB,this.m_u),p=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*d*d;if(this.m_mass=0!==p?1/p:0,e.step.warmStarting){this.m_impulse*=e.step.dtRatio;const t=N.MulSV(this.m_impulse,this.m_u,Di.InitVelocityConstraints_s_P);r.SelfMulSub(this.m_invMassA,t),s-=this.m_invIA*N.CrossVV(this.m_rA,t),u.SelfMulAdd(this.m_invMassB,t),c+=this.m_invIB*N.CrossVV(this.m_rB,t)}else this.m_impulse=0;e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=c}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=N.AddVCrossSV(e,i,this.m_rA,Di.SolveVelocityConstraints_s_vpA),o=N.AddVCrossSV(n,r,this.m_rB,Di.SolveVelocityConstraints_s_vpB),a=this.m_length-this.m_maxLength;let l=N.DotVV(this.m_u,N.SubVV(o,s,N.s_t0));a<0&&(l+=t.step.inv_dt*a);let u=-this.m_mass*l;const c=this.m_impulse;this.m_impulse=P(0,this.m_impulse+u),u=this.m_impulse-c;const h=N.MulSV(u,this.m_u,Di.SolveVelocityConstraints_s_P);e.SelfMulSub(this.m_invMassA,h),i-=this.m_invIA*N.CrossVV(this.m_rA,h),n.SelfMulAdd(this.m_invMassB,h),r+=this.m_invIB*N.CrossVV(this.m_rB,h),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r}SolvePositionConstraints(t){const e=t.positions[this.m_indexA].c;let i=t.positions[this.m_indexA].a;const n=t.positions[this.m_indexB].c;let r=t.positions[this.m_indexB].a;const s=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(r);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const l=W.MulRV(s,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const u=W.MulRV(o,this.m_lalcB,this.m_rB),h=this.m_u.Copy(n).SelfAdd(u).SelfSub(e).SelfSub(l),m=h.Normalize();let _=m-this.m_maxLength;_=I(_,0,c);const f=-this.m_mass*_,d=N.MulSV(f,h,Di.SolvePositionConstraints_s_P);return e.SelfMulSub(this.m_invMassA,d),i-=this.m_invIA*N.CrossVV(l,d),n.SelfMulAdd(this.m_invMassB,d),r+=this.m_invIB*N.CrossVV(u,d),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].a=r,m-this.m_maxLength<a}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return N.MulSV(t*this.m_impulse,this.m_u,e)}GetReactionTorque(t){return 0}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetMaxLength(t){this.m_maxLength=t}GetMaxLength(){return this.m_maxLength}GetLimitState(){return this.m_state}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2RopeJointDef = new b2RopeJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.maxLength = %.15f;\n",this.m_maxLength),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}Di.InitVelocityConstraints_s_P=new N,Di.SolveVelocityConstraints_s_vpA=new N,Di.SolveVelocityConstraints_s_vpB=new N,Di.SolveVelocityConstraints_s_P=new N,Di.SolvePositionConstraints_s_P=new N;class Gi extends xi{constructor(t){super(t),this.m_frequencyHz=0,this.m_dampingRatio=0,this.m_bias=0,this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_referenceAngle=0,this.m_gamma=0,this.m_impulse=new q(0,0,0),this.m_indexA=0,this.m_indexB=0,this.m_rA=new N,this.m_rB=new N,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new J,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_K=new J,this.m_frequencyHz=e(t.frequencyHz,0),this.m_dampingRatio=e(t.dampingRatio,0),this.m_localAnchorA.Copy(e(t.localAnchorA,N.ZERO)),this.m_localAnchorB.Copy(e(t.localAnchorB,N.ZERO)),this.m_referenceAngle=e(t.referenceAngle,0),this.m_impulse.SetZero()}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].a,i=t.velocities[this.m_indexA].v;let n=t.velocities[this.m_indexA].w;const r=t.positions[this.m_indexB].a,o=t.velocities[this.m_indexB].v;let a=t.velocities[this.m_indexB].w;const l=this.m_qA.SetAngle(e),u=this.m_qB.SetAngle(r);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),W.MulRV(l,this.m_lalcA,this.m_rA),N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),W.MulRV(u,this.m_lalcB,this.m_rB);const c=this.m_invMassA,h=this.m_invMassB,m=this.m_invIA,_=this.m_invIB,f=this.m_K;if(f.ex.x=c+h+this.m_rA.y*this.m_rA.y*m+this.m_rB.y*this.m_rB.y*_,f.ey.x=-this.m_rA.y*this.m_rA.x*m-this.m_rB.y*this.m_rB.x*_,f.ez.x=-this.m_rA.y*m-this.m_rB.y*_,f.ex.y=f.ey.x,f.ey.y=c+h+this.m_rA.x*this.m_rA.x*m+this.m_rB.x*this.m_rB.x*_,f.ez.y=this.m_rA.x*m+this.m_rB.x*_,f.ex.z=f.ez.x,f.ey.z=f.ez.y,f.ez.z=m+_,this.m_frequencyHz>0){f.GetInverse22(this.m_mass);let i=m+_;const n=i>0?1/i:0,o=r-e-this.m_referenceAngle,a=2*s*this.m_frequencyHz,l=2*n*this.m_dampingRatio*a,u=n*a*a,c=t.step.dt;this.m_gamma=c*(l+c*u),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=o*c*u*this.m_gamma,i+=this.m_gamma,this.m_mass.ez.z=0!==i?1/i:0}else f.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0;if(t.step.warmStarting){this.m_impulse.SelfMul(t.step.dtRatio);const e=Gi.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);i.SelfMulSub(c,e),n-=m*(N.CrossVV(this.m_rA,e)+this.m_impulse.z),o.SelfMulAdd(h,e),a+=_*(N.CrossVV(this.m_rB,e)+this.m_impulse.z)}else this.m_impulse.SetZero();t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=a}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const s=this.m_invMassA,o=this.m_invMassB,a=this.m_invIA,l=this.m_invIB;if(this.m_frequencyHz>0){const t=r-i,u=-this.m_mass.ez.z*(t+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=u,i-=a*u,r+=l*u;const c=N.SubVV(N.AddVCrossSV(n,r,this.m_rB,N.s_t0),N.AddVCrossSV(e,i,this.m_rA,N.s_t1),Gi.SolveVelocityConstraints_s_Cdot1),h=J.MulM33XY(this.m_mass,c.x,c.y,Gi.SolveVelocityConstraints_s_impulse1).SelfNeg();this.m_impulse.x+=h.x,this.m_impulse.y+=h.y;const m=h;e.SelfMulSub(s,m),i-=a*N.CrossVV(this.m_rA,m),n.SelfMulAdd(o,m),r+=l*N.CrossVV(this.m_rB,m)}else{const t=N.SubVV(N.AddVCrossSV(n,r,this.m_rB,N.s_t0),N.AddVCrossSV(e,i,this.m_rA,N.s_t1),Gi.SolveVelocityConstraints_s_Cdot1),u=r-i,c=J.MulM33XYZ(this.m_mass,t.x,t.y,u,Gi.SolveVelocityConstraints_s_impulse).SelfNeg();this.m_impulse.SelfAdd(c);const h=Gi.SolveVelocityConstraints_s_P.Set(c.x,c.y);e.SelfMulSub(s,h),i-=a*(N.CrossVV(this.m_rA,h)+c.z),n.SelfMulAdd(o,h),r+=l*(N.CrossVV(this.m_rB,h)+c.z)}t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=r}SolvePositionConstraints(t){const e=t.positions[this.m_indexA].c;let i=t.positions[this.m_indexA].a;const n=t.positions[this.m_indexB].c;let r=t.positions[this.m_indexB].a;const s=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(r),u=this.m_invMassA,c=this.m_invMassB,h=this.m_invIA,m=this.m_invIB;N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const _=W.MulRV(s,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const f=W.MulRV(o,this.m_lalcB,this.m_rB);let d,p;const y=this.m_K;if(y.ex.x=u+c+_.y*_.y*h+f.y*f.y*m,y.ey.x=-_.y*_.x*h-f.y*f.x*m,y.ez.x=-_.y*h-f.y*m,y.ex.y=y.ey.x,y.ey.y=u+c+_.x*_.x*h+f.x*f.x*m,y.ez.y=_.x*h+f.x*m,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=h+m,this.m_frequencyHz>0){const t=N.SubVV(N.AddVV(n,f,N.s_t0),N.AddVV(e,_,N.s_t1),Gi.SolvePositionConstraints_s_C1);d=t.Length(),p=0;const s=y.Solve22(t.x,t.y,Gi.SolvePositionConstraints_s_P).SelfNeg();e.SelfMulSub(u,s),i-=h*N.CrossVV(_,s),n.SelfMulAdd(c,s),r+=m*N.CrossVV(f,s)}else{const t=N.SubVV(N.AddVV(n,f,N.s_t0),N.AddVV(e,_,N.s_t1),Gi.SolvePositionConstraints_s_C1),s=r-i-this.m_referenceAngle;d=t.Length(),p=V(s);const o=y.Solve33(t.x,t.y,s,Gi.SolvePositionConstraints_s_impulse).SelfNeg(),a=Gi.SolvePositionConstraints_s_P.Set(o.x,o.y);e.SelfMulSub(u,a),i-=h*(N.CrossVV(this.m_rA,a)+o.z),n.SelfMulAdd(c,a),r+=m*(N.CrossVV(this.m_rB,a)+o.z)}return t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].a=r,d<=a&&p<=l}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*this.m_impulse.x,e.y=t*this.m_impulse.y,e}GetReactionTorque(t){return t*this.m_impulse.z}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetReferenceAngle(){return this.m_referenceAngle}SetFrequency(t){this.m_frequencyHz=t}GetFrequency(){return this.m_frequencyHz}SetDampingRatio(t){this.m_dampingRatio=t}GetDampingRatio(){return this.m_dampingRatio}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2WeldJointDef = new b2WeldJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),t("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),t("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}Gi.InitVelocityConstraints_s_P=new N,Gi.SolveVelocityConstraints_s_Cdot1=new N,Gi.SolveVelocityConstraints_s_impulse1=new N,Gi.SolveVelocityConstraints_s_impulse=new q,Gi.SolveVelocityConstraints_s_P=new N,Gi.SolvePositionConstraints_s_C1=new N,Gi.SolvePositionConstraints_s_P=new N,Gi.SolvePositionConstraints_s_impulse=new q;class Ti extends xi{constructor(t){super(t),this.m_frequencyHz=0,this.m_dampingRatio=0,this.m_localAnchorA=new N,this.m_localAnchorB=new N,this.m_localXAxisA=new N,this.m_localYAxisA=new N,this.m_impulse=0,this.m_motorImpulse=0,this.m_springImpulse=0,this.m_maxMotorTorque=0,this.m_motorSpeed=0,this.m_enableMotor=!1,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new N,this.m_localCenterB=new N,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_ax=new N,this.m_ay=new N,this.m_sAx=0,this.m_sBx=0,this.m_sAy=0,this.m_sBy=0,this.m_mass=0,this.m_motorMass=0,this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_qA=new W,this.m_qB=new W,this.m_lalcA=new N,this.m_lalcB=new N,this.m_rA=new N,this.m_rB=new N,this.m_frequencyHz=e(t.frequencyHz,2),this.m_dampingRatio=e(t.dampingRatio,.7),this.m_localAnchorA.Copy(e(t.localAnchorA,N.ZERO)),this.m_localAnchorB.Copy(e(t.localAnchorB,N.ZERO)),this.m_localXAxisA.Copy(e(t.localAxisA,N.UNITX)),N.CrossOneV(this.m_localXAxisA,this.m_localYAxisA),this.m_maxMotorTorque=e(t.maxMotorTorque,0),this.m_motorSpeed=e(t.motorSpeed,0),this.m_enableMotor=e(t.enableMotor,!1),this.m_ax.SetZero(),this.m_ay.SetZero()}GetMotorSpeed(){return this.m_motorSpeed}GetMaxMotorTorque(){return this.m_maxMotorTorque}SetSpringFrequencyHz(t){this.m_frequencyHz=t}GetSpringFrequencyHz(){return this.m_frequencyHz}SetSpringDampingRatio(t){this.m_dampingRatio=t}GetSpringDampingRatio(){return this.m_dampingRatio}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_invMassA,i=this.m_invMassB,n=this.m_invIA,r=this.m_invIB,o=t.positions[this.m_indexA].c,a=t.positions[this.m_indexA].a,l=t.velocities[this.m_indexA].v;let u=t.velocities[this.m_indexA].w;const c=t.positions[this.m_indexB].c,h=t.positions[this.m_indexB].a,m=t.velocities[this.m_indexB].v;let _=t.velocities[this.m_indexB].w;const f=this.m_qA.SetAngle(a),d=this.m_qB.SetAngle(h);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const p=W.MulRV(f,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const y=W.MulRV(d,this.m_lalcB,this.m_rB),v=N.SubVV(N.AddVV(c,y,N.s_t0),N.AddVV(o,p,N.s_t1),Ti.InitVelocityConstraints_s_d);if(W.MulRV(f,this.m_localYAxisA,this.m_ay),this.m_sAy=N.CrossVV(N.AddVV(v,p,N.s_t0),this.m_ay),this.m_sBy=N.CrossVV(y,this.m_ay),this.m_mass=e+i+n*this.m_sAy*this.m_sAy+r*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){W.MulRV(f,this.m_localXAxisA,this.m_ax),this.m_sAx=N.CrossVV(N.AddVV(v,p,N.s_t0),this.m_ax),this.m_sBx=N.CrossVV(y,this.m_ax);const o=e+i+n*this.m_sAx*this.m_sAx+r*this.m_sBx*this.m_sBx;if(o>0){this.m_springMass=1/o;const e=N.DotVV(v,this.m_ax),i=2*s*this.m_frequencyHz,n=2*this.m_springMass*this.m_dampingRatio*i,r=this.m_springMass*i*i,a=t.step.dt;this.m_gamma=a*(n+a*r),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=e*a*r*this.m_gamma,this.m_springMass=o+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=n+r,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse*=t.step.dtRatio,this.m_springImpulse*=t.step.dtRatio,this.m_motorImpulse*=t.step.dtRatio;const e=N.AddVV(N.MulSV(this.m_impulse,this.m_ay,N.s_t0),N.MulSV(this.m_springImpulse,this.m_ax,N.s_t1),Ti.InitVelocityConstraints_s_P),i=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,n=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;l.SelfMulSub(this.m_invMassA,e),u-=this.m_invIA*i,m.SelfMulAdd(this.m_invMassB,e),_+=this.m_invIB*n}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;t.velocities[this.m_indexA].w=u,t.velocities[this.m_indexB].w=_}SolveVelocityConstraints(t){const e=this.m_invMassA,i=this.m_invMassB,n=this.m_invIA,r=this.m_invIB,s=t.velocities[this.m_indexA].v;let o=t.velocities[this.m_indexA].w;const a=t.velocities[this.m_indexB].v;let l=t.velocities[this.m_indexB].w;{const t=N.DotVV(this.m_ax,N.SubVV(a,s,N.s_t0))+this.m_sBx*l-this.m_sAx*o,u=-this.m_springMass*(t+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=u;const c=N.MulSV(u,this.m_ax,Ti.SolveVelocityConstraints_s_P),h=u*this.m_sAx,m=u*this.m_sBx;s.SelfMulSub(e,c),o-=n*h,a.SelfMulAdd(i,c),l+=r*m}{const e=l-o-this.m_motorSpeed;let i=-this.m_motorMass*e;const s=this.m_motorImpulse,a=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=I(this.m_motorImpulse+i,-a,a),i=this.m_motorImpulse-s,o-=n*i,l+=r*i}{const t=N.DotVV(this.m_ay,N.SubVV(a,s,N.s_t0))+this.m_sBy*l-this.m_sAy*o,u=-this.m_mass*t;this.m_impulse+=u;const c=N.MulSV(u,this.m_ay,Ti.SolveVelocityConstraints_s_P),h=u*this.m_sAy,m=u*this.m_sBy;s.SelfMulSub(e,c),o-=n*h,a.SelfMulAdd(i,c),l+=r*m}t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=l}SolvePositionConstraints(t){const e=t.positions[this.m_indexA].c;let i=t.positions[this.m_indexA].a;const n=t.positions[this.m_indexB].c;let r=t.positions[this.m_indexB].a;const s=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(r);N.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);const l=W.MulRV(s,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);const u=W.MulRV(o,this.m_lalcB,this.m_rB),c=N.AddVV(N.SubVV(n,e,N.s_t0),N.SubVV(u,l,N.s_t1),Ti.SolvePositionConstraints_s_d),h=W.MulRV(s,this.m_localYAxisA,this.m_ay),m=N.CrossVV(N.AddVV(c,l,N.s_t0),h),_=N.CrossVV(u,h),f=N.DotVV(c,this.m_ay),d=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;let p;p=0!==d?-f/d:0;const y=N.MulSV(p,h,Ti.SolvePositionConstraints_s_P),v=p*m,g=p*_;return e.SelfMulSub(this.m_invMassA,y),i-=this.m_invIA*v,n.SelfMulAdd(this.m_invMassB,y),r+=this.m_invIB*g,t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].a=r,V(f)<=a}GetDefinition(t){return t}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return e.x=t*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x),e.y=t*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y),e}GetReactionTorque(t){return t*this.m_motorImpulse}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetLocalAxisA(){return this.m_localXAxisA}GetJointTranslation(){return this.GetPrismaticJointTranslation()}GetJointLinearSpeed(){return this.GetPrismaticJointSpeed()}GetJointAngle(){return this.GetRevoluteJointAngle()}GetJointAngularSpeed(){return this.GetRevoluteJointSpeed()}GetPrismaticJointTranslation(){const t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchorA,new N),n=e.GetWorldPoint(this.m_localAnchorB,new N),r=N.SubVV(n,i,new N),s=t.GetWorldVector(this.m_localXAxisA,new N);return N.DotVV(r,s)}GetPrismaticJointSpeed(){const t=this.m_bodyA,e=this.m_bodyB;N.SubVV(this.m_localAnchorA,t.m_sweep.localCenter,this.m_lalcA);const i=W.MulRV(t.m_xf.q,this.m_lalcA,this.m_rA);N.SubVV(this.m_localAnchorB,e.m_sweep.localCenter,this.m_lalcB);const n=W.MulRV(e.m_xf.q,this.m_lalcB,this.m_rB),r=N.AddVV(t.m_sweep.c,i,N.s_t0),s=N.AddVV(e.m_sweep.c,n,N.s_t1),o=N.SubVV(s,r,N.s_t2),a=t.GetWorldVector(this.m_localXAxisA,new N),l=t.m_linearVelocity,u=e.m_linearVelocity,c=t.m_angularVelocity,h=e.m_angularVelocity;return N.DotVV(o,N.CrossSV(c,a,N.s_t0))+N.DotVV(a,N.SubVV(N.AddVCrossSV(u,h,n,N.s_t0),N.AddVCrossSV(l,c,i,N.s_t1),N.s_t0))}GetRevoluteJointAngle(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a}GetRevoluteJointSpeed(){const t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)}SetMotorSpeed(t){t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)}SetMaxMotorTorque(t){t!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=t)}GetMotorTorque(t){return t*this.m_motorImpulse}Dump(t){const e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2WheelJointDef = new b2WheelJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),t("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),t("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),t("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),t("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),t("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}function Fi(t,e){return T(t*e)}function Li(t,e){return t>e?t:e}Ti.InitVelocityConstraints_s_d=new N,Ti.InitVelocityConstraints_s_P=new N,Ti.SolveVelocityConstraints_s_P=new N,Ti.SolvePositionConstraints_s_d=new N,Ti.SolvePositionConstraints_s_P=new N;class Ri{constructor(t){this.prev=null,this.next=null,this.contact=t}}class Ei{constructor(){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_prev=null,this.m_next=null,this.m_indexA=0,this.m_indexB=0,this.m_manifold=new Pt,this.m_toiCount=0,this.m_toi=0,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_oldManifold=new Pt,this.m_nodeA=new Ri(this),this.m_nodeB=new Ri(this)}GetManifold(){return this.m_manifold}GetWorldManifold(t){const e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),r.m_radius)}IsTouching(){return this.m_touchingFlag}SetEnabled(t){this.m_enabledFlag=t}IsEnabled(){return this.m_enabledFlag}GetNext(){return this.m_next}GetFixtureA(){return this.m_fixtureA}GetChildIndexA(){return this.m_indexA}GetFixtureB(){return this.m_fixtureB}GetChildIndexB(){return this.m_indexB}FlagForFiltering(){this.m_filterFlag=!0}SetFriction(t){this.m_friction=t}GetFriction(){return this.m_friction}ResetFriction(){this.m_friction=Fi(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)}SetRestitution(t){this.m_restitution=t}GetRestitution(){return this.m_restitution}ResetRestitution(){this.m_restitution=Li(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)}SetTangentSpeed(t){this.m_tangentSpeed=t}GetTangentSpeed(){return this.m_tangentSpeed}Reset(t,e,i,n){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!0,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=n,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,delete this.m_nodeA.contact,this.m_nodeA.prev=null,this.m_nodeA.next=null,delete this.m_nodeA.other,delete this.m_nodeB.contact,this.m_nodeB.prev=null,this.m_nodeB.next=null,delete this.m_nodeB.other,this.m_toiCount=0,this.m_friction=Fi(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=Li(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)}Update(t){const e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_enabledFlag=!0;let i=!1;const n=this.m_touchingFlag,r=this.m_fixtureA.IsSensor(),s=this.m_fixtureB.IsSensor(),o=r||s,a=this.m_fixtureA.GetBody(),l=this.m_fixtureB.GetBody(),u=a.GetTransform(),c=l.GetTransform();if(o){const t=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();i=zt(t,this.m_indexA,e,this.m_indexB,u,c),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,u,c),i=this.m_manifold.pointCount>0;for(let t=0;t<this.m_manifold.pointCount;++t){const e=this.m_manifold.points[t];e.normalImpulse=0,e.tangentImpulse=0;const i=e.id;for(let t=0;t<this.m_oldManifold.pointCount;++t){const n=this.m_oldManifold.points[t];if(n.id.key===i.key){e.normalImpulse=n.normalImpulse,e.tangentImpulse=n.tangentImpulse;break}}}i!==n&&(a.SetAwake(!0),l.SetAwake(!0))}this.m_touchingFlag=i,!n&&i&&t&&t.BeginContact(this),n&&!i&&t&&t.EndContact(this),!o&&i&&t&&t.PreSolve(this,this.m_oldManifold)}ComputeTOI(t,e){const i=Ei.ComputeTOI_s_input;i.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA),i.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB),i.sweepA.Copy(t),i.sweepB.Copy(e),i.tMax=a;const n=Ei.ComputeTOI_s_output;return _e(n,i),n.t}}Ei.ComputeTOI_s_input=new Kt,Ei.ComputeTOI_s_output=new ie;class zi extends Ei{constructor(){super()}static Create(t){return new zi}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){pe(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)}}class Oi extends Ei{constructor(){super()}static Create(t){return new Oi}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){qe(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)}}class Ni extends Ei{constructor(){super()}static Create(t){return new Ni}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){be(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)}}class ji extends Ei{constructor(){super()}static Create(t){return new ji}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){Ye(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)}}class qi extends Ei{constructor(){super()}static Create(t){return new qi}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){ni(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)}}class Ui extends Ei{constructor(){super()}static Create(t){return new Ui}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){const n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape(),s=n,o=Ui.Evaluate_s_edge;s.GetChildEdge(o,this.m_indexA),Ye(t,o,e,r,i)}}Ui.Evaluate_s_edge=new mi;class Ji extends Ei{constructor(){super()}static Create(t){return new Ji}static Destroy(t,e){}Reset(t,e,i,n){super.Reset(t,e,i,n)}Evaluate(t,e,i){const n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape(),s=n,o=Ji.Evaluate_s_edge;s.GetChildEdge(o,this.m_indexA),ni(t,o,e,r,i)}}Ji.Evaluate_s_edge=new mi;class Wi{constructor(){this.createFcn=null,this.destroyFcn=null,this.primary=!1}}class Xi{constructor(t){this.m_allocator=null,this.m_allocator=t,this.InitializeRegisters()}AddType(t,e,i,n){const r=S(256,(e=>t(this.m_allocator)));function s(e){return r.pop()||t(e)}function o(t,e){r.push(t)}this.m_registers[i][n].createFcn=s,this.m_registers[i][n].destroyFcn=o,this.m_registers[i][n].primary=!0,i!==n&&(this.m_registers[n][i].createFcn=s,this.m_registers[n][i].destroyFcn=o,this.m_registers[n][i].primary=!1)}InitializeRegisters(){this.m_registers=[];for(let e=0;e<t.b2ShapeType.e_shapeTypeCount;e++){this.m_registers[e]=[];for(let i=0;i<t.b2ShapeType.e_shapeTypeCount;i++)this.m_registers[e][i]=new Wi}this.AddType(zi.Create,zi.Destroy,t.b2ShapeType.e_circleShape,t.b2ShapeType.e_circleShape),this.AddType(Ni.Create,Ni.Destroy,t.b2ShapeType.e_polygonShape,t.b2ShapeType.e_circleShape),this.AddType(Oi.Create,Oi.Destroy,t.b2ShapeType.e_polygonShape,t.b2ShapeType.e_polygonShape),this.AddType(ji.Create,ji.Destroy,t.b2ShapeType.e_edgeShape,t.b2ShapeType.e_circleShape),this.AddType(qi.Create,qi.Destroy,t.b2ShapeType.e_edgeShape,t.b2ShapeType.e_polygonShape),this.AddType(Ui.Create,Ui.Destroy,t.b2ShapeType.e_chainShape,t.b2ShapeType.e_circleShape),this.AddType(Ji.Create,Ji.Destroy,t.b2ShapeType.e_chainShape,t.b2ShapeType.e_polygonShape)}Create(t,e,i,n){const r=t.GetType(),s=i.GetType(),o=this.m_registers[r][s];if(o.createFcn){const r=o.createFcn(this.m_allocator);return o.primary?r.Reset(t,e,i,n):r.Reset(i,n,t,e),r}return null}Destroy(t){const e=t.m_fixtureA,i=t.m_fixtureB;t.m_manifold.pointCount>0&&!e.IsSensor()&&!i.IsSensor()&&(e.GetBody().SetAwake(!0),i.GetBody().SetAwake(!0));const n=e.GetType(),r=i.GetType(),s=this.m_registers[n][r];s.destroyFcn&&s.destroyFcn(t,this.m_allocator)}}class Hi{ShouldCollide(e,i){const n=e.GetBody(),r=i.GetBody();if(r.GetType()===t.b2BodyType.b2_staticBody&&n.GetType()===t.b2BodyType.b2_staticBody)return!1;if(!r.ShouldCollideConnected(n))return!1;const s=e.GetFilterData(),o=i.GetFilterData();if(s.groupIndex===o.groupIndex&&0!==s.groupIndex)return s.groupIndex>0;return 0!=(s.maskBits&o.categoryBits)&&0!=(s.categoryBits&o.maskBits)}ShouldCollideFixtureParticle(t,e,i){return!0}ShouldCollideParticleParticle(t,e,i){return!0}}Hi.b2_defaultFilter=new Hi;class Zi{constructor(){this.normalImpulses=w(2),this.tangentImpulses=w(2),this.count=0}}class Qi{BeginContact(t){}EndContact(t){}BeginContactFixtureParticle(t,e){}EndContactFixtureParticle(t,e){}BeginContactParticleParticle(t,e){}EndContactParticleParticle(t,e){}PreSolve(t,e){}PostSolve(t,e){}}Qi.b2_defaultListener=new Qi;class $i{ReportFixture(t){return!0}ReportParticle(t,e){return!1}ShouldQueryParticleSystem(t){return!0}}class Yi{constructor(){this.m_broadPhase=new Ut,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=Hi.b2_defaultFilter,this.m_contactListener=Qi.b2_defaultListener,this.m_allocator=null,this.m_contactFactory=new Xi(this.m_allocator)}AddPair(t,e){let i=t.fixture,n=e.fixture,r=t.childIndex,s=e.childIndex,o=i.GetBody(),a=n.GetBody();if(o===a)return;let l=a.GetContactList();for(;l;){if(l.other===o){const t=l.contact.GetFixtureA(),e=l.contact.GetFixtureB(),o=l.contact.GetChildIndexA(),a=l.contact.GetChildIndexB();if(t===i&&e===n&&o===r&&a===s)return;if(t===n&&e===i&&o===s&&a===r)return}l=l.next}if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(i,n))return;const u=this.m_contactFactory.Create(i,r,n,s);null!==u&&(i=u.GetFixtureA(),n=u.GetFixtureB(),r=u.GetChildIndexA(),s=u.GetChildIndexB(),o=i.m_body,a=n.m_body,u.m_prev=null,u.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=u),this.m_contactList=u,u.m_nodeA.contact=u,u.m_nodeA.other=a,u.m_nodeA.prev=null,u.m_nodeA.next=o.m_contactList,null!==o.m_contactList&&(o.m_contactList.prev=u.m_nodeA),o.m_contactList=u.m_nodeA,u.m_nodeB.contact=u,u.m_nodeB.other=o,u.m_nodeB.prev=null,u.m_nodeB.next=a.m_contactList,null!==a.m_contactList&&(a.m_contactList.prev=u.m_nodeB),a.m_contactList=u.m_nodeB,i.IsSensor()||n.IsSensor()||(o.SetAwake(!0),a.SetAwake(!0)),++this.m_contactCount)}FindNewContacts(){this.m_broadPhase.UpdatePairs(((t,e)=>{this.AddPair(t,e)}))}Destroy(t){const e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();this.m_contactListener&&t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_contactList&&(this.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount}Collide(){let e=this.m_contactList;for(;e;){const i=e.GetFixtureA(),n=e.GetFixtureB(),r=e.GetChildIndexA(),s=e.GetChildIndexB(),o=i.GetBody(),a=n.GetBody();if(e.m_filterFlag){if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(i,n)){const t=e;e=t.m_next,this.Destroy(t);continue}e.m_filterFlag=!1}const l=o.IsAwake()&&o.m_type!==t.b2BodyType.b2_staticBody,u=a.IsAwake()&&a.m_type!==t.b2BodyType.b2_staticBody;if(!l&&!u){e=e.m_next;continue}const c=i.m_proxies[r].treeNode,h=n.m_proxies[s].treeNode;if(Tt(c.aabb,h.aabb))e.Update(this.m_contactListener),e=e.m_next;else{const t=e;e=t.m_next,this.Destroy(t)}}}}class Ki{constructor(){this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0}Reset(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this}}class tn{constructor(){this.dt=0,this.inv_dt=0,this.dtRatio=0,this.velocityIterations=0,this.positionIterations=0,this.particleIterations=0,this.warmStarting=!1}Copy(t){return this.dt=t.dt,this.inv_dt=t.inv_dt,this.dtRatio=t.dtRatio,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.particleIterations=t.particleIterations,this.warmStarting=t.warmStarting,this}}class en{constructor(){this.c=new N,this.a=0}static MakeArray(t){return S(t,(t=>new en))}}class nn{constructor(){this.v=new N,this.w=0}static MakeArray(t){return S(t,(t=>new nn))}}class rn{constructor(){this.step=new tn}}let sn=!1;class on{constructor(){this.rA=new N,this.rB=new N,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}static MakeArray(t){return S(t,(t=>new on))}}class an{constructor(){this.points=on.MakeArray(2),this.normal=new N,this.tangent=new N,this.normalMass=new U,this.K=new U,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}static MakeArray(t){return S(t,(t=>new an))}}class ln{constructor(){this.localPoints=N.MakeArray(2),this.localNormal=new N,this.localPoint=new N,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new N,this.localCenterB=new N,this.invIA=0,this.invIB=0,this.type=t.b2ManifoldType.e_unknown,this.radiusA=0,this.radiusB=0,this.pointCount=0}static MakeArray(t){return S(t,(t=>new ln))}}class un{constructor(){this.step=new tn,this.count=0,this.allocator=null}}class cn{constructor(){this.normal=new N,this.point=new N,this.separation=0}Initialize(e,i,n,r){const s=cn.Initialize_s_pointA,o=cn.Initialize_s_pointB,a=cn.Initialize_s_planePoint,l=cn.Initialize_s_clipPoint;switch(e.type){case t.b2ManifoldType.e_circles:X.MulXV(i,e.localPoint,s),X.MulXV(n,e.localPoints[0],o),N.SubVV(o,s,this.normal).SelfNormalize(),N.MidVV(s,o,this.point),this.separation=N.DotVV(N.SubVV(o,s,N.s_t0),this.normal)-e.radiusA-e.radiusB;break;case t.b2ManifoldType.e_faceA:W.MulRV(i.q,e.localNormal,this.normal),X.MulXV(i,e.localPoint,a),X.MulXV(n,e.localPoints[r],l),this.separation=N.DotVV(N.SubVV(l,a,N.s_t0),this.normal)-e.radiusA-e.radiusB,this.point.Copy(l);break;case t.b2ManifoldType.e_faceB:W.MulRV(n.q,e.localNormal,this.normal),X.MulXV(n,e.localPoint,a),X.MulXV(i,e.localPoints[r],l),this.separation=N.DotVV(N.SubVV(l,a,N.s_t0),this.normal)-e.radiusA-e.radiusB,this.point.Copy(l),this.normal.SelfNeg()}}}cn.Initialize_s_pointA=new N,cn.Initialize_s_pointB=new N,cn.Initialize_s_planePoint=new N,cn.Initialize_s_clipPoint=new N;class hn{constructor(){this.m_step=new tn,this.m_allocator=null,this.m_positionConstraints=ln.MakeArray(1024),this.m_velocityConstraints=an.MakeArray(1024),this.m_count=0}Initialize(t){if(this.m_step.Copy(t.step),this.m_allocator=t.allocator,this.m_count=t.count,this.m_positionConstraints.length<this.m_count){const t=M(2*this.m_positionConstraints.length,this.m_count);for(;this.m_positionConstraints.length<t;)this.m_positionConstraints[this.m_positionConstraints.length]=new ln}if(this.m_velocityConstraints.length<this.m_count){const t=M(2*this.m_velocityConstraints.length,this.m_count);for(;this.m_velocityConstraints.length<t;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new an}this.m_positions=t.positions,this.m_velocities=t.velocities,this.m_contacts=t.contacts;for(let e=0;e<this.m_count;++e){const t=this.m_contacts[e],i=t.m_fixtureA,n=t.m_fixtureB,r=i.GetShape(),s=n.GetShape(),o=r.m_radius,a=s.m_radius,l=i.GetBody(),u=n.GetBody(),c=t.GetManifold(),h=c.pointCount,m=this.m_velocityConstraints[e];m.friction=t.m_friction,m.restitution=t.m_restitution,m.tangentSpeed=t.m_tangentSpeed,m.indexA=l.m_islandIndex,m.indexB=u.m_islandIndex,m.invMassA=l.m_invMass,m.invMassB=u.m_invMass,m.invIA=l.m_invI,m.invIB=u.m_invI,m.contactIndex=e,m.pointCount=h,m.K.SetZero(),m.normalMass.SetZero();const _=this.m_positionConstraints[e];_.indexA=l.m_islandIndex,_.indexB=u.m_islandIndex,_.invMassA=l.m_invMass,_.invMassB=u.m_invMass,_.localCenterA.Copy(l.m_sweep.localCenter),_.localCenterB.Copy(u.m_sweep.localCenter),_.invIA=l.m_invI,_.invIB=u.m_invI,_.localNormal.Copy(c.localNormal),_.localPoint.Copy(c.localPoint),_.pointCount=h,_.radiusA=o,_.radiusB=a,_.type=c.type;for(let e=0;e<h;++e){const t=c.points[e],i=m.points[e];this.m_step.warmStarting?(i.normalImpulse=this.m_step.dtRatio*t.normalImpulse,i.tangentImpulse=this.m_step.dtRatio*t.tangentImpulse):(i.normalImpulse=0,i.tangentImpulse=0),i.rA.SetZero(),i.rB.SetZero(),i.normalMass=0,i.tangentMass=0,i.velocityBias=0,_.localPoints[e].Copy(t.localPoint)}}return this}InitializeVelocityConstraints(){const t=hn.InitializeVelocityConstraints_s_xfA,e=hn.InitializeVelocityConstraints_s_xfB,i=hn.InitializeVelocityConstraints_s_worldManifold;for(let n=0;n<this.m_count;++n){const r=this.m_velocityConstraints[n],s=this.m_positionConstraints[n],o=s.radiusA,a=s.radiusB,l=this.m_contacts[r.contactIndex].GetManifold(),u=r.indexA,c=r.indexB,h=r.invMassA,m=r.invMassB,_=r.invIA,f=r.invIB,d=s.localCenterA,p=s.localCenterB,y=this.m_positions[u].c,v=this.m_positions[u].a,g=this.m_velocities[u].v,b=this.m_velocities[u].w,x=this.m_positions[c].c,S=this.m_positions[c].a,w=this.m_velocities[c].v,B=this.m_velocities[c].w;t.q.SetAngle(v),e.q.SetAngle(S),N.SubVV(y,W.MulRV(t.q,d,N.s_t0),t.p),N.SubVV(x,W.MulRV(e.q,p,N.s_t0),e.p),i.Initialize(l,t,o,e,a),r.normal.Copy(i.normal),N.CrossVOne(r.normal,r.tangent);const C=r.pointCount;for(let t=0;t<C;++t){const e=r.points[t];N.SubVV(i.points[t],y,e.rA),N.SubVV(i.points[t],x,e.rB);const n=N.CrossVV(e.rA,r.normal),s=N.CrossVV(e.rB,r.normal),o=h+m+_*n*n+f*s*s;e.normalMass=o>0?1/o:0;const a=r.tangent,l=N.CrossVV(e.rA,a),u=N.CrossVV(e.rB,a),c=h+m+_*l*l+f*u*u;e.tangentMass=c>0?1/c:0,e.velocityBias=0;const d=N.DotVV(r.normal,N.SubVV(N.AddVCrossSV(w,B,e.rB,N.s_t0),N.AddVCrossSV(g,b,e.rA,N.s_t1),N.s_t0));d<-1&&(e.velocityBias+=-r.restitution*d)}r.pointCount,0}}WarmStart(){const t=hn.WarmStart_s_P;for(let e=0;e<this.m_count;++e){const i=this.m_velocityConstraints[e],n=i.indexA,r=i.indexB,s=i.invMassA,o=i.invIA,a=i.invMassB,l=i.invIB,u=i.pointCount,c=this.m_velocities[n].v;let h=this.m_velocities[n].w;const m=this.m_velocities[r].v;let _=this.m_velocities[r].w;const f=i.normal,d=i.tangent;for(let e=0;e<u;++e){const n=i.points[e];N.AddVV(N.MulSV(n.normalImpulse,f,N.s_t0),N.MulSV(n.tangentImpulse,d,N.s_t1),t),h-=o*N.CrossVV(n.rA,t),c.SelfMulSub(s,t),_+=l*N.CrossVV(n.rB,t),m.SelfMulAdd(a,t)}this.m_velocities[n].w=h,this.m_velocities[r].w=_}}SolveVelocityConstraints(){const t=hn.SolveVelocityConstraints_s_dv,e=(hn.SolveVelocityConstraints_s_dv1,hn.SolveVelocityConstraints_s_dv2,hn.SolveVelocityConstraints_s_P);hn.SolveVelocityConstraints_s_a,hn.SolveVelocityConstraints_s_b,hn.SolveVelocityConstraints_s_x,hn.SolveVelocityConstraints_s_d,hn.SolveVelocityConstraints_s_P1,hn.SolveVelocityConstraints_s_P2,hn.SolveVelocityConstraints_s_P1P2;for(let i=0;i<this.m_count;++i){const n=this.m_velocityConstraints[i],r=n.indexA,s=n.indexB,o=n.invMassA,a=n.invIA,l=n.invMassB,u=n.invIB,c=n.pointCount,h=this.m_velocities[r].v;let m=this.m_velocities[r].w;const _=this.m_velocities[s].v;let f=this.m_velocities[s].w;const d=n.normal,p=n.tangent,y=n.friction;for(let i=0;i<c;++i){const r=n.points[i];N.SubVV(N.AddVCrossSV(_,f,r.rB,N.s_t0),N.AddVCrossSV(h,m,r.rA,N.s_t1),t);const s=N.DotVV(t,p)-n.tangentSpeed;let c=r.tangentMass*-s;const d=y*r.normalImpulse,v=I(r.tangentImpulse+c,-d,d);c=v-r.tangentImpulse,r.tangentImpulse=v,N.MulSV(c,p,e),h.SelfMulSub(o,e),m-=a*N.CrossVV(r.rA,e),_.SelfMulAdd(l,e),f+=u*N.CrossVV(r.rB,e)}n.pointCount;for(let i=0;i<c;++i){const r=n.points[i];N.SubVV(N.AddVCrossSV(_,f,r.rB,N.s_t0),N.AddVCrossSV(h,m,r.rA,N.s_t1),t);const s=N.DotVV(t,d);let c=-r.normalMass*(s-r.velocityBias);const p=M(r.normalImpulse+c,0);c=p-r.normalImpulse,r.normalImpulse=p,N.MulSV(c,d,e),h.SelfMulSub(o,e),m-=a*N.CrossVV(r.rA,e),_.SelfMulAdd(l,e),f+=u*N.CrossVV(r.rB,e)}this.m_velocities[r].w=m,this.m_velocities[s].w=f}}StoreImpulses(){for(let t=0;t<this.m_count;++t){const e=this.m_velocityConstraints[t],i=this.m_contacts[e.contactIndex].GetManifold();for(let t=0;t<e.pointCount;++t)i.points[t].normalImpulse=e.points[t].normalImpulse,i.points[t].tangentImpulse=e.points[t].tangentImpulse}}SolvePositionConstraints(){const t=hn.SolvePositionConstraints_s_xfA,e=hn.SolvePositionConstraints_s_xfB,i=hn.SolvePositionConstraints_s_psm,n=hn.SolvePositionConstraints_s_rA,r=hn.SolvePositionConstraints_s_rB,s=hn.SolvePositionConstraints_s_P;let o=0;for(let l=0;l<this.m_count;++l){const u=this.m_positionConstraints[l],h=u.indexA,m=u.indexB,_=u.localCenterA,f=u.invMassA,d=u.invIA,p=u.localCenterB,y=u.invMassB,v=u.invIB,g=u.pointCount,b=this.m_positions[h].c;let x=this.m_positions[h].a;const S=this.m_positions[m].c;let w=this.m_positions[m].a;for(let l=0;l<g;++l){t.q.SetAngle(x),e.q.SetAngle(w),N.SubVV(b,W.MulRV(t.q,_,N.s_t0),t.p),N.SubVV(S,W.MulRV(e.q,p,N.s_t0),e.p),i.Initialize(u,t,e,l);const h=i.normal,m=i.point,g=i.separation;N.SubVV(m,b,n),N.SubVV(m,S,r),o=P(o,g);const B=I(.2*(g+a),-c,0),C=N.CrossVV(n,h),A=N.CrossVV(r,h),V=f+y+d*C*C+v*A*A,M=V>0?-B/V:0;N.MulSV(M,h,s),b.SelfMulSub(f,s),x-=d*N.CrossVV(n,s),S.SelfMulAdd(y,s),w+=v*N.CrossVV(r,s)}this.m_positions[h].a=x,this.m_positions[m].a=w}return o>-3*a}SolveTOIPositionConstraints(t,e){const i=hn.SolveTOIPositionConstraints_s_xfA,n=hn.SolveTOIPositionConstraints_s_xfB,r=hn.SolveTOIPositionConstraints_s_psm,s=hn.SolveTOIPositionConstraints_s_rA,o=hn.SolveTOIPositionConstraints_s_rB,l=hn.SolveTOIPositionConstraints_s_P;let u=0;for(let h=0;h<this.m_count;++h){const m=this.m_positionConstraints[h],_=m.indexA,f=m.indexB,d=m.localCenterA,p=m.localCenterB,y=m.pointCount;let v=0,g=0;_!==t&&_!==e||(v=m.invMassA,g=m.invIA);let b=0,x=0;f!==t&&f!==e||(b=m.invMassB,x=m.invIB);const S=this.m_positions[_].c;let w=this.m_positions[_].a;const B=this.m_positions[f].c;let C=this.m_positions[f].a;for(let t=0;t<y;++t){i.q.SetAngle(w),n.q.SetAngle(C),N.SubVV(S,W.MulRV(i.q,d,N.s_t0),i.p),N.SubVV(B,W.MulRV(n.q,p,N.s_t0),n.p),r.Initialize(m,i,n,t);const e=r.normal,h=r.point,_=r.separation;N.SubVV(h,S,s),N.SubVV(h,B,o),u=P(u,_);const f=I(.75*(_+a),-c,0),y=N.CrossVV(s,e),A=N.CrossVV(o,e),V=v+b+g*y*y+x*A*A,M=V>0?-f/V:0;N.MulSV(M,e,l),S.SelfMulSub(v,l),w-=g*N.CrossVV(s,l),B.SelfMulAdd(b,l),C+=x*N.CrossVV(o,l)}this.m_positions[_].a=w,this.m_positions[f].a=C}return u>=-.012}}hn.InitializeVelocityConstraints_s_xfA=new X,hn.InitializeVelocityConstraints_s_xfB=new X,hn.InitializeVelocityConstraints_s_worldManifold=new Mt,hn.WarmStart_s_P=new N,hn.SolveVelocityConstraints_s_dv=new N,hn.SolveVelocityConstraints_s_dv1=new N,hn.SolveVelocityConstraints_s_dv2=new N,hn.SolveVelocityConstraints_s_P=new N,hn.SolveVelocityConstraints_s_a=new N,hn.SolveVelocityConstraints_s_b=new N,hn.SolveVelocityConstraints_s_x=new N,hn.SolveVelocityConstraints_s_d=new N,hn.SolveVelocityConstraints_s_P1=new N,hn.SolveVelocityConstraints_s_P2=new N,hn.SolveVelocityConstraints_s_P1P2=new N,hn.SolvePositionConstraints_s_xfA=new X,hn.SolvePositionConstraints_s_xfB=new X,hn.SolvePositionConstraints_s_psm=new cn,hn.SolvePositionConstraints_s_rA=new N,hn.SolvePositionConstraints_s_rB=new N,hn.SolvePositionConstraints_s_P=new N,hn.SolveTOIPositionConstraints_s_xfA=new X,hn.SolveTOIPositionConstraints_s_xfB=new X,hn.SolveTOIPositionConstraints_s_psm=new cn,hn.SolveTOIPositionConstraints_s_rA=new N,hn.SolveTOIPositionConstraints_s_rB=new N,hn.SolveTOIPositionConstraints_s_P=new N;class mn{constructor(){this.m_allocator=null,this.m_bodies=[],this.m_contacts=[],this.m_joints=[],this.m_positions=en.MakeArray(1024),this.m_velocities=nn.MakeArray(1024),this.m_bodyCount=0,this.m_jointCount=0,this.m_contactCount=0,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0}Initialize(t,e,i,n,r){if(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_positions.length<t){const e=M(2*this.m_positions.length,t);for(;this.m_positions.length<e;)this.m_positions[this.m_positions.length]=new en}if(this.m_velocities.length<t){const e=M(2*this.m_velocities.length,t);for(;this.m_velocities.length<e;)this.m_velocities[this.m_velocities.length]=new nn}}Clear(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}AddBody(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t}AddContact(t){this.m_contacts[this.m_contactCount++]=t}AddJoint(t){this.m_joints[this.m_jointCount++]=t}Solve(e,n,r,s){const o=mn.s_timer.Reset(),a=n.dt;for(let i=0;i<this.m_bodyCount;++i){const e=this.m_bodies[i];this.m_positions[i].c.Copy(e.m_sweep.c);const n=e.m_sweep.a,s=this.m_velocities[i].v.Copy(e.m_linearVelocity);let o=e.m_angularVelocity;e.m_sweep.c0.Copy(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_type===t.b2BodyType.b2_dynamicBody&&(s.x+=a*(e.m_gravityScale*r.x+e.m_invMass*e.m_force.x),s.y+=a*(e.m_gravityScale*r.y+e.m_invMass*e.m_force.y),o+=a*e.m_invI*e.m_torque,s.SelfMul(1/(1+a*e.m_linearDamping)),o*=1/(1+a*e.m_angularDamping)),this.m_positions[i].a=n,this.m_velocities[i].w=o}o.Reset();const l=mn.s_solverData;l.step.Copy(n),l.positions=this.m_positions,l.velocities=this.m_velocities;const u=mn.s_contactSolverDef;u.step.Copy(n),u.contacts=this.m_contacts,u.count=this.m_contactCount,u.positions=this.m_positions,u.velocities=this.m_velocities,u.allocator=this.m_allocator;const c=mn.s_contactSolver.Initialize(u);c.InitializeVelocityConstraints(),n.warmStarting&&c.WarmStart();for(let t=0;t<this.m_jointCount;++t)this.m_joints[t].InitVelocityConstraints(l);e.solveInit=o.GetMilliseconds(),o.Reset();for(let t=0;t<n.velocityIterations;++t){for(let t=0;t<this.m_jointCount;++t)this.m_joints[t].SolveVelocityConstraints(l);c.SolveVelocityConstraints()}c.StoreImpulses(),e.solveVelocity=o.GetMilliseconds();for(let t=0;t<this.m_bodyCount;++t){const e=this.m_positions[t].c;let i=this.m_positions[t].a;const n=this.m_velocities[t].v;let r=this.m_velocities[t].w;const s=N.MulSV(a,n,mn.s_translation);if(N.DotVV(s,s)>4){const t=2/s.Length();n.SelfMul(t)}const o=a*r;if(o*o>_){r*=m/V(o)}e.x+=a*n.x,e.y+=a*n.y,i+=a*r,this.m_positions[t].a=i,this.m_velocities[t].w=r}o.Reset();let h=!1;for(let t=0;t<n.positionIterations;++t){const t=c.SolvePositionConstraints();let e=!0;for(let i=0;i<this.m_jointCount;++i){const t=this.m_joints[i].SolvePositionConstraints(l);e=e&&t}if(t&&e){h=!0;break}}for(let t=0;t<this.m_bodyCount;++t){const e=this.m_bodies[t];e.m_sweep.c.Copy(this.m_positions[t].c),e.m_sweep.a=this.m_positions[t].a,e.m_linearVelocity.Copy(this.m_velocities[t].v),e.m_angularVelocity=this.m_velocities[t].w,e.SynchronizeTransform()}if(e.solvePosition=o.GetMilliseconds(),this.Report(c.m_velocityConstraints),s){let e=i;const n=v*v,r=g*g;for(let i=0;i<this.m_bodyCount;++i){const s=this.m_bodies[i];s.GetType()!==t.b2BodyType.b2_staticBody&&(!s.m_autoSleepFlag||s.m_angularVelocity*s.m_angularVelocity>r||N.DotVV(s.m_linearVelocity,s.m_linearVelocity)>n?(s.m_sleepTime=0,e=0):(s.m_sleepTime+=a,e=P(e,s.m_sleepTime)))}if(e>=.5&&h)for(let t=0;t<this.m_bodyCount;++t){this.m_bodies[t].SetAwake(!1)}}}SolveTOI(t,e,i){for(let o=0;o<this.m_bodyCount;++o){const t=this.m_bodies[o];this.m_positions[o].c.Copy(t.m_sweep.c),this.m_positions[o].a=t.m_sweep.a,this.m_velocities[o].v.Copy(t.m_linearVelocity),this.m_velocities[o].w=t.m_angularVelocity}const n=mn.s_contactSolverDef;n.contacts=this.m_contacts,n.count=this.m_contactCount,n.allocator=this.m_allocator,n.step.Copy(t),n.positions=this.m_positions,n.velocities=this.m_velocities;const r=mn.s_contactSolver.Initialize(n);for(let o=0;o<t.positionIterations;++o){if(r.SolveTOIPositionConstraints(e,i))break}this.m_bodies[e].m_sweep.c0.Copy(this.m_positions[e].c),this.m_bodies[e].m_sweep.a0=this.m_positions[e].a,this.m_bodies[i].m_sweep.c0.Copy(this.m_positions[i].c),this.m_bodies[i].m_sweep.a0=this.m_positions[i].a,r.InitializeVelocityConstraints();for(let o=0;o<t.velocityIterations;++o)r.SolveVelocityConstraints();const s=t.dt;for(let o=0;o<this.m_bodyCount;++o){const t=this.m_positions[o].c;let e=this.m_positions[o].a;const i=this.m_velocities[o].v;let n=this.m_velocities[o].w;const r=N.MulSV(s,i,mn.s_translation);if(N.DotVV(r,r)>4){const t=2/r.Length();i.SelfMul(t)}const a=s*n;if(a*a>_){n*=m/V(a)}t.SelfMulAdd(s,i),e+=s*n,this.m_positions[o].a=e,this.m_velocities[o].w=n;const l=this.m_bodies[o];l.m_sweep.c.Copy(t),l.m_sweep.a=e,l.m_linearVelocity.Copy(i),l.m_angularVelocity=n,l.SynchronizeTransform()}this.Report(r.m_velocityConstraints)}Report(t){if(null!==this.m_listener)for(let e=0;e<this.m_contactCount;++e){const i=this.m_contacts[e];if(!i)continue;const n=t[e],r=mn.s_impulse;r.count=n.pointCount;for(let t=0;t<n.pointCount;++t)r.normalImpulses[t]=n.points[t].normalImpulse,r.tangentImpulses[t]=n.points[t].tangentImpulse;this.m_listener.PostSolve(i,r)}}}var _n,fn,dn;mn.s_timer=new $,mn.s_solverData=new rn,mn.s_contactSolverDef=new un,mn.s_contactSolver=new hn,mn.s_translation=new N,mn.s_impulse=new Zi,(_n=t.b2ParticleFlag||(t.b2ParticleFlag={}))[_n.b2_waterParticle=0]="b2_waterParticle",_n[_n.b2_zombieParticle=2]="b2_zombieParticle",_n[_n.b2_wallParticle=4]="b2_wallParticle",_n[_n.b2_springParticle=8]="b2_springParticle",_n[_n.b2_elasticParticle=16]="b2_elasticParticle",_n[_n.b2_viscousParticle=32]="b2_viscousParticle",_n[_n.b2_powderParticle=64]="b2_powderParticle",_n[_n.b2_tensileParticle=128]="b2_tensileParticle",_n[_n.b2_colorMixingParticle=256]="b2_colorMixingParticle",_n[_n.b2_destructionListenerParticle=512]="b2_destructionListenerParticle",_n[_n.b2_barrierParticle=1024]="b2_barrierParticle",_n[_n.b2_staticPressureParticle=2048]="b2_staticPressureParticle",_n[_n.b2_reactiveParticle=4096]="b2_reactiveParticle",_n[_n.b2_repulsiveParticle=8192]="b2_repulsiveParticle",_n[_n.b2_fixtureContactListenerParticle=16384]="b2_fixtureContactListenerParticle",_n[_n.b2_particleContactListenerParticle=32768]="b2_particleContactListenerParticle",_n[_n.b2_fixtureContactFilterParticle=65536]="b2_fixtureContactFilterParticle",_n[_n.b2_particleContactFilterParticle=131072]="b2_particleContactFilterParticle";class pn{constructor(){this.flags=0,this.position=new N,this.velocity=new N,this.color=new Z(0,0,0,0),this.lifetime=0,this.userData=null,this.group=null}}function yn(t,e,i){return I(Math.ceil(Math.sqrt(t/(.01*e))*i),1,8)}class vn{constructor(){this.m_index=f}GetIndex(){return this.m_index}SetIndex(t){this.m_index=t}}(fn=t.b2ParticleGroupFlag||(t.b2ParticleGroupFlag={}))[fn.b2_solidParticleGroup=1]="b2_solidParticleGroup",fn[fn.b2_rigidParticleGroup=2]="b2_rigidParticleGroup",fn[fn.b2_particleGroupCanBeEmpty=4]="b2_particleGroupCanBeEmpty",fn[fn.b2_particleGroupWillBeDestroyed=8]="b2_particleGroupWillBeDestroyed",fn[fn.b2_particleGroupNeedsUpdateDepth=16]="b2_particleGroupNeedsUpdateDepth",fn[fn.b2_particleGroupInternalMask=24]="b2_particleGroupInternalMask";class gn{constructor(){this.flags=0,this.groupFlags=0,this.position=new N,this.angle=0,this.linearVelocity=new N,this.angularVelocity=0,this.color=new Z,this.strength=1,this.shapeCount=0,this.stride=0,this.particleCount=0,this.lifetime=0,this.userData=null,this.group=null}}class bn{constructor(t){this.m_firstIndex=0,this.m_lastIndex=0,this.m_groupFlags=0,this.m_strength=1,this.m_prev=null,this.m_next=null,this.m_timestamp=-1,this.m_mass=0,this.m_inertia=0,this.m_center=new N,this.m_linearVelocity=new N,this.m_angularVelocity=0,this.m_transform=new X,this.m_userData=null,this.m_system=t}GetNext(){return this.m_next}GetParticleSystem(){return this.m_system}GetParticleCount(){return this.m_lastIndex-this.m_firstIndex}GetBufferIndex(){return this.m_firstIndex}ContainsParticle(t){return this.m_firstIndex<=t&&t<this.m_lastIndex}GetAllParticleFlags(){if(!this.m_system.m_flagsBuffer.data)throw new Error;let t=0;for(let e=this.m_firstIndex;e<this.m_lastIndex;e++)t|=this.m_system.m_flagsBuffer.data[e];return t}GetGroupFlags(){return this.m_groupFlags}SetGroupFlags(e){e|=this.m_groupFlags&t.b2ParticleGroupFlag.b2_particleGroupInternalMask,this.m_system.SetGroupFlags(this,e)}GetMass(){return this.UpdateStatistics(),this.m_mass}GetInertia(){return this.UpdateStatistics(),this.m_inertia}GetCenter(){return this.UpdateStatistics(),this.m_center}GetLinearVelocity(){return this.UpdateStatistics(),this.m_linearVelocity}GetAngularVelocity(){return this.UpdateStatistics(),this.m_angularVelocity}GetTransform(){return this.m_transform}GetPosition(){return this.m_transform.p}GetAngle(){return this.m_transform.q.GetAngle()}GetLinearVelocityFromWorldPoint(t,e){const i=bn.GetLinearVelocityFromWorldPoint_s_t0;return this.UpdateStatistics(),N.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,N.SubVV(t,this.m_center,i),e)}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}ApplyForce(t){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,t)}ApplyLinearImpulse(t){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,t)}DestroyParticles(t){if(this.m_system.m_world.IsLocked())throw new Error;for(let e=this.m_firstIndex;e<this.m_lastIndex;e++)this.m_system.DestroyParticle(e,t)}UpdateStatistics(){if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;const t=new N,e=new N;if(this.m_timestamp!==this.m_system.m_timestamp){const i=this.m_system.GetParticleMass();this.m_mass=i*(this.m_lastIndex-this.m_firstIndex),this.m_center.SetZero(),this.m_linearVelocity.SetZero();for(let t=this.m_firstIndex;t<this.m_lastIndex;t++)this.m_center.SelfMulAdd(i,this.m_system.m_positionBuffer.data[t]),this.m_linearVelocity.SelfMulAdd(i,this.m_system.m_velocityBuffer.data[t]);if(this.m_mass>0){const t=1/this.m_mass;this.m_center.SelfMul(t),this.m_linearVelocity.SelfMul(t)}this.m_inertia=0,this.m_angularVelocity=0;for(let n=this.m_firstIndex;n<this.m_lastIndex;n++)N.SubVV(this.m_system.m_positionBuffer.data[n],this.m_center,t),N.SubVV(this.m_system.m_velocityBuffer.data[n],this.m_linearVelocity,e),this.m_inertia+=i*N.DotVV(t,t),this.m_angularVelocity+=i*N.CrossVV(t,e);this.m_inertia>0&&(this.m_angularVelocity*=1/this.m_inertia),this.m_timestamp=this.m_system.m_timestamp}}}bn.GetLinearVelocityFromWorldPoint_s_t0=new N;class xn{constructor(t){this.m_front=0,this.m_back=0,this.m_capacity=0,this.m_buffer=S(t,(t=>null)),this.m_capacity=t}Push(t){if(this.m_back>=this.m_capacity){for(let t=this.m_front;t<this.m_back;t++)this.m_buffer[t-this.m_front]=this.m_buffer[t];this.m_back-=this.m_front,this.m_front=0,this.m_back>=this.m_capacity&&(this.m_capacity>0?(this.m_buffer.concat(S(this.m_capacity,(t=>null))),this.m_capacity*=2):(this.m_buffer.concat(S(1,(t=>null))),this.m_capacity=1))}this.m_buffer[this.m_back]=t,this.m_back++}Pop(){this.m_buffer[this.m_front]=null,this.m_front++}Empty(){return this.m_front===this.m_back}Front(){const t=this.m_buffer[this.m_front];if(!t)throw new Error;return t}}class Sn{constructor(t){this.m_generatorCapacity=0,this.m_generatorCount=0,this.m_countX=0,this.m_countY=0,this.m_diagram=[],this.m_generatorBuffer=S(t,(t=>new Sn.Generator)),this.m_generatorCapacity=t}AddGenerator(t,e,i){const n=this.m_generatorBuffer[this.m_generatorCount++];n.center.Copy(t),n.tag=e,n.necessary=i}Generate(t,e){const n=1/t,r=new N(+i,+i),s=new N(-i,-i);let o=0;for(let i=0;i<this.m_generatorCount;i++){const t=this.m_generatorBuffer[i];t.necessary&&(N.MinV(r,t.center,r),N.MaxV(s,t.center,s),++o)}if(0===o)return this.m_countX=0,void(this.m_countY=0);r.x-=e,r.y-=e,s.x+=e,s.y+=e,this.m_countX=1+Math.floor(n*(s.x-r.x)),this.m_countY=1+Math.floor(n*(s.y-r.y)),this.m_diagram=[];const a=new xn(4*this.m_countX*this.m_countY);for(let i=0;i<this.m_generatorCount;i++){const t=this.m_generatorBuffer[i];t.center.SelfSub(r).SelfMul(n);const e=Math.floor(t.center.x),s=Math.floor(t.center.y);e>=0&&s>=0&&e<this.m_countX&&s<this.m_countY&&a.Push(new Sn.Task(e,s,e+s*this.m_countX,t))}for(;!a.Empty();){const t=a.Front(),e=t.m_x,i=t.m_y,n=t.m_i,r=t.m_generator;a.Pop(),this.m_diagram[n]||(this.m_diagram[n]=r,e>0&&a.Push(new Sn.Task(e-1,i,n-1,r)),i>0&&a.Push(new Sn.Task(e,i-1,n-this.m_countX,r)),e<this.m_countX-1&&a.Push(new Sn.Task(e+1,i,n+1,r)),i<this.m_countY-1&&a.Push(new Sn.Task(e,i+1,n+this.m_countX,r)))}for(let i=0;i<this.m_countY;i++)for(let t=0;t<this.m_countX-1;t++){const e=t+i*this.m_countX,n=this.m_diagram[e],r=this.m_diagram[e+1];n!==r&&(a.Push(new Sn.Task(t,i,e,r)),a.Push(new Sn.Task(t+1,i,e+1,n)))}for(let i=0;i<this.m_countY-1;i++)for(let t=0;t<this.m_countX;t++){const e=t+i*this.m_countX,n=this.m_diagram[e],r=this.m_diagram[e+this.m_countX];n!==r&&(a.Push(new Sn.Task(t,i,e,r)),a.Push(new Sn.Task(t,i+1,e+this.m_countX,n)))}for(;!a.Empty();){const t=a.Front(),e=t.m_x,i=t.m_y,n=t.m_i,r=t.m_generator;a.Pop();const s=this.m_diagram[n],o=r;if(s!==o){const t=s.center.x-e,r=s.center.y-i,l=o.center.x-e,u=o.center.y-i;t*t+r*r>l*l+u*u&&(this.m_diagram[n]=o,e>0&&a.Push(new Sn.Task(e-1,i,n-1,o)),i>0&&a.Push(new Sn.Task(e,i-1,n-this.m_countX,o)),e<this.m_countX-1&&a.Push(new Sn.Task(e+1,i,n+1,o)),i<this.m_countY-1&&a.Push(new Sn.Task(e,i+1,n+this.m_countX,o)))}}}GetNodes(t){for(let e=0;e<this.m_countY-1;e++)for(let i=0;i<this.m_countX-1;i++){const n=i+e*this.m_countX,r=this.m_diagram[n],s=this.m_diagram[n+1],o=this.m_diagram[n+this.m_countX],a=this.m_diagram[n+1+this.m_countX];s!==o&&(r!==s&&r!==o&&(r.necessary||s.necessary||o.necessary)&&t(r.tag,s.tag,o.tag),a!==s&&a!==o&&(r.necessary||s.necessary||o.necessary)&&t(s.tag,a.tag,o.tag))}}}function wn(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function Bn(t,e){return t<e}function Cn(t,e=0,i=t.length-e,n=Bn){let r=e;const s=[];let o=0;for(;;){for(;r+1<i;i++){const e=t[r+Math.floor(Math.random()*(i-r))];s[o++]=i;for(let s=r-1;;){for(;n(t[++s],e););for(;n(e,t[--i]););if(s>=i)break;wn(t,s,i)}}if(0===o)break;r=i,i=s[--o]}return t}function An(t,e=0,i=t.length-e,n=Bn){return Cn(t,e,i,n)}function Vn(t,e,i=t.length){let n=0;for(let r=0;r<i;++r)e(t[r])||(r!==n?wn(t,n++,r):++n);return n}function Pn(t,e,i,n,r){let s=i-e;for(;s>0;){const i=Math.floor(s/2);let o=e+i;r(t[o],n)?(e=++o,s-=i+1):s=i}return e}function Mn(t,e,i,n,r){let s=i-e;for(;s>0;){const i=Math.floor(s/2);let o=e+i;r(n,t[o])?s=i:(e=++o,s-=i+1)}return e}function In(t,e,i,n){let r=i;for(;e!==r;)wn(t,e++,r++),r===n?r=i:e===i&&(i=r)}(dn=Sn||(Sn={})).Generator=class{constructor(){this.center=new N,this.tag=0,this.necessary=!1}},dn.Task=class{constructor(t,e,i,n){this.m_x=t,this.m_y=e,this.m_i=i,this.m_generator=n}};class kn{constructor(t){this.data=[],this.count=0,this.capacity=0,this.allocator=t}Append(){return this.count>=this.capacity&&this.Grow(),this.count++}Reserve(t){if(!(this.capacity>=t)){for(let e=this.capacity;e<t;++e)this.data[e]=this.allocator();this.capacity=t}}Grow(){const t=this.capacity?2*this.capacity:y;this.Reserve(t)}Free(){0!==this.data.length&&(this.data=[],this.capacity=0,this.count=0)}Shorten(t){}Data(){return this.data}GetCount(){return this.count}SetCount(t){this.count=t}GetCapacity(){return this.capacity}RemoveIf(t){this.count=Vn(this.data,t,this.count)}Unique(t){this.count=function(t,e,i,n){if(e===i)return i;let r=e;for(;++e!==i;)n(t[r],t[e])||wn(t,++r,e);return++r}(this.data,0,this.count,t)}}class Dn extends $i{constructor(t){super(),this.m_system=t}ShouldQueryParticleSystem(t){return!1}ReportFixture(t){if(t.IsSensor())return!0;const e=t.GetShape().GetChildCount();for(let i=0;i<e;i++){const e=t.GetAABB(i),n=this.m_system.GetInsideBoundsEnumerator(e);let r;for(;(r=n.GetNext())>=0;)this.ReportFixtureAndParticle(t,i,r)}return!0}ReportParticle(t,e){return!1}ReportFixtureAndParticle(t,e,i){}}class Gn{constructor(){this.indexA=0,this.indexB=0,this.weight=0,this.normal=new N,this.flags=0}SetIndices(t,e){this.indexA=t,this.indexB=e}SetWeight(t){this.weight=t}SetNormal(t){this.normal.Copy(t)}SetFlags(t){this.flags=t}GetIndexA(){return this.indexA}GetIndexB(){return this.indexB}GetWeight(){return this.weight}GetNormal(){return this.normal}GetFlags(){return this.flags}IsEqual(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&this.weight===t.weight&&this.normal.x===t.normal.x&&this.normal.y===t.normal.y}IsNotEqual(t){return!this.IsEqual(t)}ApproximatelyEqual(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&V(this.weight-t.weight)<.01&&N.DistanceSquaredVV(this.normal,t.normal)<1e-4}}class Tn{constructor(){this.index=0,this.weight=0,this.normal=new N,this.mass=0}}class Fn{constructor(){this.indexA=0,this.indexB=0,this.flags=0,this.strength=0,this.distance=0}}class Ln{constructor(){this.indexA=0,this.indexB=0,this.indexC=0,this.flags=0,this.strength=0,this.pa=new N(0,0),this.pb=new N(0,0),this.pc=new N(0,0),this.ka=0,this.kb=0,this.kc=0,this.s=0}}class Rn{constructor(){this.strictContactCheck=!1,this.density=1,this.gravityScale=1,this.radius=1,this.maxCount=0,this.pressureStrength=.005,this.dampingStrength=1,this.elasticStrength=.25,this.springStrength=.25,this.viscousStrength=.25,this.surfaceTensionPressureStrength=.2,this.surfaceTensionNormalStrength=.2,this.repulsiveStrength=1,this.powderStrength=.5,this.ejectionStrength=.5,this.staticPressureStrength=.2,this.staticPressureRelaxation=.2,this.staticPressureIterations=8,this.colorMixingStrength=.5,this.destroyByAge=!0,this.lifetimeGranularity=1/60}Copy(t){return this.strictContactCheck=t.strictContactCheck,this.density=t.density,this.gravityScale=t.gravityScale,this.radius=t.radius,this.maxCount=t.maxCount,this.pressureStrength=t.pressureStrength,this.dampingStrength=t.dampingStrength,this.elasticStrength=t.elasticStrength,this.springStrength=t.springStrength,this.viscousStrength=t.viscousStrength,this.surfaceTensionPressureStrength=t.surfaceTensionPressureStrength,this.surfaceTensionNormalStrength=t.surfaceTensionNormalStrength,this.repulsiveStrength=t.repulsiveStrength,this.powderStrength=t.powderStrength,this.ejectionStrength=t.ejectionStrength,this.staticPressureStrength=t.staticPressureStrength,this.staticPressureRelaxation=t.staticPressureRelaxation,this.staticPressureIterations=t.staticPressureIterations,this.colorMixingStrength=t.colorMixingStrength,this.destroyByAge=t.destroyByAge,this.lifetimeGranularity=t.lifetimeGranularity,this}Clone(){return(new Rn).Copy(this)}}class En{constructor(t,e){this.m_paused=!1,this.m_timestamp=0,this.m_allParticleFlags=0,this.m_needsUpdateAllParticleFlags=!1,this.m_allGroupFlags=0,this.m_needsUpdateAllGroupFlags=!1,this.m_hasForce=!1,this.m_iterationIndex=0,this.m_inverseDensity=0,this.m_particleDiameter=0,this.m_inverseDiameter=0,this.m_squaredDiameter=0,this.m_count=0,this.m_internalAllocatedCapacity=0,this.m_handleIndexBuffer=new En.UserOverridableBuffer,this.m_flagsBuffer=new En.UserOverridableBuffer,this.m_positionBuffer=new En.UserOverridableBuffer,this.m_velocityBuffer=new En.UserOverridableBuffer,this.m_forceBuffer=[],this.m_weightBuffer=[],this.m_staticPressureBuffer=[],this.m_accumulationBuffer=[],this.m_accumulation2Buffer=[],this.m_depthBuffer=[],this.m_colorBuffer=new En.UserOverridableBuffer,this.m_groupBuffer=[],this.m_userDataBuffer=new En.UserOverridableBuffer,this.m_stuckThreshold=0,this.m_lastBodyContactStepBuffer=new En.UserOverridableBuffer,this.m_bodyContactCountBuffer=new En.UserOverridableBuffer,this.m_consecutiveContactStepsBuffer=new En.UserOverridableBuffer,this.m_stuckParticleBuffer=new kn((()=>0)),this.m_proxyBuffer=new kn((()=>new En.Proxy)),this.m_contactBuffer=new kn((()=>new Gn)),this.m_bodyContactBuffer=new kn((()=>new Tn)),this.m_pairBuffer=new kn((()=>new Fn)),this.m_triadBuffer=new kn((()=>new Ln)),this.m_expirationTimeBuffer=new En.UserOverridableBuffer,this.m_indexByExpirationTimeBuffer=new En.UserOverridableBuffer,this.m_timeElapsed=0,this.m_expirationTimeBufferRequiresSorting=!1,this.m_groupCount=0,this.m_groupList=null,this.m_def=new Rn,this.m_prev=null,this.m_next=null,this.SetStrictContactCheck(t.strictContactCheck),this.SetDensity(t.density),this.SetGravityScale(t.gravityScale),this.SetRadius(t.radius),this.SetMaxParticleCount(t.maxCount),this.m_def=t.Clone(),this.m_world=e,this.SetDestructionByAge(this.m_def.destroyByAge)}static computeTag(t,e){return(e+En.yOffset>>>0<<En.yShift)+(En.xScale*t+En.xOffset>>>0)>>>0}static computeRelativeTag(t,e,i){return t+(i<<En.yShift)+(e<<En.xShift)>>>0}Drop(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer),this.FreeUserOverridableBuffer(this.m_flagsBuffer),this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer),this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer),this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer),this.FreeUserOverridableBuffer(this.m_positionBuffer),this.FreeUserOverridableBuffer(this.m_velocityBuffer),this.FreeUserOverridableBuffer(this.m_colorBuffer),this.FreeUserOverridableBuffer(this.m_userDataBuffer),this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer),this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer),this.FreeBuffer(this.m_forceBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_weightBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_staticPressureBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulationBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulation2Buffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_depthBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_groupBuffer,this.m_internalAllocatedCapacity)}CreateParticle(t){if(this.m_world.IsLocked())throw new Error;if(this.m_count>=this.m_internalAllocatedCapacity){const t=this.m_count?2*this.m_count:y;this.ReallocateInternalAllocatedBuffers(t)}if(this.m_count>=this.m_internalAllocatedCapacity){if(!this.m_def.destroyByAge)return f;this.DestroyOldestParticle(0,!1),this.SolveZombie()}const i=this.m_count++;if(!this.m_flagsBuffer.data)throw new Error;if(this.m_flagsBuffer.data[i]=0,this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[i]=0),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[i]=0),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[i]=0),!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;this.m_positionBuffer.data[i]=(this.m_positionBuffer.data[i]||new N).Copy(e(t.position,N.ZERO)),this.m_velocityBuffer.data[i]=(this.m_velocityBuffer.data[i]||new N).Copy(e(t.velocity,N.ZERO)),this.m_weightBuffer[i]=0,this.m_forceBuffer[i]=(this.m_forceBuffer[i]||new N).SetZero(),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[i]=0),this.m_depthBuffer&&(this.m_depthBuffer[i]=0);const n=(new Z).Copy(e(t.color,Z.ZERO));!this.m_colorBuffer.data&&n.IsZero()||(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[i]=(this.m_colorBuffer.data[i]||new Z).Copy(n)),(this.m_userDataBuffer.data||t.userData)&&(this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[i]=t.userData),this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[i]=null);const r=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],s=e(t.lifetime,0),o=s>0;if(this.m_expirationTimeBuffer.data||o){if(this.SetParticleLifetime(i,o?s:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),!this.m_indexByExpirationTimeBuffer.data)throw new Error;this.m_indexByExpirationTimeBuffer.data[i]=i}r.index=i;const a=e(t.group,null);return this.m_groupBuffer[i]=a,a&&(a.m_firstIndex<a.m_lastIndex?(this.RotateBuffer(a.m_firstIndex,a.m_lastIndex,i),a.m_lastIndex=i+1):(a.m_firstIndex=i,a.m_lastIndex=i+1)),this.SetParticleFlags(i,e(t.flags,0)),i}GetParticleHandleFromIndex(t){this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);let e=this.m_handleIndexBuffer.data[t];return e||((e=new vn).SetIndex(t),this.m_handleIndexBuffer.data[t]=e,e)}DestroyParticle(e,i=!1){if(!this.m_flagsBuffer.data)throw new Error;let n=t.b2ParticleFlag.b2_zombieParticle;i&&(n|=t.b2ParticleFlag.b2_destructionListenerParticle),this.SetParticleFlags(e,this.m_flagsBuffer.data[e]|n)}DestroyOldestParticle(t,e=!1){const i=this.GetParticleCount();if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;if(!this.m_expirationTimeBuffer.data)throw new Error;const n=this.m_indexByExpirationTimeBuffer.data[i-(t+1)],r=this.m_indexByExpirationTimeBuffer.data[t];this.DestroyParticle(this.m_expirationTimeBuffer.data[n]>0?n:r,e)}DestroyParticlesInShape(t,e,i=!1){const n=En.DestroyParticlesInShape_s_aabb;if(this.m_world.IsLocked())throw new Error;const r=new En.DestroyParticlesInShapeCallback(this,t,e,i),s=n;return t.ComputeAABB(s,e,0),this.m_world.QueryAABB(r,s),r.Destroyed()}CreateParticleGroup(t){const i=En.CreateParticleGroup_s_transform;if(this.m_world.IsLocked())throw new Error;const n=i;n.SetPositionAngle(e(t.position,N.ZERO),e(t.angle,0));const r=this.m_count;if(t.shape&&this.CreateParticlesWithShapeForGroup(t.shape,t,n),t.shapes&&this.CreateParticlesWithShapesForGroup(t.shapes,e(t.shapeCount,t.shapes.length),t,n),t.positionData){const i=e(t.particleCount,t.positionData.length);for(let e=0;e<i;e++){const i=t.positionData[e];this.CreateParticleForGroup(t,n,i)}}const s=this.m_count;let o=new bn(this);o.m_firstIndex=r,o.m_lastIndex=s,o.m_strength=e(t.strength,1),o.m_userData=t.userData,o.m_transform.Copy(n),o.m_prev=null,o.m_next=this.m_groupList,this.m_groupList&&(this.m_groupList.m_prev=o),this.m_groupList=o,++this.m_groupCount;for(let e=r;e<s;e++)this.m_groupBuffer[e]=o;this.SetGroupFlags(o,e(t.groupFlags,0));const a=new En.ConnectionFilter;return this.UpdateContacts(!0),this.UpdatePairsAndTriads(r,s,a),t.group&&(this.JoinParticleGroups(t.group,o),o=t.group),o}JoinParticleGroups(t,e){if(this.m_world.IsLocked())throw new Error;this.RotateBuffer(e.m_firstIndex,e.m_lastIndex,this.m_count),this.RotateBuffer(t.m_firstIndex,t.m_lastIndex,e.m_firstIndex);const i=new En.JoinParticleGroupsFilter(e.m_firstIndex);this.UpdateContacts(!0),this.UpdatePairsAndTriads(t.m_firstIndex,e.m_lastIndex,i);for(let r=e.m_firstIndex;r<e.m_lastIndex;r++)this.m_groupBuffer[r]=t;const n=t.m_groupFlags|e.m_groupFlags;this.SetGroupFlags(t,n),t.m_lastIndex=e.m_lastIndex,e.m_firstIndex=e.m_lastIndex,this.DestroyParticleGroup(e)}SplitParticleGroup(t){this.UpdateContacts(!0);const e=S(t.GetParticleCount(),(t=>new En.ParticleListNode));En.InitializeParticleLists(t,e),this.MergeParticleListsInContact(t,e);const i=En.FindLongestParticleList(t,e);this.MergeZombieParticleListNodes(t,e,i),this.CreateParticleGroupsFromParticleList(t,e,i),this.UpdatePairsAndTriadsWithParticleList(t,e)}GetParticleGroupList(){return this.m_groupList}GetParticleGroupCount(){return this.m_groupCount}GetParticleCount(){return this.m_count}GetMaxParticleCount(){return this.m_def.maxCount}SetMaxParticleCount(t){this.m_def.maxCount=t}GetAllParticleFlags(){return this.m_allParticleFlags}GetAllGroupFlags(){return this.m_allGroupFlags}SetPaused(t){this.m_paused=t}GetPaused(){return this.m_paused}SetDensity(t){this.m_def.density=t,this.m_inverseDensity=1/this.m_def.density}GetDensity(){return this.m_def.density}SetGravityScale(t){this.m_def.gravityScale=t}GetGravityScale(){return this.m_def.gravityScale}SetDamping(t){this.m_def.dampingStrength=t}GetDamping(){return this.m_def.dampingStrength}SetStaticPressureIterations(t){this.m_def.staticPressureIterations=t}GetStaticPressureIterations(){return this.m_def.staticPressureIterations}SetRadius(t){this.m_particleDiameter=2*t,this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter,this.m_inverseDiameter=1/this.m_particleDiameter}GetRadius(){return this.m_particleDiameter/2}GetPositionBuffer(){if(!this.m_positionBuffer.data)throw new Error;return this.m_positionBuffer.data}GetVelocityBuffer(){if(!this.m_velocityBuffer.data)throw new Error;return this.m_velocityBuffer.data}GetColorBuffer(){return this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data}GetGroupBuffer(){return this.m_groupBuffer}GetWeightBuffer(){return this.m_weightBuffer}GetUserDataBuffer(){return this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data}GetFlagsBuffer(){if(!this.m_flagsBuffer.data)throw new Error;return this.m_flagsBuffer.data}SetParticleFlags(e,i){if(!this.m_flagsBuffer.data)throw new Error;this.m_flagsBuffer.data[e]&~i&&(this.m_needsUpdateAllParticleFlags=!0),~this.m_allParticleFlags&i&&(i&t.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),i&t.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=i),this.m_flagsBuffer.data[e]=i}GetParticleFlags(t){if(!this.m_flagsBuffer.data)throw new Error;return this.m_flagsBuffer.data[t]}SetFlagsBuffer(t,e){this.SetUserOverridableBuffer(this.m_flagsBuffer,t,e)}SetPositionBuffer(t,e){this.SetUserOverridableBuffer(this.m_positionBuffer,t,e)}SetVelocityBuffer(t,e){this.SetUserOverridableBuffer(this.m_velocityBuffer,t,e)}SetColorBuffer(t,e){this.SetUserOverridableBuffer(this.m_colorBuffer,t,e)}SetUserDataBuffer(t,e){this.SetUserOverridableBuffer(this.m_userDataBuffer,t,e)}GetContacts(){return this.m_contactBuffer.data}GetContactCount(){return this.m_contactBuffer.count}GetBodyContacts(){return this.m_bodyContactBuffer.data}GetBodyContactCount(){return this.m_bodyContactBuffer.count}GetPairs(){return this.m_pairBuffer.data}GetPairCount(){return this.m_pairBuffer.count}GetTriads(){return this.m_triadBuffer.data}GetTriadCount(){return this.m_triadBuffer.count}SetStuckThreshold(t){this.m_stuckThreshold=t,t>0&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))}GetStuckCandidates(){return this.m_stuckParticleBuffer.Data()}GetStuckCandidateCount(){return this.m_stuckParticleBuffer.GetCount()}ComputeCollisionEnergy(){if(!this.m_velocityBuffer.data)throw new Error;const t=En.ComputeCollisionEnergy_s_v,e=this.m_velocityBuffer.data;let i=0;for(let n=0;n<this.m_contactBuffer.count;n++){const r=this.m_contactBuffer.data[n],s=r.indexA,o=r.indexB,a=r.normal,l=N.SubVV(e[o],e[s],t),u=N.DotVV(l,a);u<0&&(i+=u*u)}return.5*this.GetParticleMass()*i}SetStrictContactCheck(t){this.m_def.strictContactCheck=t}GetStrictContactCheck(){return this.m_def.strictContactCheck}SetParticleLifetime(t,e){const i=null===this.m_indexByExpirationTimeBuffer.data;if(this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),i){const t=this.GetParticleCount();for(let e=0;e<t;++e)this.m_indexByExpirationTimeBuffer.data[e]=e}const n=e/this.m_def.lifetimeGranularity,r=n>0?this.GetQuantizedTimeElapsed()+n:n;r!==this.m_expirationTimeBuffer.data[t]&&(this.m_expirationTimeBuffer.data[t]=r,this.m_expirationTimeBufferRequiresSorting=!0)}GetParticleLifetime(t){return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[t])}SetDestructionByAge(t){t&&this.GetExpirationTimeBuffer(),this.m_def.destroyByAge=t}GetDestructionByAge(){return this.m_def.destroyByAge}GetExpirationTimeBuffer(){return this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_expirationTimeBuffer.data}ExpirationTimeToLifetime(t){return(t>0?t-this.GetQuantizedTimeElapsed():t)*this.m_def.lifetimeGranularity}GetIndexByExpirationTimeBuffer(){if(this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),!this.m_indexByExpirationTimeBuffer.data)throw new Error;return this.m_indexByExpirationTimeBuffer.data}ParticleApplyLinearImpulse(t,e){this.ApplyLinearImpulse(t,t+1,e)}ApplyLinearImpulse(t,e,i){if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_velocityBuffer.data,r=(e-t)*this.GetParticleMass(),s=(new N).Copy(i).SelfMul(1/r);for(let o=t;o<e;o++)n[o].SelfAdd(s)}static IsSignificantForce(t){return 0!==t.x||0!==t.y}ParticleApplyForce(t,e){if(!this.m_flagsBuffer.data)throw new Error;En.IsSignificantForce(e)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[t])&&(this.PrepareForceBuffer(),this.m_forceBuffer[t].SelfAdd(e))}ApplyForce(t,e,i){const n=(new N).Copy(i).SelfMul(1/(e-t));if(En.IsSignificantForce(n)){this.PrepareForceBuffer();for(let i=t;i<e;i++)this.m_forceBuffer[i].SelfAdd(n)}}GetNext(){return this.m_next}QueryAABB(t,e){if(0===this.m_proxyBuffer.count)return;const i=this.m_proxyBuffer.count,n=Pn(this.m_proxyBuffer.data,0,i,En.computeTag(this.m_inverseDiameter*e.lowerBound.x,this.m_inverseDiameter*e.lowerBound.y),En.Proxy.CompareProxyTag),r=Mn(this.m_proxyBuffer.data,n,i,En.computeTag(this.m_inverseDiameter*e.upperBound.x,this.m_inverseDiameter*e.upperBound.y),En.Proxy.CompareTagProxy);if(!this.m_positionBuffer.data)throw new Error;const s=this.m_positionBuffer.data;for(let o=n;o<r;++o){const i=this.m_proxyBuffer.data[o].index,n=s[i];if(e.lowerBound.x<n.x&&n.x<e.upperBound.x&&e.lowerBound.y<n.y&&n.y<e.upperBound.y&&!t.ReportParticle(this,i))break}}QueryShapeAABB(t,e,i,n=0){const r=En.QueryShapeAABB_s_aabb;e.ComputeAABB(r,i,n),this.QueryAABB(t,r)}QueryPointAABB(t,e,i=a){const n=En.QueryPointAABB_s_aabb;n.lowerBound.Set(e.x-i,e.y-i),n.upperBound.Set(e.x+i,e.y+i),this.QueryAABB(t,n)}RayCast(t,e,i){const n=En.RayCast_s_aabb,r=En.RayCast_s_p,s=En.RayCast_s_v,o=En.RayCast_s_n,a=En.RayCast_s_point;if(0===this.m_proxyBuffer.count)return;if(!this.m_positionBuffer.data)throw new Error;const l=this.m_positionBuffer.data,u=n;N.MinV(e,i,u.lowerBound),N.MaxV(e,i,u.upperBound);let c=1;const h=N.SubVV(i,e,s),m=N.DotVV(h,h),_=this.GetInsideBoundsEnumerator(u);let f;for(;(f=_.GetNext())>=0;){const i=N.SubVV(e,l[f],r),n=N.DotVV(i,h),s=n*n-m*(N.DotVV(i,i)-this.m_squaredDiameter);if(s>=0){const r=T(s);let l=(-n-r)/m;if(l>c)continue;if(l<0&&((l=(-n+r)/m)<0||l>c))continue;const u=N.AddVMulSV(i,l,h,o);u.Normalize();const _=t.ReportParticle(this,f,N.AddVMulSV(e,l,h,a),u,l);if((c=P(c,_))<=0)break}}}ComputeAABB(t){const e=this.GetParticleCount();if(t.lowerBound.x=+i,t.lowerBound.y=+i,t.upperBound.x=-i,t.upperBound.y=-i,!this.m_positionBuffer.data)throw new Error;const n=this.m_positionBuffer.data;for(let i=0;i<e;i++){const e=n[i];N.MinV(t.lowerBound,e,t.lowerBound),N.MaxV(t.upperBound,e,t.upperBound)}t.lowerBound.x-=this.m_particleDiameter,t.lowerBound.y-=this.m_particleDiameter,t.upperBound.x+=this.m_particleDiameter,t.upperBound.y+=this.m_particleDiameter}FreeBuffer(t,e){null!==t&&(t.length=0)}FreeUserOverridableBuffer(t){0===t.userSuppliedCapacity&&this.FreeBuffer(t.data,this.m_internalAllocatedCapacity)}ReallocateBuffer3(t,e,i){if(i<=e)throw new Error;const n=t?t.slice():[];return n.length=i,n}ReallocateBuffer5(t,e,i,n,r){if(n<=i)throw new Error;if(e&&!(n<=e))throw new Error;return r&&!t||e||(t=this.ReallocateBuffer3(t,i,n)),t}ReallocateBuffer4(t,e,i,n){return this.ReallocateBuffer5(t.data,t.userSuppliedCapacity,e,i,n)}RequestBuffer(t){return t||(0===this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(y),(t=[]).length=this.m_internalAllocatedCapacity),t}ReallocateHandleBuffers(t){this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,t,!0)}ReallocateInternalAllocatedBuffers(t){function e(t,e){return e&&t>e?e:t}if(t=e(t,this.m_def.maxCount),t=e(t,this.m_flagsBuffer.userSuppliedCapacity),t=e(t,this.m_positionBuffer.userSuppliedCapacity),t=e(t,this.m_velocityBuffer.userSuppliedCapacity),t=e(t,this.m_colorBuffer.userSuppliedCapacity),t=e(t,this.m_userDataBuffer.userSuppliedCapacity),this.m_internalAllocatedCapacity<t){this.ReallocateHandleBuffers(t),this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,this.m_internalAllocatedCapacity,t,!1);const e=this.m_stuckThreshold>0;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,t,e),this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,t,e),this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,t,e),this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_accumulationBuffer=this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_internalAllocatedCapacity=t}}CreateParticleForGroup(t,i,n){const r=new pn;r.flags=e(t.flags,0),X.MulXV(i,n,r.position),N.AddVV(e(t.linearVelocity,N.ZERO),N.CrossSV(e(t.angularVelocity,0),N.SubVV(r.position,e(t.position,N.ZERO),N.s_t0),N.s_t0),r.velocity),r.color.Copy(e(t.color,Z.ZERO)),r.lifetime=e(t.lifetime,0),r.userData=t.userData,this.CreateParticle(r)}CreateParticlesStrokeShapeForGroup(i,n,r){const s=En.CreateParticlesStrokeShapeForGroup_s_edge,o=En.CreateParticlesStrokeShapeForGroup_s_d,a=En.CreateParticlesStrokeShapeForGroup_s_p;let l=e(n.stride,0);0===l&&(l=this.GetParticleStride());let u=0;const c=i.GetChildCount();for(let e=0;e<c;e++){let c=null;i.GetType()===t.b2ShapeType.e_edgeShape?c=i:(c=s,i.GetChildEdge(c,e));const h=N.SubVV(c.m_vertex2,c.m_vertex1,o),m=h.Length();for(;u<m;){const t=N.AddVMulSV(c.m_vertex1,u/m,h,a);this.CreateParticleForGroup(n,r,t),u+=l}u-=m}}CreateParticlesFillShapeForGroup(t,i,n){const r=En.CreateParticlesFillShapeForGroup_s_aabb,s=En.CreateParticlesFillShapeForGroup_s_p;let o=e(i.stride,0);0===o&&(o=this.GetParticleStride());const a=X.IDENTITY,l=r;t.ComputeAABB(l,a,0);for(let e=Math.floor(l.lowerBound.y/o)*o;e<l.upperBound.y;e+=o)for(let r=Math.floor(l.lowerBound.x/o)*o;r<l.upperBound.x;r+=o){const o=s.Set(r,e);t.TestPoint(a,o)&&this.CreateParticleForGroup(i,n,o)}}CreateParticlesWithShapeForGroup(e,i,n){switch(e.GetType()){case t.b2ShapeType.e_edgeShape:case t.b2ShapeType.e_chainShape:this.CreateParticlesStrokeShapeForGroup(e,i,n);break;case t.b2ShapeType.e_polygonShape:case t.b2ShapeType.e_circleShape:this.CreateParticlesFillShapeForGroup(e,i,n)}}CreateParticlesWithShapesForGroup(t,e,i,n){const r=new En.CompositeShape(t,e);this.CreateParticlesFillShapeForGroup(r,i,n)}CloneParticle(t,e){const i=new pn;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;i.flags=this.m_flagsBuffer.data[t],i.position.Copy(this.m_positionBuffer.data[t]),i.velocity.Copy(this.m_velocityBuffer.data[t]),this.m_colorBuffer.data&&i.color.Copy(this.m_colorBuffer.data[t]),this.m_userDataBuffer.data&&(i.userData=this.m_userDataBuffer.data[t]),i.group=e;const n=this.CreateParticle(i);if(this.m_handleIndexBuffer.data){const e=this.m_handleIndexBuffer.data[t];e&&e.SetIndex(n),this.m_handleIndexBuffer.data[n]=e,this.m_handleIndexBuffer.data[t]=null}return this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[n]=this.m_lastBodyContactStepBuffer.data[t]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[n]=this.m_bodyContactCountBuffer.data[t]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[n]=this.m_consecutiveContactStepsBuffer.data[t]),this.m_hasForce&&this.m_forceBuffer[n].Copy(this.m_forceBuffer[t]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[n]=this.m_staticPressureBuffer[t]),this.m_depthBuffer&&(this.m_depthBuffer[n]=this.m_depthBuffer[t]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[n]=this.m_expirationTimeBuffer.data[t]),n}DestroyParticlesInGroup(t,e=!1){for(let i=t.m_firstIndex;i<t.m_lastIndex;i++)this.DestroyParticle(i,e)}DestroyParticleGroup(t){this.m_world.m_destructionListener&&this.m_world.m_destructionListener.SayGoodbyeParticleGroup(t),this.SetGroupFlags(t,0);for(let e=t.m_firstIndex;e<t.m_lastIndex;e++)this.m_groupBuffer[e]=null;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_groupList&&(this.m_groupList=t.m_next),--this.m_groupCount}static ParticleCanBeConnected(e,i){return 0!=(e&(t.b2ParticleFlag.b2_wallParticle|t.b2ParticleFlag.b2_springParticle|t.b2ParticleFlag.b2_elasticParticle))||null!==i&&0!=(i.GetGroupFlags()&t.b2ParticleGroupFlag.b2_rigidParticleGroup)}UpdatePairsAndTriads(e,i,n){const r=En.UpdatePairsAndTriads_s_dab,s=En.UpdatePairsAndTriads_s_dbc,o=En.UpdatePairsAndTriads_s_dca;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const a=this.m_positionBuffer.data;let l=0;for(let t=e;t<i;t++)l|=this.m_flagsBuffer.data[t];if(l&En.k_pairFlags)for(let u=0;u<this.m_contactBuffer.count;u++){const r=this.m_contactBuffer.data[u],s=r.indexA,o=r.indexB,l=this.m_flagsBuffer.data[s],c=this.m_flagsBuffer.data[o],h=this.m_groupBuffer[s],m=this.m_groupBuffer[o];if(s>=e&&s<i&&o>=e&&o<i&&!((l|c)&t.b2ParticleFlag.b2_zombieParticle)&&(l|c)&En.k_pairFlags&&(n.IsNecessary(s)||n.IsNecessary(o))&&En.ParticleCanBeConnected(l,h)&&En.ParticleCanBeConnected(c,m)&&n.ShouldCreatePair(s,o)){const t=this.m_pairBuffer.data[this.m_pairBuffer.Append()];t.indexA=s,t.indexB=o,t.flags=r.flags,t.strength=P(h?h.m_strength:1,m?m.m_strength:1),t.distance=N.DistanceVV(a[s],a[o])}An(this.m_pairBuffer.data,0,this.m_pairBuffer.count,En.ComparePairIndices),this.m_pairBuffer.Unique(En.MatchPairIndices)}if(l&En.k_triadFlags){const l=new Sn(i-e);for(let r=e;r<i;r++){const e=this.m_flagsBuffer.data[r],i=this.m_groupBuffer[r];e&t.b2ParticleFlag.b2_zombieParticle||!En.ParticleCanBeConnected(e,i)||l.AddGenerator(a[r],r,n.IsNecessary(r))}const u=this.GetParticleStride();l.Generate(u/2,2*u);const c=this,h=(t,e,i)=>{if(!c.m_flagsBuffer.data)throw new Error;const l=c.m_flagsBuffer.data[t],u=c.m_flagsBuffer.data[e],h=c.m_flagsBuffer.data[i];if((l|u|h)&En.k_triadFlags&&n.ShouldCreateTriad(t,e,i)){const n=a[t],m=a[e],_=a[i],f=N.SubVV(n,m,r),d=N.SubVV(m,_,s),p=N.SubVV(_,n,o),y=4*c.m_squaredDiameter;if(N.DotVV(f,f)>y||N.DotVV(d,d)>y||N.DotVV(p,p)>y)return;const v=c.m_groupBuffer[t],g=c.m_groupBuffer[e],b=c.m_groupBuffer[i],x=c.m_triadBuffer.data[c.m_triadBuffer.Append()];x.indexA=t,x.indexB=e,x.indexC=i,x.flags=l|u|h,x.strength=P(P(v?v.m_strength:1,g?g.m_strength:1),b?b.m_strength:1);const S=(n.x+m.x+_.x)/3,w=(n.y+m.y+_.y)/3;x.pa.x=n.x-S,x.pa.y=n.y-w,x.pb.x=m.x-S,x.pb.y=m.y-w,x.pc.x=_.x-S,x.pc.y=_.y-w,x.ka=-N.DotVV(p,f),x.kb=-N.DotVV(f,d),x.kc=-N.DotVV(d,p),x.s=N.CrossVV(n,m)+N.CrossVV(m,_)+N.CrossVV(_,n)}};l.GetNodes(h),An(this.m_triadBuffer.data,0,this.m_triadBuffer.count,En.CompareTriadIndices),this.m_triadBuffer.Unique(En.MatchTriadIndices)}}UpdatePairsAndTriadsWithReactiveParticles(){const e=new En.ReactiveFilter(this.m_flagsBuffer);if(this.UpdatePairsAndTriads(0,this.m_count,e),!this.m_flagsBuffer.data)throw new Error;for(let i=0;i<this.m_count;i++)this.m_flagsBuffer.data[i]&=~t.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~t.b2ParticleFlag.b2_reactiveParticle}static ComparePairIndices(t,e){const i=t.indexA-e.indexA;return 0!==i?i<0:t.indexB<e.indexB}static MatchPairIndices(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB}static CompareTriadIndices(t,e){const i=t.indexA-e.indexA;if(0!==i)return i<0;const n=t.indexB-e.indexB;return 0!==n?n<0:t.indexC<e.indexC}static MatchTriadIndices(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB&&t.indexC===e.indexC}static InitializeParticleLists(t,e){const i=t.GetBufferIndex(),n=t.GetParticleCount();for(let r=0;r<n;r++){const t=e[r];t.list=t,t.next=null,t.count=1,t.index=r+i}}MergeParticleListsInContact(t,e){const i=t.GetBufferIndex();for(let n=0;n<this.m_contactBuffer.count;n++){const r=this.m_contactBuffer.data[n],s=r.indexA,o=r.indexB;if(!t.ContainsParticle(s)||!t.ContainsParticle(o))continue;let a=e[s-i].list,l=e[o-i].list;if(a!==l){if(a.count<l.count){const t=a;a=l,l=t}En.MergeParticleLists(a,l)}}}static MergeParticleLists(t,e){for(let i=e;;){i.list=t;const e=i.next;if(!e){i.next=t.next;break}i=e}t.next=e,t.count+=e.count,e.count=0}static FindLongestParticleList(t,e){const i=t.GetParticleCount();let n=e[0];for(let r=0;r<i;r++){const t=e[r];n.count<t.count&&(n=t)}return n}MergeZombieParticleListNodes(e,i,n){if(!this.m_flagsBuffer.data)throw new Error;const r=e.GetParticleCount();for(let s=0;s<r;s++){const e=i[s];e!==n&&this.m_flagsBuffer.data[e.index]&t.b2ParticleFlag.b2_zombieParticle&&En.MergeParticleListAndNode(n,e)}}static MergeParticleListAndNode(t,e){e.list=t,e.next=t.next,t.next=e,t.count++,e.count=0}CreateParticleGroupsFromParticleList(e,i,n){if(!this.m_flagsBuffer.data)throw new Error;const r=e.GetParticleCount(),s=new gn;s.groupFlags=e.GetGroupFlags(),s.userData=e.GetUserData();for(let o=0;o<r;o++){const e=i[o];if(!e.count||e===n)continue;const r=this.CreateParticleGroup(s);for(let i=e;i;i=i.next){const e=i.index,n=this.CloneParticle(e,r);this.m_flagsBuffer.data[e]|=t.b2ParticleFlag.b2_zombieParticle,i.index=n}}}UpdatePairsAndTriadsWithParticleList(t,e){const i=t.GetBufferIndex();for(let n=0;n<this.m_pairBuffer.count;n++){const r=this.m_pairBuffer.data[n],s=r.indexA,o=r.indexB;t.ContainsParticle(s)&&(r.indexA=e[s-i].index),t.ContainsParticle(o)&&(r.indexB=e[o-i].index)}for(let n=0;n<this.m_triadBuffer.count;n++){const r=this.m_triadBuffer.data[n],s=r.indexA,o=r.indexB,a=r.indexC;t.ContainsParticle(s)&&(r.indexA=e[s-i].index),t.ContainsParticle(o)&&(r.indexB=e[o-i].index),t.ContainsParticle(a)&&(r.indexC=e[a-i].index)}}ComputeDepth(){const e=[];let n=0;for(let i=0;i<this.m_contactBuffer.count;i++){const r=this.m_contactBuffer.data[i],s=r.indexA,o=r.indexB,a=this.m_groupBuffer[s],l=this.m_groupBuffer[o];a&&a===l&&a.m_groupFlags&t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(e[n++]=r)}const r=[];let s=0;for(let i=this.m_groupList;i;i=i.GetNext())if(i.m_groupFlags&t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth){r[s++]=i,this.SetGroupFlags(i,i.m_groupFlags&~t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);for(let t=i.m_firstIndex;t<i.m_lastIndex;t++)this.m_accumulationBuffer[t]=0}for(let t=0;t<n;t++){const i=e[t],n=i.indexA,r=i.indexB,s=i.weight;this.m_accumulationBuffer[n]+=s,this.m_accumulationBuffer[r]+=s}for(let t=0;t<s;t++){const e=r[t];for(let t=e.m_firstIndex;t<e.m_lastIndex;t++){const e=this.m_accumulationBuffer[t];this.m_depthBuffer[t]=e<.8?0:i}}const o=T(this.m_count)>>0;for(let t=0;t<o;t++){let t=!1;for(let i=0;i<n;i++){const n=e[i],r=n.indexA,s=n.indexB,o=1-n.weight,a=this.m_depthBuffer[r],l=this.m_depthBuffer[s],u=l+o,c=a+o;a>u&&(this.m_depthBuffer[r]=u,t=!0),l>c&&(this.m_depthBuffer[s]=c,t=!0)}if(!t)break}for(let t=0;t<s;t++){const e=r[t];for(let t=e.m_firstIndex;t<e.m_lastIndex;t++)this.m_depthBuffer[t]<i?this.m_depthBuffer[t]*=this.m_particleDiameter:this.m_depthBuffer[t]=0}}GetInsideBoundsEnumerator(t){const e=En.computeTag(this.m_inverseDiameter*t.lowerBound.x-1,this.m_inverseDiameter*t.lowerBound.y-1),i=En.computeTag(this.m_inverseDiameter*t.upperBound.x+1,this.m_inverseDiameter*t.upperBound.y+1),n=this.m_proxyBuffer.count,r=Pn(this.m_proxyBuffer.data,0,n,e,En.Proxy.CompareProxyTag),s=Mn(this.m_proxyBuffer.data,0,n,i,En.Proxy.CompareTagProxy);return new En.InsideBoundsEnumerator(this,e,i,r,s)}UpdateAllParticleFlags(){if(!this.m_flagsBuffer.data)throw new Error;this.m_allParticleFlags=0;for(let t=0;t<this.m_count;t++)this.m_allParticleFlags|=this.m_flagsBuffer.data[t];this.m_needsUpdateAllParticleFlags=!1}UpdateAllGroupFlags(){this.m_allGroupFlags=0;for(let t=this.m_groupList;t;t=t.GetNext())this.m_allGroupFlags|=t.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1}AddContact(t,e,i){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;const n=En.AddContact_s_d,r=this.m_positionBuffer.data,s=N.SubVV(r[e],r[t],n),o=N.DotVV(s,s);if(o<this.m_squaredDiameter){let i=G(o);isFinite(i)||(i=198177537e11);const n=this.m_contactBuffer.data[this.m_contactBuffer.Append()];n.indexA=t,n.indexB=e,n.flags=this.m_flagsBuffer.data[t]|this.m_flagsBuffer.data[e],n.weight=1-o*i*this.m_inverseDiameter,N.MulSV(i,s,n.normal)}}FindContacts_Reference(t){const e=this.m_proxyBuffer.count;this.m_contactBuffer.count=0;for(let i=0,n=0;i<e;i++){const t=En.computeRelativeTag(this.m_proxyBuffer.data[i].tag,1,0);for(let n=i+1;n<e&&!(t<this.m_proxyBuffer.data[n].tag);n++)this.AddContact(this.m_proxyBuffer.data[i].index,this.m_proxyBuffer.data[n].index,this.m_contactBuffer);const r=En.computeRelativeTag(this.m_proxyBuffer.data[i].tag,-1,1);for(;n<e&&!(r<=this.m_proxyBuffer.data[n].tag);n++);const s=En.computeRelativeTag(this.m_proxyBuffer.data[i].tag,1,1);for(let o=n;o<e&&!(s<this.m_proxyBuffer.data[o].tag);o++)this.AddContact(this.m_proxyBuffer.data[i].index,this.m_proxyBuffer.data[o].index,this.m_contactBuffer)}}FindContacts(t){this.FindContacts_Reference(t)}UpdateProxies_Reference(t){if(!this.m_positionBuffer.data)throw new Error;const e=this.m_positionBuffer.data,i=this.m_inverseDiameter;for(let n=0;n<this.m_proxyBuffer.count;++n){const t=this.m_proxyBuffer.data[n],r=e[t.index];t.tag=En.computeTag(i*r.x,i*r.y)}}UpdateProxies(t){this.UpdateProxies_Reference(t)}SortProxies(t){Cn(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,En.Proxy.CompareProxyProxy)}FilterContacts(e){const i=this.GetParticleContactFilter();if(null===i)return;const n=this;this.m_contactBuffer.RemoveIf((e=>0!=(e.flags&t.b2ParticleFlag.b2_particleContactFilterParticle)&&!i.ShouldCollideParticleParticle(n,e.indexA,e.indexB)))}NotifyContactListenerPreContact(t){if(null!==this.GetParticleContactListener())throw t.Initialize(this.m_contactBuffer,this.m_flagsBuffer),new Error}NotifyContactListenerPostContact(t){const e=this.GetParticleContactListener();if(null!==e){for(let t=0;t<this.m_contactBuffer.count;++t){const i=this.m_contactBuffer.data[t];e.BeginContactParticleParticle(this,i)}throw new Error}}static b2ParticleContactIsZombie(e){return(e.flags&t.b2ParticleFlag.b2_zombieParticle)===t.b2ParticleFlag.b2_zombieParticle}UpdateContacts(t){this.UpdateProxies(this.m_proxyBuffer),this.SortProxies(this.m_proxyBuffer);const e=new En.b2ParticlePairSet;this.NotifyContactListenerPreContact(e),this.FindContacts(this.m_contactBuffer),this.FilterContacts(this.m_contactBuffer),this.NotifyContactListenerPostContact(e),t&&this.m_contactBuffer.RemoveIf(En.b2ParticleContactIsZombie)}NotifyBodyContactListenerPreContact(t){if(null!==this.GetFixtureContactListener())throw t.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer),new Error}NotifyBodyContactListenerPostContact(t){const e=this.GetFixtureContactListener();if(null!==e){for(let t=0;t<this.m_bodyContactBuffer.count;t++){const i=this.m_bodyContactBuffer.data[t];e.BeginContactFixtureParticle(this,i)}throw new Error}}UpdateBodyContacts(){const t=En.UpdateBodyContacts_s_aabb,e=new En.FixtureParticleSet;if(this.NotifyBodyContactListenerPreContact(e),this.m_stuckThreshold>0){if(!this.m_bodyContactCountBuffer.data)throw new Error;if(!this.m_lastBodyContactStepBuffer.data)throw new Error;if(!this.m_consecutiveContactStepsBuffer.data)throw new Error;const t=this.GetParticleCount();for(let e=0;e<t;e++)this.m_bodyContactCountBuffer.data[e]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[e]+1&&(this.m_consecutiveContactStepsBuffer.data[e]=0)}this.m_bodyContactBuffer.SetCount(0),this.m_stuckParticleBuffer.SetCount(0);const i=t;this.ComputeAABB(i);const n=new En.UpdateBodyContactsCallback(this,this.GetFixtureContactFilter());this.m_world.QueryAABB(n,i),this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts(),this.NotifyBodyContactListenerPostContact(e)}Solve(e){const i=En.Solve_s_subStep;if(0!==this.m_count&&(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(e),this.m_allParticleFlags&t.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),!this.m_paused))for(this.m_iterationIndex=0;this.m_iterationIndex<e.particleIterations;this.m_iterationIndex++){++this.m_timestamp;const n=i.Copy(e);if(n.dt/=e.particleIterations,n.inv_dt*=e.particleIterations,this.UpdateContacts(!1),this.UpdateBodyContacts(),this.ComputeWeight(),this.m_allGroupFlags&t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth(),this.m_allParticleFlags&t.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles(),this.m_hasForce&&this.SolveForce(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous(),this.m_allParticleFlags&t.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(n),this.m_allGroupFlags&t.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing(),this.SolveGravity(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_staticPressureParticle&&this.SolveStaticPressure(n),this.SolvePressure(n),this.SolveDamping(n),this.m_allParticleFlags&En.k_extraDampingFlags&&this.SolveExtraDamping(),this.m_allParticleFlags&t.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_springParticle&&this.SolveSpring(n),this.LimitVelocity(n),this.m_allGroupFlags&t.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping(),this.m_allParticleFlags&t.b2ParticleFlag.b2_barrierParticle&&this.SolveBarrier(n),this.SolveCollision(n),this.m_allGroupFlags&t.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(n),this.m_allParticleFlags&t.b2ParticleFlag.b2_wallParticle&&this.SolveWall(),!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(let t=0;t<this.m_count;t++)this.m_positionBuffer.data[t].SelfMulAdd(n.dt,this.m_velocityBuffer.data[t])}}SolveCollision(t){const e=En.SolveCollision_s_aabb;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=e;s.lowerBound.x=+i,s.lowerBound.y=+i,s.upperBound.x=-i,s.upperBound.y=-i;for(let i=0;i<this.m_count;i++){const e=r[i],o=n[i],a=o.x+t.dt*e.x,l=o.y+t.dt*e.y;s.lowerBound.x=P(s.lowerBound.x,P(o.x,a)),s.lowerBound.y=P(s.lowerBound.y,P(o.y,l)),s.upperBound.x=M(s.upperBound.x,M(o.x,a)),s.upperBound.y=M(s.upperBound.y,M(o.y,l))}const o=new En.SolveCollisionCallback(this,t);this.m_world.QueryAABB(o,s)}LimitVelocity(t){if(!this.m_velocityBuffer.data)throw new Error;const e=this.m_velocityBuffer.data,i=this.GetCriticalVelocitySquared(t);for(let n=0;n<this.m_count;n++){const t=e[n],r=N.DotVV(t,t);r>i&&t.SelfMul(T(i/r))}}SolveGravity(t){if(!this.m_velocityBuffer.data)throw new Error;const e=En.SolveGravity_s_gravity,i=this.m_velocityBuffer.data,n=N.MulSV(t.dt*this.m_def.gravityScale,this.m_world.GetGravity(),e);for(let r=0;r<this.m_count;r++)i[r].SelfAdd(n)}SolveBarrier(e){const i=En.SolveBarrier_s_aabb,n=En.SolveBarrier_s_va,r=En.SolveBarrier_s_vb,s=En.SolveBarrier_s_pba,o=En.SolveBarrier_s_vba,a=En.SolveBarrier_s_vc,l=En.SolveBarrier_s_pca,u=En.SolveBarrier_s_vca,c=En.SolveBarrier_s_qba,h=En.SolveBarrier_s_qca,m=En.SolveBarrier_s_dv,_=En.SolveBarrier_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const f=this.m_positionBuffer.data,d=this.m_velocityBuffer.data;for(let t=0;t<this.m_count;t++){0!=(this.m_flagsBuffer.data[t]&En.k_barrierWallFlags)&&d[t].SetZero()}const p=2.5*e.dt,y=this.GetParticleMass();for(let v=0;v<this.m_pairBuffer.count;v++){const g=this.m_pairBuffer.data[v];if(g.flags&t.b2ParticleFlag.b2_barrierParticle){const t=g.indexA,v=g.indexB,b=f[t],x=f[v],S=i;N.MinV(b,x,S.lowerBound),N.MaxV(b,x,S.upperBound);const w=this.m_groupBuffer[t],B=this.m_groupBuffer[v],C=this.GetLinearVelocity(w,t,b,n),A=this.GetLinearVelocity(B,v,x,r),V=N.SubVV(x,b,s),P=N.SubVV(A,C,o),M=this.GetInsideBoundsEnumerator(S);let I;for(;(I=M.GetNext())>=0;){const t=f[I],i=this.m_groupBuffer[I];if(w!==i&&B!==i){const n=this.GetLinearVelocity(i,I,t,a),r=N.SubVV(t,b,l),s=N.SubVV(n,C,u),o=N.CrossVV(P,s),f=N.CrossVV(V,s)-N.CrossVV(r,P),v=N.CrossVV(V,r);let g,x;const S=c,w=h;if(0===o){if(0===f)continue;if(!((x=-v/f)>=0&&x<p))continue;if(N.AddVMulSV(V,x,P,S),N.AddVMulSV(r,x,s,w),!((g=N.DotVV(S,w)/N.DotVV(S,S))>=0&&g<=1))continue}else{const t=f*f-4*v*o;if(t<0)continue;const e=T(t);let i=(-f-e)/(2*o),n=(-f+e)/(2*o);if(i>n){const t=i;i=n,n=t}if(x=i,N.AddVMulSV(V,x,P,S),N.AddVMulSV(r,x,s,w),g=N.DotVV(S,w)/N.DotVV(S,S),!(x>=0&&x<p&&g>=0&&g<=1)){if(!((x=n)>=0&&x<p))continue;if(N.AddVMulSV(V,x,P,S),N.AddVMulSV(r,x,s,w),!((g=N.DotVV(S,w)/N.DotVV(S,S))>=0&&g<=1))continue}}const B=m;B.x=C.x+g*P.x-n.x,B.y=C.y+g*P.y-n.y;const A=N.MulSV(y,B,_);if(i&&this.IsRigidGroup(i)){const e=i.GetMass(),n=i.GetInertia();e>0&&i.m_linearVelocity.SelfMulAdd(1/e,A),n>0&&(i.m_angularVelocity+=N.CrossVV(N.SubVV(t,i.GetCenter(),N.s_t0),A)/n)}else d[I].SelfAdd(B);this.ParticleApplyForce(I,A.SelfMul(-e.inv_dt))}}}}}SolveStaticPressure(e){if(!this.m_flagsBuffer.data)throw new Error;this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);const i=this.GetCriticalPressure(e),n=this.m_def.staticPressureStrength*i,r=p*i,s=this.m_def.staticPressureRelaxation;for(let o=0;o<this.m_def.staticPressureIterations;o++){for(let t=0;t<this.m_count;t++)this.m_accumulationBuffer[t]=0;for(let e=0;e<this.m_contactBuffer.count;e++){const i=this.m_contactBuffer.data[e];if(i.flags&t.b2ParticleFlag.b2_staticPressureParticle){const t=i.indexA,e=i.indexB,n=i.weight;this.m_accumulationBuffer[t]+=n*this.m_staticPressureBuffer[e],this.m_accumulationBuffer[e]+=n*this.m_staticPressureBuffer[t]}}for(let e=0;e<this.m_count;e++){const i=this.m_weightBuffer[e];if(this.m_flagsBuffer.data[e]&t.b2ParticleFlag.b2_staticPressureParticle){const t=(this.m_accumulationBuffer[e]+n*(i-1))/(i+s);this.m_staticPressureBuffer[e]=I(t,0,r)}else this.m_staticPressureBuffer[e]=0}}}ComputeWeight(){for(let t=0;t<this.m_count;t++)this.m_weightBuffer[t]=0;for(let t=0;t<this.m_bodyContactBuffer.count;t++){const e=this.m_bodyContactBuffer.data[t],i=e.index,n=e.weight;this.m_weightBuffer[i]+=n}for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t],i=e.indexA,n=e.indexB,r=e.weight;this.m_weightBuffer[i]+=r,this.m_weightBuffer[n]+=r}}SolvePressure(e){const i=En.SolvePressure_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=this.GetCriticalPressure(e),o=this.m_def.pressureStrength*s,a=p*s;for(let t=0;t<this.m_count;t++){const e=this.m_weightBuffer[t],i=o*M(0,e-1);this.m_accumulationBuffer[t]=P(i,a)}if(this.m_allParticleFlags&En.k_noPressureFlags)for(let t=0;t<this.m_count;t++)this.m_flagsBuffer.data[t]&En.k_noPressureFlags&&(this.m_accumulationBuffer[t]=0);if(this.m_allParticleFlags&t.b2ParticleFlag.b2_staticPressureParticle)for(let c=0;c<this.m_count;c++)this.m_flagsBuffer.data[c]&t.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[c]+=this.m_staticPressureBuffer[c]);const l=e.dt/(this.m_def.density*this.m_particleDiameter),u=this.GetParticleInvMass();for(let t=0;t<this.m_bodyContactBuffer.count;t++){const e=this.m_bodyContactBuffer.data[t],s=e.index,a=e.body,c=e.weight,h=e.mass,m=e.normal,_=n[s],f=this.m_accumulationBuffer[s]+o*c,d=N.MulSV(l*c*h*f,m,i);r[s].SelfMulSub(u,d),a.ApplyLinearImpulse(d,_,!0)}for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t],n=e.indexA,s=e.indexB,o=e.weight,a=e.normal,u=this.m_accumulationBuffer[n]+this.m_accumulationBuffer[s],c=N.MulSV(l*o*u,a,i);r[n].SelfSub(c),r[s].SelfAdd(c)}}SolveDamping(t){const e=En.SolveDamping_s_v,i=En.SolveDamping_s_f;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=this.m_def.dampingStrength,o=1/this.GetCriticalVelocity(t),a=this.GetParticleInvMass();for(let l=0;l<this.m_bodyContactBuffer.count;l++){const t=this.m_bodyContactBuffer.data[l],u=t.index,c=t.body,h=t.weight,m=t.mass,_=t.normal,f=n[u],d=N.SubVV(c.GetLinearVelocityFromWorldPoint(f,N.s_t0),r[u],e),p=N.DotVV(d,_);if(p<0){const t=M(s*h,P(-o*p,.5)),e=N.MulSV(t*m*p,_,i);r[u].SelfMulAdd(a,e),c.ApplyLinearImpulse(e.SelfNeg(),f,!0)}}for(let l=0;l<this.m_contactBuffer.count;l++){const t=this.m_contactBuffer.data[l],n=t.indexA,a=t.indexB,u=t.weight,c=t.normal,h=N.SubVV(r[a],r[n],e),m=N.DotVV(h,c);if(m<0){const t=M(s*u,P(-o*m,.5)),e=N.MulSV(t*m,c,i);r[n].SelfAdd(e),r[a].SelfSub(e)}}}SolveRigidDamping(){const t=En.SolveRigidDamping_s_t0,e=En.SolveRigidDamping_s_t1,i=En.SolveRigidDamping_s_p,n=En.SolveRigidDamping_s_v,r=[0],s=[0],o=[0],a=[0],l=[0],u=[0];if(!this.m_positionBuffer.data)throw new Error;const c=this.m_positionBuffer.data,h=this.m_def.dampingStrength;for(let m=0;m<this.m_bodyContactBuffer.count;m++){const i=this.m_bodyContactBuffer.data[m],_=i.index,f=this.m_groupBuffer[_];if(f&&this.IsRigidGroup(f)){const m=i.body,d=i.normal,p=i.weight,y=c[_],v=N.SubVV(m.GetLinearVelocityFromWorldPoint(y,t),f.GetLinearVelocityFromWorldPoint(y,e),n),g=N.DotVV(v,d);if(g<0){this.InitDampingParameterWithRigidGroupOrParticle(r,s,o,!0,f,_,y,d),this.InitDampingParameter(a,l,u,m.GetMass(),m.GetInertia()-m.GetMass()*m.GetLocalCenter().LengthSquared(),m.GetWorldCenter(),y,d);const t=h*P(p,1)*this.ComputeDampingImpulse(r[0],s[0],o[0],a[0],l[0],u[0],g);this.ApplyDamping(r[0],s[0],o[0],!0,f,_,t,d),m.ApplyLinearImpulse(N.MulSV(-t,d,N.s_t0),y,!0)}}}for(let m=0;m<this.m_contactBuffer.count;m++){const _=this.m_contactBuffer.data[m],f=_.indexA,d=_.indexB,p=_.normal,y=_.weight,v=this.m_groupBuffer[f],g=this.m_groupBuffer[d],b=this.IsRigidGroup(v),x=this.IsRigidGroup(g);if(v!==g&&(b||x)){const m=N.MidVV(c[f],c[d],i),_=N.SubVV(this.GetLinearVelocity(g,d,m,t),this.GetLinearVelocity(v,f,m,e),n),S=N.DotVV(_,p);if(S<0){this.InitDampingParameterWithRigidGroupOrParticle(r,s,o,b,v,f,m,p),this.InitDampingParameterWithRigidGroupOrParticle(a,l,u,x,g,d,m,p);const t=h*y*this.ComputeDampingImpulse(r[0],s[0],o[0],a[0],l[0],u[0],S);this.ApplyDamping(r[0],s[0],o[0],b,v,f,t,p),this.ApplyDamping(a[0],l[0],u[0],x,g,d,-t,p)}}}}SolveExtraDamping(){const t=En.SolveExtraDamping_s_v,e=En.SolveExtraDamping_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const i=this.m_velocityBuffer.data,n=this.m_positionBuffer.data,r=this.GetParticleInvMass();for(let s=0;s<this.m_bodyContactBuffer.count;s++){const o=this.m_bodyContactBuffer.data[s],a=o.index;if(this.m_flagsBuffer.data[a]&En.k_extraDampingFlags){const s=o.body,l=o.mass,u=o.normal,c=n[a],h=N.SubVV(s.GetLinearVelocityFromWorldPoint(c,N.s_t0),i[a],t),m=N.DotVV(h,u);if(m<0){const t=N.MulSV(.5*l*m,u,e);i[a].SelfMulAdd(r,t),s.ApplyLinearImpulse(t.SelfNeg(),c,!0)}}}}SolveWall(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const e=this.m_velocityBuffer.data;for(let i=0;i<this.m_count;i++)this.m_flagsBuffer.data[i]&t.b2ParticleFlag.b2_wallParticle&&e[i].SetZero()}SolveRigid(e){const i=En.SolveRigid_s_position,n=En.SolveRigid_s_rotation,r=En.SolveRigid_s_transform,s=En.SolveRigid_s_velocityTransform;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const o=this.m_positionBuffer.data,a=this.m_velocityBuffer.data;for(let l=this.m_groupList;l;l=l.GetNext())if(l.m_groupFlags&t.b2ParticleGroupFlag.b2_rigidParticleGroup){l.UpdateStatistics();const t=n;t.SetAngle(e.dt*l.m_angularVelocity);const u=N.AddVV(l.m_center,N.SubVV(N.MulSV(e.dt,l.m_linearVelocity,N.s_t0),W.MulRV(t,l.m_center,N.s_t1),N.s_t0),i),c=r;c.SetPositionRotation(u,t),X.MulXX(c,l.m_transform,l.m_transform);const h=s;h.p.x=e.inv_dt*c.p.x,h.p.y=e.inv_dt*c.p.y,h.q.s=e.inv_dt*c.q.s,h.q.c=e.inv_dt*(c.q.c-1);for(let e=l.m_firstIndex;e<l.m_lastIndex;e++)X.MulXV(h,o[e],a[e])}}SolveElastic(e){const i=En.SolveElastic_s_pa,n=En.SolveElastic_s_pb,r=En.SolveElastic_s_pc,s=En.SolveElastic_s_r,o=En.SolveElastic_s_t0;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const a=this.m_positionBuffer.data,l=this.m_velocityBuffer.data,u=e.inv_dt*this.m_def.elasticStrength;for(let c=0;c<this.m_triadBuffer.count;c++){const h=this.m_triadBuffer.data[c];if(h.flags&t.b2ParticleFlag.b2_elasticParticle){const t=h.indexA,c=h.indexB,m=h.indexC,_=h.pa,f=h.pb,d=h.pc,p=i.Copy(a[t]),y=n.Copy(a[c]),v=r.Copy(a[m]),g=l[t],b=l[c],x=l[m];p.SelfMulAdd(e.dt,g),y.SelfMulAdd(e.dt,b),v.SelfMulAdd(e.dt,x);const S=(p.x+y.x+v.x)/3,w=(p.y+y.y+v.y)/3;p.x-=S,p.y-=w,y.x-=S,y.y-=w,v.x-=S,v.y-=w;const B=s;B.s=N.CrossVV(_,p)+N.CrossVV(f,y)+N.CrossVV(d,v),B.c=N.DotVV(_,p)+N.DotVV(f,y)+N.DotVV(d,v);let C=G(B.s*B.s+B.c*B.c);isFinite(C)||(C=198177537e11),B.s*=C,B.c*=C;const A=u*h.strength;W.MulRV(B,_,o),N.SubVV(o,p,o),N.MulSV(A,o,o),g.SelfAdd(o),W.MulRV(B,f,o),N.SubVV(o,y,o),N.MulSV(A,o,o),b.SelfAdd(o),W.MulRV(B,d,o),N.SubVV(o,v,o),N.MulSV(A,o,o),x.SelfAdd(o)}}}SolveSpring(e){const i=En.SolveSpring_s_pa,n=En.SolveSpring_s_pb,r=En.SolveSpring_s_d,s=En.SolveSpring_s_f;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const o=this.m_positionBuffer.data,a=this.m_velocityBuffer.data,l=e.inv_dt*this.m_def.springStrength;for(let u=0;u<this.m_pairBuffer.count;u++){const c=this.m_pairBuffer.data[u];if(c.flags&t.b2ParticleFlag.b2_springParticle){const t=c.indexA,u=c.indexB,h=i.Copy(o[t]),m=n.Copy(o[u]),_=a[t],f=a[u];h.SelfMulAdd(e.dt,_),m.SelfMulAdd(e.dt,f);const d=N.SubVV(m,h,r),p=c.distance,y=d.Length(),v=l*c.strength,g=N.MulSV(v*(p-y)/y,d,s);_.SelfSub(g),f.SelfAdd(g)}}}SolveTensile(e){const i=En.SolveTensile_s_weightedNormal,n=En.SolveTensile_s_s,r=En.SolveTensile_s_f;if(!this.m_velocityBuffer.data)throw new Error;const s=this.m_velocityBuffer.data;for(let t=0;t<this.m_count;t++)this.m_accumulation2Buffer[t]=new N,this.m_accumulation2Buffer[t].SetZero();for(let c=0;c<this.m_contactBuffer.count;c++){const e=this.m_contactBuffer.data[c];if(e.flags&t.b2ParticleFlag.b2_tensileParticle){const t=e.indexA,n=e.indexB,r=e.weight,s=e.normal,o=N.MulSV((1-r)*r,s,i);this.m_accumulation2Buffer[t].SelfSub(o),this.m_accumulation2Buffer[n].SelfAdd(o)}}const o=this.GetCriticalVelocity(e),a=this.m_def.surfaceTensionPressureStrength*o,l=this.m_def.surfaceTensionNormalStrength*o,u=.5*o;for(let c=0;c<this.m_contactBuffer.count;c++){const e=this.m_contactBuffer.data[c];if(e.flags&t.b2ParticleFlag.b2_tensileParticle){const t=e.indexA,i=e.indexB,o=e.weight,c=e.normal,h=this.m_weightBuffer[t]+this.m_weightBuffer[i],m=N.SubVV(this.m_accumulation2Buffer[i],this.m_accumulation2Buffer[t],n),_=P(a*(h-2)+l*N.DotVV(m,c),u)*o,f=N.MulSV(_,c,r);s[t].SelfSub(f),s[i].SelfAdd(f)}}}SolveViscous(){const e=En.SolveViscous_s_v,i=En.SolveViscous_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=this.m_def.viscousStrength,o=this.GetParticleInvMass();for(let a=0;a<this.m_bodyContactBuffer.count;a++){const l=this.m_bodyContactBuffer.data[a],u=l.index;if(this.m_flagsBuffer.data[u]&t.b2ParticleFlag.b2_viscousParticle){const t=l.body,a=l.weight,c=l.mass,h=n[u],m=N.SubVV(t.GetLinearVelocityFromWorldPoint(h,N.s_t0),r[u],e),_=N.MulSV(s*c*a,m,i);r[u].SelfMulAdd(o,_),t.ApplyLinearImpulse(_.SelfNeg(),h,!0)}}for(let a=0;a<this.m_contactBuffer.count;a++){const n=this.m_contactBuffer.data[a];if(n.flags&t.b2ParticleFlag.b2_viscousParticle){const t=n.indexA,o=n.indexB,a=n.weight,l=N.SubVV(r[o],r[t],e),u=N.MulSV(s*a,l,i);r[t].SelfAdd(u),r[o].SelfSub(u)}}}SolveRepulsive(e){const i=En.SolveRepulsive_s_f;if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_velocityBuffer.data,r=this.m_def.repulsiveStrength*this.GetCriticalVelocity(e);for(let s=0;s<this.m_contactBuffer.count;s++){const e=this.m_contactBuffer.data[s];if(e.flags&t.b2ParticleFlag.b2_repulsiveParticle){const t=e.indexA,s=e.indexB;if(this.m_groupBuffer[t]!==this.m_groupBuffer[s]){const o=e.weight,a=e.normal,l=N.MulSV(r*o,a,i);n[t].SelfSub(l),n[s].SelfAdd(l)}}}}SolvePowder(e){const i=En.SolvePowder_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;const n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=this.m_def.powderStrength*this.GetCriticalVelocity(e),o=.25,a=this.GetParticleInvMass();for(let l=0;l<this.m_bodyContactBuffer.count;l++){const e=this.m_bodyContactBuffer.data[l],u=e.index;if(this.m_flagsBuffer.data[u]&t.b2ParticleFlag.b2_powderParticle){const t=e.weight;if(t>o){const l=e.body,c=e.mass,h=n[u],m=e.normal,_=N.MulSV(s*c*(t-o),m,i);r[u].SelfMulSub(a,_),l.ApplyLinearImpulse(_,h,!0)}}}for(let l=0;l<this.m_contactBuffer.count;l++){const e=this.m_contactBuffer.data[l];if(e.flags&t.b2ParticleFlag.b2_powderParticle){const t=e.weight;if(t>o){const n=e.indexA,a=e.indexB,l=e.normal,u=N.MulSV(s*(t-o),l,i);r[n].SelfSub(u),r[a].SelfAdd(u)}}}}SolveSolid(t){const e=En.SolveSolid_s_f;if(!this.m_velocityBuffer.data)throw new Error;const i=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);const n=t.inv_dt*this.m_def.ejectionStrength;for(let r=0;r<this.m_contactBuffer.count;r++){const t=this.m_contactBuffer.data[r],s=t.indexA,o=t.indexB;if(this.m_groupBuffer[s]!==this.m_groupBuffer[o]){const r=t.weight,a=t.normal,l=this.m_depthBuffer[s]+this.m_depthBuffer[o],u=N.MulSV(n*l*r,a,e);i[s].SelfSub(u),i[o].SelfAdd(u)}}}SolveForce(t){if(!this.m_velocityBuffer.data)throw new Error;const e=this.m_velocityBuffer.data,i=t.dt*this.GetParticleInvMass();for(let n=0;n<this.m_count;n++)e[n].SelfMulAdd(i,this.m_forceBuffer[n]);this.m_hasForce=!1}SolveColorMixing(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_colorBuffer.data)throw new Error;const e=.5*this.m_def.colorMixingStrength;if(e)for(let i=0;i<this.m_contactBuffer.count;i++){const n=this.m_contactBuffer.data[i],r=n.indexA,s=n.indexB;if(this.m_flagsBuffer.data[r]&this.m_flagsBuffer.data[s]&t.b2ParticleFlag.b2_colorMixingParticle){const t=this.m_colorBuffer.data[r],i=this.m_colorBuffer.data[s];Z.MixColors(t,i,e)}}}SolveZombie(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;let e=0;const i=[];for(let t=0;t<this.m_count;t++)i[t]=f;let n=0;for(let u=0;u<this.m_count;u++){const r=this.m_flagsBuffer.data[u];if(r&t.b2ParticleFlag.b2_zombieParticle){const e=this.m_world.m_destructionListener;if(r&t.b2ParticleFlag.b2_destructionListenerParticle&&e&&e.SayGoodbyeParticle(this,u),this.m_handleIndexBuffer.data){const t=this.m_handleIndexBuffer.data[u];t&&(t.SetIndex(f),this.m_handleIndexBuffer.data[u]=null)}i[u]=f}else{if(i[u]=e,u!==e){if(this.m_handleIndexBuffer.data){const t=this.m_handleIndexBuffer.data[u];t&&t.SetIndex(e),this.m_handleIndexBuffer.data[e]=t}this.m_flagsBuffer.data[e]=this.m_flagsBuffer.data[u],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[e]=this.m_lastBodyContactStepBuffer.data[u]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[e]=this.m_bodyContactCountBuffer.data[u]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[e]=this.m_consecutiveContactStepsBuffer.data[u]),this.m_positionBuffer.data[e].Copy(this.m_positionBuffer.data[u]),this.m_velocityBuffer.data[e].Copy(this.m_velocityBuffer.data[u]),this.m_groupBuffer[e]=this.m_groupBuffer[u],this.m_hasForce&&this.m_forceBuffer[e].Copy(this.m_forceBuffer[u]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[e]=this.m_staticPressureBuffer[u]),this.m_depthBuffer&&(this.m_depthBuffer[e]=this.m_depthBuffer[u]),this.m_colorBuffer.data&&this.m_colorBuffer.data[e].Copy(this.m_colorBuffer.data[u]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[e]=this.m_userDataBuffer.data[u]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[e]=this.m_expirationTimeBuffer.data[u])}e++,n|=r}}const r=t=>t.index<0,s=t=>t.indexA<0||t.indexB<0,o=t=>t.index<0,a=t=>t.indexA<0||t.indexB<0,l=t=>t.indexA<0||t.indexB<0||t.indexC<0;for(let t=0;t<this.m_proxyBuffer.count;t++){const e=this.m_proxyBuffer.data[t];e.index=i[e.index]}this.m_proxyBuffer.RemoveIf(r);for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t];e.indexA=i[e.indexA],e.indexB=i[e.indexB]}this.m_contactBuffer.RemoveIf(s);for(let t=0;t<this.m_bodyContactBuffer.count;t++){const e=this.m_bodyContactBuffer.data[t];e.index=i[e.index]}this.m_bodyContactBuffer.RemoveIf(o);for(let t=0;t<this.m_pairBuffer.count;t++){const e=this.m_pairBuffer.data[t];e.indexA=i[e.indexA],e.indexB=i[e.indexB]}this.m_pairBuffer.RemoveIf(a);for(let t=0;t<this.m_triadBuffer.count;t++){const e=this.m_triadBuffer.data[t];e.indexA=i[e.indexA],e.indexB=i[e.indexB],e.indexC=i[e.indexC]}if(this.m_triadBuffer.RemoveIf(l),this.m_indexByExpirationTimeBuffer.data){let t=0;for(let e=0;e<this.m_count;e++){const n=i[this.m_indexByExpirationTimeBuffer.data[e]];n!==f&&(this.m_indexByExpirationTimeBuffer.data[t++]=n)}}for(let u=this.m_groupList;u;u=u.GetNext()){let n=e,r=0,s=!1;for(let t=u.m_firstIndex;t<u.m_lastIndex;t++){const e=i[t];e>=0?(n=P(n,e),r=M(r,e+1)):s=!0}n<r?(u.m_firstIndex=n,u.m_lastIndex=r,s&&u.m_groupFlags&t.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(u,u.m_groupFlags|t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(u.m_firstIndex=0,u.m_lastIndex=0,u.m_groupFlags&t.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(u,u.m_groupFlags|t.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}this.m_count=e,this.m_allParticleFlags=n,this.m_needsUpdateAllParticleFlags=!1;for(let u=this.m_groupList;u;){const e=u.GetNext();u.m_groupFlags&t.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(u),u=e}}SolveLifetimes(t){if(!this.m_expirationTimeBuffer.data)throw new Error;if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;this.m_timeElapsed=this.LifetimeToExpirationTime(t.dt);const e=this.GetQuantizedTimeElapsed(),i=this.m_expirationTimeBuffer.data,n=this.m_indexByExpirationTimeBuffer.data,r=this.GetParticleCount();if(this.m_expirationTimeBufferRequiresSorting){Cn(n,0,r,((t,e)=>{const n=i[t],r=i[e],s=n<=0;return s===r<=0?n>r:s})),this.m_expirationTimeBufferRequiresSorting=!1}for(let s=r-1;s>=0;--s){const t=n[s],r=i[t];if(e<r||r<=0)break;this.DestroyParticle(t)}}RotateBuffer(t,e,i){if(t!==e&&e!==i){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;if(In(this.m_flagsBuffer.data,t,e,i),this.m_lastBodyContactStepBuffer.data&&In(this.m_lastBodyContactStepBuffer.data,t,e,i),this.m_bodyContactCountBuffer.data&&In(this.m_bodyContactCountBuffer.data,t,e,i),this.m_consecutiveContactStepsBuffer.data&&In(this.m_consecutiveContactStepsBuffer.data,t,e,i),In(this.m_positionBuffer.data,t,e,i),In(this.m_velocityBuffer.data,t,e,i),In(this.m_groupBuffer,t,e,i),this.m_hasForce&&In(this.m_forceBuffer,t,e,i),this.m_staticPressureBuffer&&In(this.m_staticPressureBuffer,t,e,i),this.m_depthBuffer&&In(this.m_depthBuffer,t,e,i),this.m_colorBuffer.data&&In(this.m_colorBuffer.data,t,e,i),this.m_userDataBuffer.data&&In(this.m_userDataBuffer.data,t,e,i),this.m_handleIndexBuffer.data){In(this.m_handleIndexBuffer.data,t,e,i);for(let e=t;e<i;++e){const t=this.m_handleIndexBuffer.data[e];t&&t.SetIndex(n(t.GetIndex()))}}if(this.m_expirationTimeBuffer.data){In(this.m_expirationTimeBuffer.data,t,e,i);const r=this.GetParticleCount();if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;const s=this.m_indexByExpirationTimeBuffer.data;for(let t=0;t<r;++t)s[t]=n(s[t])}for(let t=0;t<this.m_proxyBuffer.count;t++){const e=this.m_proxyBuffer.data[t];e.index=n(e.index)}for(let t=0;t<this.m_contactBuffer.count;t++){const e=this.m_contactBuffer.data[t];e.indexA=n(e.indexA),e.indexB=n(e.indexB)}for(let t=0;t<this.m_bodyContactBuffer.count;t++){const e=this.m_bodyContactBuffer.data[t];e.index=n(e.index)}for(let t=0;t<this.m_pairBuffer.count;t++){const e=this.m_pairBuffer.data[t];e.indexA=n(e.indexA),e.indexB=n(e.indexB)}for(let t=0;t<this.m_triadBuffer.count;t++){const e=this.m_triadBuffer.data[t];e.indexA=n(e.indexA),e.indexB=n(e.indexB),e.indexC=n(e.indexC)}for(let t=this.m_groupList;t;t=t.GetNext())t.m_firstIndex=n(t.m_firstIndex),t.m_lastIndex=n(t.m_lastIndex-1)+1}function n(n){return n<t?n:n<e?n+i-e:n<i?n+t-e:n}}GetCriticalVelocity(t){return this.m_particleDiameter*t.inv_dt}GetCriticalVelocitySquared(t){const e=this.GetCriticalVelocity(t);return e*e}GetCriticalPressure(t){return this.m_def.density*this.GetCriticalVelocitySquared(t)}GetParticleStride(){return d*this.m_particleDiameter}GetParticleMass(){const t=this.GetParticleStride();return this.m_def.density*t*t}GetParticleInvMass(){const t=this.m_inverseDiameter*(1/d);return this.m_inverseDensity*t*t}GetFixtureContactFilter(){return this.m_allParticleFlags&t.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null}GetParticleContactFilter(){return this.m_allParticleFlags&t.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null}GetFixtureContactListener(){return this.m_allParticleFlags&t.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null}GetParticleContactListener(){return this.m_allParticleFlags&t.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null}SetUserOverridableBuffer(t,e,i){t.data=e,t.userSuppliedCapacity=i}SetGroupFlags(e,i){const n=e.m_groupFlags;(n^i)&t.b2ParticleGroupFlag.b2_solidParticleGroup&&(i|=t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),n&~i&&(this.m_needsUpdateAllGroupFlags=!0),~this.m_allGroupFlags&i&&(i&t.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=i),e.m_groupFlags=i}static BodyContactCompare(t,e){return t.index===e.index?t.weight>e.weight:t.index<e.index}RemoveSpuriousBodyContacts(){Cn(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,En.BodyContactCompare);const t=En.RemoveSpuriousBodyContacts_s_n,e=En.RemoveSpuriousBodyContacts_s_pos,i=En.RemoveSpuriousBodyContacts_s_normal,n=this;let r=-1,s=0;this.m_bodyContactBuffer.count=Vn(this.m_bodyContactBuffer.data,(o=>{if(o.index!==r&&(s=0,r=o.index),s++>3)return!0;const l=t.Copy(o.normal);if(l.SelfMul(n.m_particleDiameter*(1-o.weight)),!n.m_positionBuffer.data)throw new Error;const u=N.AddVV(n.m_positionBuffer.data[o.index],l,e);if(!o.fixture.TestPoint(u)){const t=o.fixture.GetShape().GetChildCount();for(let e=0;e<t;e++){const t=i;if(o.fixture.ComputeDistance(u,t,e)<a)return!1}return!0}return!1}),this.m_bodyContactBuffer.count)}DetectStuckParticle(t){if(!(this.m_stuckThreshold<=0)){if(!this.m_bodyContactCountBuffer.data)throw new Error;if(!this.m_consecutiveContactStepsBuffer.data)throw new Error;if(!this.m_lastBodyContactStepBuffer.data)throw new Error;++this.m_bodyContactCountBuffer.data[t],2===this.m_bodyContactCountBuffer.data[t]&&(++this.m_consecutiveContactStepsBuffer.data[t],this.m_consecutiveContactStepsBuffer.data[t]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=t)),this.m_lastBodyContactStepBuffer.data[t]=this.m_timestamp}}ValidateParticleIndex(t){return t>=0&&t<this.GetParticleCount()&&t!==f}GetQuantizedTimeElapsed(){return Math.floor(this.m_timeElapsed/4294967296)}LifetimeToExpirationTime(t){return this.m_timeElapsed+Math.floor(t/this.m_def.lifetimeGranularity*4294967296)}ForceCanBeApplied(e){return!(e&t.b2ParticleFlag.b2_wallParticle)}PrepareForceBuffer(){if(!this.m_hasForce){for(let t=0;t<this.m_count;t++)this.m_forceBuffer[t].SetZero();this.m_hasForce=!0}}IsRigidGroup(e){return null!==e&&0!=(e.m_groupFlags&t.b2ParticleGroupFlag.b2_rigidParticleGroup)}GetLinearVelocity(t,e,i,n){if(t&&this.IsRigidGroup(t))return t.GetLinearVelocityFromWorldPoint(i,n);if(!this.m_velocityBuffer.data)throw new Error;return n.Copy(this.m_velocityBuffer.data[e])}InitDampingParameter(t,e,i,n,r,s,o,a){t[0]=n>0?1/n:0,e[0]=r>0?1/r:0,i[0]=N.CrossVV(N.SubVV(o,s,N.s_t0),a)}InitDampingParameterWithRigidGroupOrParticle(e,i,n,r,s,o,a,l){if(s&&r)this.InitDampingParameter(e,i,n,s.GetMass(),s.GetInertia(),s.GetCenter(),a,l);else{if(!this.m_flagsBuffer.data)throw new Error;const r=this.m_flagsBuffer.data[o];this.InitDampingParameter(e,i,n,r&t.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,a,a,l)}}ComputeDampingImpulse(t,e,i,n,r,s,o){const a=t+e*i*i+n+r*s*s;return a>0?o/a:0}ApplyDamping(t,e,i,n,r,s,o,a){if(r&&n)r.m_linearVelocity.SelfMulAdd(o*t,a),r.m_angularVelocity+=o*i*e;else{if(!this.m_velocityBuffer.data)throw new Error;this.m_velocityBuffer.data[s].SelfMulAdd(o*t,a)}}}En.xTruncBits=12,En.yTruncBits=12,En.tagBits=32,En.yOffset=1<<En.yTruncBits-1,En.yShift=En.tagBits-En.yTruncBits,En.xShift=En.tagBits-En.yTruncBits-En.xTruncBits,En.xScale=1<<En.xShift,En.xOffset=En.xScale*(1<<En.xTruncBits-1),En.yMask=(1<<En.yTruncBits)-1<<En.yShift,En.xMask=~En.yMask,En.DestroyParticlesInShape_s_aabb=new Gt,En.CreateParticleGroup_s_transform=new X,En.ComputeCollisionEnergy_s_v=new N,En.QueryShapeAABB_s_aabb=new Gt,En.QueryPointAABB_s_aabb=new Gt,En.RayCast_s_aabb=new Gt,En.RayCast_s_p=new N,En.RayCast_s_v=new N,En.RayCast_s_n=new N,En.RayCast_s_point=new N,En.k_pairFlags=t.b2ParticleFlag.b2_springParticle,En.k_triadFlags=t.b2ParticleFlag.b2_elasticParticle,En.k_noPressureFlags=t.b2ParticleFlag.b2_powderParticle|t.b2ParticleFlag.b2_tensileParticle,En.k_extraDampingFlags=t.b2ParticleFlag.b2_staticPressureParticle,En.k_barrierWallFlags=t.b2ParticleFlag.b2_barrierParticle|t.b2ParticleFlag.b2_wallParticle,En.CreateParticlesStrokeShapeForGroup_s_edge=new mi,En.CreateParticlesStrokeShapeForGroup_s_d=new N,En.CreateParticlesStrokeShapeForGroup_s_p=new N,En.CreateParticlesFillShapeForGroup_s_aabb=new Gt,En.CreateParticlesFillShapeForGroup_s_p=new N,En.UpdatePairsAndTriads_s_dab=new N,En.UpdatePairsAndTriads_s_dbc=new N,En.UpdatePairsAndTriads_s_dca=new N,En.AddContact_s_d=new N,En.UpdateBodyContacts_s_aabb=new Gt,En.Solve_s_subStep=new tn,En.SolveCollision_s_aabb=new Gt,En.SolveGravity_s_gravity=new N,En.SolveBarrier_s_aabb=new Gt,En.SolveBarrier_s_va=new N,En.SolveBarrier_s_vb=new N,En.SolveBarrier_s_pba=new N,En.SolveBarrier_s_vba=new N,En.SolveBarrier_s_vc=new N,En.SolveBarrier_s_pca=new N,En.SolveBarrier_s_vca=new N,En.SolveBarrier_s_qba=new N,En.SolveBarrier_s_qca=new N,En.SolveBarrier_s_dv=new N,En.SolveBarrier_s_f=new N,En.SolvePressure_s_f=new N,En.SolveDamping_s_v=new N,En.SolveDamping_s_f=new N,En.SolveRigidDamping_s_t0=new N,En.SolveRigidDamping_s_t1=new N,En.SolveRigidDamping_s_p=new N,En.SolveRigidDamping_s_v=new N,En.SolveExtraDamping_s_v=new N,En.SolveExtraDamping_s_f=new N,En.SolveRigid_s_position=new N,En.SolveRigid_s_rotation=new W,En.SolveRigid_s_transform=new X,En.SolveRigid_s_velocityTransform=new X,En.SolveElastic_s_pa=new N,En.SolveElastic_s_pb=new N,En.SolveElastic_s_pc=new N,En.SolveElastic_s_r=new W,En.SolveElastic_s_t0=new N,En.SolveSpring_s_pa=new N,En.SolveSpring_s_pb=new N,En.SolveSpring_s_d=new N,En.SolveSpring_s_f=new N,En.SolveTensile_s_weightedNormal=new N,En.SolveTensile_s_s=new N,En.SolveTensile_s_f=new N,En.SolveViscous_s_v=new N,En.SolveViscous_s_f=new N,En.SolveRepulsive_s_f=new N,En.SolvePowder_s_f=new N,En.SolveSolid_s_f=new N,En.RemoveSpuriousBodyContacts_s_n=new N,En.RemoveSpuriousBodyContacts_s_pos=new N,En.RemoveSpuriousBodyContacts_s_normal=new N,function(e){e.UserOverridableBuffer=class{constructor(){this.data=null,this.userSuppliedCapacity=0}},e.Proxy=class{constructor(){this.index=f,this.tag=0}static CompareProxyProxy(t,e){return t.tag<e.tag}static CompareTagProxy(t,e){return t<e.tag}static CompareProxyTag(t,e){return t.tag<e}},e.InsideBoundsEnumerator=class{constructor(t,i,n,r,s){this.m_system=t,this.m_xLower=(i&e.xMask)>>>0,this.m_xUpper=(n&e.xMask)>>>0,this.m_yLower=(i&e.yMask)>>>0,this.m_yUpper=(n&e.yMask)>>>0,this.m_first=r,this.m_last=s}GetNext(){for(;this.m_first<this.m_last;){const t=(this.m_system.m_proxyBuffer.data[this.m_first].tag&e.xMask)>>>0;if(t>=this.m_xLower&&t<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return f}},e.ParticleListNode=class{constructor(){this.next=null,this.count=0,this.index=0}},e.FixedSetAllocator=class{Allocate(t,e){return e}Clear(){}GetCount(){return 0}Invalidate(t){}GetValidBuffer(){return[]}GetBuffer(){return[]}SetCount(t){}},e.FixtureParticle=class{constructor(t,e){this.second=f,this.first=t,this.second=e}},e.FixtureParticleSet=class extends e.FixedSetAllocator{Initialize(t,e){}Find(t){return f}},e.ParticlePair=class{constructor(t,e){this.first=f,this.second=f,this.first=t,this.second=e}},e.b2ParticlePairSet=class extends e.FixedSetAllocator{Initialize(t,e){}Find(t){return f}},e.ConnectionFilter=class{IsNecessary(t){return!0}ShouldCreatePair(t,e){return!0}ShouldCreateTriad(t,e,i){return!0}},e.DestroyParticlesInShapeCallback=class extends $i{constructor(t,e,i,n){super(),this.m_callDestructionListener=!1,this.m_destroyed=0,this.m_system=t,this.m_shape=e,this.m_xf=i,this.m_callDestructionListener=n,this.m_destroyed=0}ReportFixture(t){return!1}ReportParticle(t,e){if(t!==this.m_system)return!1;if(!this.m_system.m_positionBuffer.data)throw new Error;return this.m_shape.TestPoint(this.m_xf,this.m_system.m_positionBuffer.data[e])&&(this.m_system.DestroyParticle(e,this.m_callDestructionListener),this.m_destroyed++),!0}Destroyed(){return this.m_destroyed}},e.JoinParticleGroupsFilter=class extends e.ConnectionFilter{constructor(t){super(),this.m_threshold=0,this.m_threshold=t}ShouldCreatePair(t,e){return t<this.m_threshold&&this.m_threshold<=e||e<this.m_threshold&&this.m_threshold<=t}ShouldCreateTriad(t,e,i){return(t<this.m_threshold||e<this.m_threshold||i<this.m_threshold)&&(this.m_threshold<=t||this.m_threshold<=e||this.m_threshold<=i)}},e.CompositeShape=class extends ui{constructor(e,i=e.length){super(t.b2ShapeType.e_unknown,0),this.m_shapeCount=0,this.m_shapes=e,this.m_shapeCount=i}Clone(){throw new Error}GetChildCount(){return 1}TestPoint(t,e){for(let i=0;i<this.m_shapeCount;i++)if(this.m_shapes[i].TestPoint(t,e))return!0;return!1}ComputeDistance(t,e,i,n){return 0}RayCast(t,e,i,n){return!1}ComputeAABB(t,e,n){const r=new Gt;t.lowerBound.x=+i,t.lowerBound.y=+i,t.upperBound.x=-i,t.upperBound.y=-i;for(let i=0;i<this.m_shapeCount;i++){const n=this.m_shapes[i].GetChildCount();for(let s=0;s<n;s++){const n=r;this.m_shapes[i].ComputeAABB(n,e,s),t.Combine1(n)}}}ComputeMass(t,e){}SetupDistanceProxy(t,e){}ComputeSubmergedArea(t,e,i,n){return 0}Dump(t){}},e.ReactiveFilter=class extends e.ConnectionFilter{constructor(t){super(),this.m_flagsBuffer=t}IsNecessary(e){if(!this.m_flagsBuffer.data)throw new Error;return 0!=(this.m_flagsBuffer.data[e]&t.b2ParticleFlag.b2_reactiveParticle)}};class n extends Dn{constructor(t,e){super(t),this.m_contactFilter=e}ShouldCollideFixtureParticle(e,i,n){if(this.m_contactFilter){if(this.m_system.GetFlagsBuffer()[n]&t.b2ParticleFlag.b2_fixtureContactFilterParticle)return this.m_contactFilter.ShouldCollideFixtureParticle(e,this.m_system,n)}return!0}ReportFixtureAndParticle(i,n,r){const s=e.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_n,o=e.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_rp;if(!this.m_system.m_flagsBuffer.data)throw new Error;if(!this.m_system.m_positionBuffer.data)throw new Error;const a=this.m_system.m_positionBuffer.data[r],l=s,u=i.ComputeDistance(a,l,n);if(u<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(i,this.m_system,r)){const e=i.GetBody(),n=e.GetWorldCenter(),s=e.GetMass(),c=e.GetInertia()-s*e.GetLocalCenter().LengthSquared(),h=s>0?1/s:0,m=c>0?1/c:0,_=this.m_system.m_flagsBuffer.data[r]&t.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),f=N.SubVV(a,n,o),d=N.CrossVV(f,l),p=_+h+m*d*d,y=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];y.index=r,y.body=e,y.fixture=i,y.weight=1-u*this.m_system.m_inverseDiameter,y.normal.Copy(l.SelfNeg()),y.mass=p>0?1/p:0,this.m_system.DetectStuckParticle(r)}}}n.ReportFixtureAndParticle_s_n=new N,n.ReportFixtureAndParticle_s_rp=new N,e.UpdateBodyContactsCallback=n;class r extends Dn{constructor(t,e){super(t),this.m_step=e}ReportFixtureAndParticle(i,n,r){const s=e.SolveCollisionCallback.ReportFixtureAndParticle_s_p1,o=e.SolveCollisionCallback.ReportFixtureAndParticle_s_output,l=e.SolveCollisionCallback.ReportFixtureAndParticle_s_input,u=e.SolveCollisionCallback.ReportFixtureAndParticle_s_p,c=e.SolveCollisionCallback.ReportFixtureAndParticle_s_v,h=e.SolveCollisionCallback.ReportFixtureAndParticle_s_f,m=i.GetBody();if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;const _=this.m_system.m_positionBuffer.data[r],f=this.m_system.m_velocityBuffer.data[r],d=o,p=l;if(0===this.m_system.m_iterationIndex){const e=X.MulTXV(m.m_xf0,_,s);i.GetShape().GetType()===t.b2ShapeType.e_circleShape&&(e.SelfSub(m.GetLocalCenter()),W.MulRV(m.m_xf0.q,e,e),W.MulTRV(m.m_xf.q,e,e),e.SelfAdd(m.GetLocalCenter())),X.MulXV(m.m_xf,e,p.p1)}else p.p1.Copy(_);if(N.AddVMulSV(_,this.m_step.dt,f,p.p2),p.maxFraction=1,i.RayCast(d,p,n)){const t=d.normal,e=u;e.x=(1-d.fraction)*p.p1.x+d.fraction*p.p2.x+a*t.x,e.y=(1-d.fraction)*p.p1.y+d.fraction*p.p2.y+a*t.y;const i=c;i.x=this.m_step.inv_dt*(e.x-_.x),i.y=this.m_step.inv_dt*(e.y-_.y),this.m_system.m_velocityBuffer.data[r].Copy(i);const n=h;n.x=this.m_step.inv_dt*this.m_system.GetParticleMass()*(f.x-i.x),n.y=this.m_step.inv_dt*this.m_system.GetParticleMass()*(f.y-i.y),this.m_system.ParticleApplyForce(r,n)}}ReportParticle(t,e){return!1}}r.ReportFixtureAndParticle_s_p1=new N,r.ReportFixtureAndParticle_s_output=new Dt,r.ReportFixtureAndParticle_s_input=new kt,r.ReportFixtureAndParticle_s_p=new N,r.ReportFixtureAndParticle_s_v=new N,r.ReportFixtureAndParticle_s_f=new N,e.SolveCollisionCallback=r}(En||(En={}));class zn{constructor(t){this.m_newFixture=!1,this.m_locked=!1,this.m_clearForces=!0,this.m_contactManager=new Yi,this.m_bodyList=null,this.m_jointList=null,this.m_particleSystemList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_gravity=new N,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_debugDraw=null,this.m_inv_dt0=0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new Ki,this.m_island=new mn,this.s_stack=[],this.m_controllerList=null,this.m_controllerCount=0,this.m_gravity.Copy(t)}SetDestructionListener(t){this.m_destructionListener=t}SetContactFilter(t){this.m_contactManager.m_contactFilter=t}SetContactListener(t){this.m_contactManager.m_contactListener=t}SetDebugDraw(t){this.m_debugDraw=t}CreateBody(t={}){if(this.IsLocked())throw new Error;const e=new vi(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e}DestroyBody(t){if(this.IsLocked())throw new Error;let e=t.m_jointList;for(;e;){const i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;let i=t.m_controllerList;for(;i;){const e=i;i=i.nextController,e.controller.RemoveBody(t)}let n=t.m_contactList;for(;n;){const t=n;n=n.next,this.m_contactManager.Destroy(t.contact)}t.m_contactList=null;let r=t.m_fixtureList;for(;r;){const e=r;r=r.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(e),e.DestroyProxies(),e.Destroy(),t.m_fixtureList=r,t.m_fixtureCount-=1}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}static _Joint_Create(e,i){switch(e.type){case t.b2JointType.e_distanceJoint:return new wi(e);case t.b2JointType.e_mouseJoint:return new Pi(e);case t.b2JointType.e_prismaticJoint:return new Mi(e);case t.b2JointType.e_revoluteJoint:return new ki(e);case t.b2JointType.e_pulleyJoint:return new Ii(e);case t.b2JointType.e_gearJoint:return new Ai(e);case t.b2JointType.e_wheelJoint:return new Ti(e);case t.b2JointType.e_weldJoint:return new Gi(e);case t.b2JointType.e_frictionJoint:return new Ci(e);case t.b2JointType.e_ropeJoint:return new Di(e);case t.b2JointType.e_motorJoint:return new Vi(e);case t.b2JointType.e_areaJoint:return new Bi(e)}throw new Error}static _Joint_Destroy(t,e){}CreateJoint(t){if(this.IsLocked())throw new Error;const e=zn._Joint_Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;const i=t.bodyA,n=t.bodyB;if(!t.collideConnected){let t=n.GetContactList();for(;t;)t.other===i&&t.contact.FlagForFiltering(),t=t.next}return e}DestroyJoint(t){if(this.IsLocked())throw new Error;const e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_jointList&&(this.m_jointList=t.m_next);const i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA===i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB===n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,zn._Joint_Destroy(t,null),--this.m_jointCount,!e){let t=n.GetContactList();for(;t;)t.other===i&&t.contact.FlagForFiltering(),t=t.next}}CreateParticleSystem(t){if(this.IsLocked())throw new Error;const e=new En(t,this);return e.m_prev=null,e.m_next=this.m_particleSystemList,this.m_particleSystemList&&(this.m_particleSystemList.m_prev=e),this.m_particleSystemList=e,e}DestroyParticleSystem(t){if(this.IsLocked())throw new Error;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_particleSystemList&&(this.m_particleSystemList=t.m_next)}CalculateReasonableParticleIterations(t){return null===this.m_particleSystemList?1:yn(this.m_gravity.Length(),function(t){let e=i;for(let i=t.GetParticleSystemList();null!==i;i=i.m_next)e=P(e,i.GetRadius());return e}(this),t)}Step(t,e,i,n=this.CalculateReasonableParticleIterations(t)){const r=zn.Step_s_stepTimer.Reset();this.m_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_newFixture=!1),this.m_locked=!0;const s=zn.Step_s_step;s.dt=t,s.velocityIterations=e,s.positionIterations=i,s.particleIterations=n,s.inv_dt=t>0?1/t:0,s.dtRatio=this.m_inv_dt0*t,s.warmStarting=this.m_warmStarting;const o=zn.Step_s_timer.Reset();if(this.m_contactManager.Collide(),this.m_profile.collide=o.GetMilliseconds(),this.m_stepComplete&&s.dt>0){const t=zn.Step_s_timer.Reset();for(let e=this.m_particleSystemList;e;e=e.m_next)e.Solve(s);this.Solve(s),this.m_profile.solve=t.GetMilliseconds()}if(this.m_continuousPhysics&&s.dt>0){const t=zn.Step_s_timer.Reset();this.SolveTOI(s),this.m_profile.solveTOI=t.GetMilliseconds()}s.dt>0&&(this.m_inv_dt0=s.inv_dt),this.m_clearForces&&this.ClearForces(),this.m_locked=!1,this.m_profile.step=r.GetMilliseconds()}ClearForces(){for(let t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0}DrawParticleSystem(t){if(null===this.m_debugDraw)return;const e=t.GetParticleCount();if(e){const i=t.GetRadius(),n=t.GetPositionBuffer();if(t.m_colorBuffer.data){const r=t.GetColorBuffer();this.m_debugDraw.DrawParticles(n,i,r,e)}else this.m_debugDraw.DrawParticles(n,i,null,e)}}DrawDebugData(){if(null===this.m_debugDraw)return;const e=this.m_debugDraw.GetFlags(),i=zn.DrawDebugData_s_color.SetRGB(0,0,0);if(e&t.b2DrawFlags.e_shapeBit)for(let n=this.m_bodyList;n;n=n.m_next){const e=n.m_xf;this.m_debugDraw.PushTransform(e);for(let r=n.GetFixtureList();r;r=r.m_next)n.IsActive()?n.GetType()===t.b2BodyType.b2_staticBody?(i.SetRGB(.5,.9,.5),this.DrawShape(r,i)):n.GetType()===t.b2BodyType.b2_kinematicBody?(i.SetRGB(.5,.5,.9),this.DrawShape(r,i)):n.IsAwake()?(i.SetRGB(.9,.7,.7),this.DrawShape(r,i)):(i.SetRGB(.6,.6,.6),this.DrawShape(r,i)):(i.SetRGB(.5,.5,.3),this.DrawShape(r,i));this.m_debugDraw.PopTransform(e)}if(e&t.b2DrawFlags.e_particleBit)for(let t=this.m_particleSystemList;t;t=t.m_next)this.DrawParticleSystem(t);if(e&t.b2DrawFlags.e_jointBit)for(let t=this.m_jointList;t;t=t.m_next)this.DrawJoint(t);if(e&t.b2DrawFlags.e_aabbBit){i.SetRGB(.9,.3,.9);const t=zn.DrawDebugData_s_vs;for(let e=this.m_bodyList;e;e=e.m_next)if(e.IsActive())for(let n=e.GetFixtureList();n;n=n.m_next)for(let e=0;e<n.m_proxyCount;++e){const r=n.m_proxies[e].treeNode.aabb;t[0].Set(r.lowerBound.x,r.lowerBound.y),t[1].Set(r.upperBound.x,r.lowerBound.y),t[2].Set(r.upperBound.x,r.upperBound.y),t[3].Set(r.lowerBound.x,r.upperBound.y),this.m_debugDraw.DrawPolygon(t,4,i)}}if(e&t.b2DrawFlags.e_centerOfMassBit)for(let t=this.m_bodyList;t;t=t.m_next){const e=zn.DrawDebugData_s_xf;e.q.Copy(t.m_xf.q),e.p.Copy(t.GetWorldCenter()),this.m_debugDraw.DrawTransform(e)}if(e&t.b2DrawFlags.e_controllerBit)for(let t=this.m_controllerList;t;t=t.m_next)t.Draw(this.m_debugDraw)}QueryAABB(t,e,i){if(this.m_contactManager.m_broadPhase.Query(e,(e=>{const n=e.userData.fixture;return t?t.ReportFixture(n):!i||i(n)})),t instanceof $i)for(let n=this.m_particleSystemList;n;n=n.m_next)t.ShouldQueryParticleSystem(n)&&n.QueryAABB(t,e)}QueryAllAABB(t,e=[]){return this.QueryAABB(null,t,(t=>(e.push(t),!0))),e}QueryPointAABB(t,e,i){if(this.m_contactManager.m_broadPhase.QueryPoint(e,(e=>{const n=e.userData.fixture;return t?t.ReportFixture(n):!i||i(n)})),t instanceof $i)for(let n=this.m_particleSystemList;n;n=n.m_next)t.ShouldQueryParticleSystem(n)&&n.QueryPointAABB(t,e)}QueryAllPointAABB(t,e=[]){return this.QueryPointAABB(null,t,(t=>(e.push(t),!0))),e}QueryFixtureShape(t,e,i,n,r){const s=zn.QueryFixtureShape_s_aabb;if(e.ComputeAABB(s,n,i),this.m_contactManager.m_broadPhase.Query(s,(s=>{const o=s.userData,a=o.fixture;if(zt(e,i,a.GetShape(),o.childIndex,n,a.GetBody().GetTransform())){if(t)return t.ReportFixture(a);if(r)return r(a)}return!0})),t instanceof $i)for(let o=this.m_particleSystemList;o;o=o.m_next)t.ShouldQueryParticleSystem(o)&&o.QueryAABB(t,s)}QueryAllFixtureShape(t,e,i,n=[]){return this.QueryFixtureShape(null,t,e,i,(t=>(n.push(t),!0))),n}QueryFixturePoint(t,e,i){if(this.m_contactManager.m_broadPhase.QueryPoint(e,(n=>{const r=n.userData.fixture;if(r.TestPoint(e)){if(t)return t.ReportFixture(r);if(i)return i(r)}return!0})),t)for(let n=this.m_particleSystemList;n;n=n.m_next)t.ShouldQueryParticleSystem(n)&&n.QueryPointAABB(t,e)}QueryAllFixturePoint(t,e=[]){return this.QueryFixturePoint(null,t,(t=>(e.push(t),!0))),e}RayCast(t,e,i,n){const r=zn.RayCast_s_input;if(r.maxFraction=1,r.p1.Copy(e),r.p2.Copy(i),this.m_contactManager.m_broadPhase.RayCast(r,((r,s)=>{const o=s.userData,a=o.fixture,l=o.childIndex,u=zn.RayCast_s_output;if(a.RayCast(u,r,l)){const r=u.fraction,s=zn.RayCast_s_point;if(s.Set((1-r)*e.x+r*i.x,(1-r)*e.y+r*i.y),t)return t.ReportFixture(a,s,u.normal,r);if(n)return n(a,s,u.normal,r)}return r.maxFraction})),t)for(let s=this.m_particleSystemList;s;s=s.m_next)t.ShouldQueryParticleSystem(s)&&s.RayCast(t,e,i)}RayCastOne(t,e){let i=null,n=1;return this.RayCast(null,t,e,((t,e,r,s)=>(s<n&&(n=s,i=t),n))),i}RayCastAll(t,e,i=[]){return this.RayCast(null,t,e,((t,e,n,r)=>(i.push(t),1))),i}GetBodyList(){return this.m_bodyList}GetJointList(){return this.m_jointList}GetParticleSystemList(){return this.m_particleSystemList}GetContactList(){return this.m_contactManager.m_contactList}SetAllowSleeping(t){if(t!==this.m_allowSleep&&(this.m_allowSleep=t,!this.m_allowSleep))for(let e=this.m_bodyList;e;e=e.m_next)e.SetAwake(!0)}GetAllowSleeping(){return this.m_allowSleep}SetWarmStarting(t){this.m_warmStarting=t}GetWarmStarting(){return this.m_warmStarting}SetContinuousPhysics(t){this.m_continuousPhysics=t}GetContinuousPhysics(){return this.m_continuousPhysics}SetSubStepping(t){this.m_subStepping=t}GetSubStepping(){return this.m_subStepping}GetProxyCount(){return this.m_contactManager.m_broadPhase.GetProxyCount()}GetBodyCount(){return this.m_bodyCount}GetJointCount(){return this.m_jointCount}GetContactCount(){return this.m_contactManager.m_contactCount}GetTreeHeight(){return this.m_contactManager.m_broadPhase.GetTreeHeight()}GetTreeBalance(){return this.m_contactManager.m_broadPhase.GetTreeBalance()}GetTreeQuality(){return this.m_contactManager.m_broadPhase.GetTreeQuality()}SetGravity(t,e=!0){if(!N.IsEqualToV(this.m_gravity,t)&&(this.m_gravity.Copy(t),e))for(let i=this.m_bodyList;i;i=i.m_next)i.SetAwake(!0)}GetGravity(){return this.m_gravity}IsLocked(){return this.m_locked}SetAutoClearForces(t){this.m_clearForces=t}GetAutoClearForces(){return this.m_clearForces}ShiftOrigin(t){if(this.IsLocked())throw new Error;for(let e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.SelfSub(t),e.m_sweep.c0.SelfSub(t),e.m_sweep.c.SelfSub(t);for(let e=this.m_jointList;e;e=e.m_next)e.ShiftOrigin(t);this.m_contactManager.m_broadPhase.ShiftOrigin(t)}GetContactManager(){return this.m_contactManager}GetProfile(){return this.m_profile}Dump(e){if(this.m_locked)return;e("const g: b2Vec2 = new b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y),e("this.m_world.SetGravity(g);\n"),e("const bodies: b2Body[] = [];\n"),e("const joints: b2Joint[] = [];\n");let i=0;for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandIndex=i,t.Dump(e),++i;i=0;for(let t=this.m_jointList;t;t=t.m_next)t.m_index=i,++i;for(let n=this.m_jointList;n;n=n.m_next)n.m_type!==t.b2JointType.e_gearJoint&&(e("{\n"),n.Dump(e),e("}\n"));for(let n=this.m_jointList;n;n=n.m_next)n.m_type===t.b2JointType.e_gearJoint&&(e("{\n"),n.Dump(e),e("}\n"))}DrawJoint(e){if(null===this.m_debugDraw)return;const i=e.GetBodyA(),n=e.GetBodyB(),r=i.m_xf,s=n.m_xf,o=r.p,a=s.p,l=e.GetAnchorA(zn.DrawJoint_s_p1),u=e.GetAnchorB(zn.DrawJoint_s_p2),c=zn.DrawJoint_s_color.SetRGB(.5,.8,.8);switch(e.m_type){case t.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(l,u,c);break;case t.b2JointType.e_pulleyJoint:{const t=e,i=t.GetGroundAnchorA(),n=t.GetGroundAnchorB();this.m_debugDraw.DrawSegment(i,l,c),this.m_debugDraw.DrawSegment(n,u,c),this.m_debugDraw.DrawSegment(i,n,c);break}case t.b2JointType.e_mouseJoint:{const t=zn.DrawJoint_s_c;t.Set(0,1,0),this.m_debugDraw.DrawPoint(l,4,t),this.m_debugDraw.DrawPoint(u,4,t),t.Set(.8,.8,.8),this.m_debugDraw.DrawSegment(l,u,t);break}default:this.m_debugDraw.DrawSegment(o,l,c),this.m_debugDraw.DrawSegment(l,u,c),this.m_debugDraw.DrawSegment(a,u,c)}}DrawShape(e,i){if(null===this.m_debugDraw)return;const n=e.GetShape();switch(n.m_type){case t.b2ShapeType.e_circleShape:{const t=n,e=t.m_p,r=t.m_radius,s=N.UNITX;this.m_debugDraw.DrawSolidCircle(e,r,s,i);break}case t.b2ShapeType.e_edgeShape:{const t=n,e=t.m_vertex1,r=t.m_vertex2;this.m_debugDraw.DrawSegment(e,r,i);break}case t.b2ShapeType.e_chainShape:{const t=n,e=t.m_count,r=t.m_vertices,s=zn.DrawShape_s_ghostColor.SetRGBA(.75*i.r,.75*i.g,.75*i.b,i.a);let o=r[0];if(this.m_debugDraw.DrawPoint(o,4,i),t.m_hasPrevVertex){const e=t.m_prevVertex;this.m_debugDraw.DrawSegment(e,o,s),this.m_debugDraw.DrawCircle(e,.1,s)}for(let n=1;n<e;++n){const t=r[n];this.m_debugDraw.DrawSegment(o,t,i),this.m_debugDraw.DrawPoint(t,4,i),o=t}if(t.m_hasNextVertex){const e=t.m_nextVertex;this.m_debugDraw.DrawSegment(e,o,s),this.m_debugDraw.DrawCircle(e,.1,s)}break}case t.b2ShapeType.e_polygonShape:{const t=n,e=t.m_count,r=t.m_vertices;this.m_debugDraw.DrawSolidPolygon(r,e,i);break}}}Solve(e){for(let t=this.m_bodyList;t;t=t.m_next)t.m_xf0.Copy(t.m_xf);for(let t=this.m_controllerList;t;t=t.m_next)t.Step(e);this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;const i=this.m_island;i.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=this.m_contactManager.m_contactList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=this.m_jointList;t;t=t.m_next)t.m_islandFlag=!1;const n=this.s_stack;for(let s=this.m_bodyList;s;s=s.m_next){if(s.m_islandFlag)continue;if(!s.IsAwake()||!s.IsActive())continue;if(s.GetType()===t.b2BodyType.b2_staticBody)continue;i.Clear();let r=0;for(n[r++]=s,s.m_islandFlag=!0;r>0;){const e=n[--r];if(!e)throw new Error;if(i.AddBody(e),e.m_awakeFlag=!0,e.GetType()!==t.b2BodyType.b2_staticBody){for(let t=e.m_contactList;t;t=t.next){const e=t.contact;if(e.m_islandFlag)continue;if(!e.IsEnabled()||!e.IsTouching())continue;const s=e.m_fixtureA.m_isSensor,o=e.m_fixtureB.m_isSensor;if(s||o)continue;i.AddContact(e),e.m_islandFlag=!0;const a=t.other;if(!a)throw new Error;a.m_islandFlag||(n[r++]=a,a.m_islandFlag=!0)}for(let t=e.m_jointList;t;t=t.next){if(t.joint.m_islandFlag)continue;const e=t.other;e.IsActive()&&(i.AddJoint(t.joint),t.joint.m_islandFlag=!0,e.m_islandFlag||(n[r++]=e,e.m_islandFlag=!0))}}}const o=new Ki;i.Solve(o,e,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=o.solveInit,this.m_profile.solveVelocity+=o.solveVelocity,this.m_profile.solvePosition+=o.solvePosition;for(let e=0;e<i.m_bodyCount;++e){const n=i.m_bodies[e];n.GetType()===t.b2BodyType.b2_staticBody&&(n.m_islandFlag=!1)}}for(let t=0;t<n.length&&n[t];++t)n[t]=null;const r=new $;for(let s=this.m_bodyList;s;s=s.m_next)s.m_islandFlag&&s.GetType()!==t.b2BodyType.b2_staticBody&&s.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=r.GetMilliseconds()}SolveTOI(e){const i=this.m_island;if(i.Initialize(64,32,0,null,this.m_contactManager.m_contactListener),this.m_stepComplete){for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1,t.m_sweep.alpha0=0;for(let t=this.m_contactManager.m_contactList;t;t=t.m_next)t.m_toiFlag=!1,t.m_islandFlag=!1,t.m_toiCount=0,t.m_toi=1}for(;;){let n=null,r=1;for(let e=this.m_contactManager.m_contactList;e;e=e.m_next){if(!e.IsEnabled())continue;if(e.m_toiCount>8)continue;let i=1;if(e.m_toiFlag)i=e.m_toi;else{const n=e.GetFixtureA(),r=e.GetFixtureB();if(n.IsSensor()||r.IsSensor())continue;const s=n.GetBody(),o=r.GetBody(),a=s.m_type,l=o.m_type,u=s.IsAwake()&&a!==t.b2BodyType.b2_staticBody,c=o.IsAwake()&&l!==t.b2BodyType.b2_staticBody;if(!u&&!c)continue;const h=s.IsBullet()||a!==t.b2BodyType.b2_dynamicBody,m=o.IsBullet()||l!==t.b2BodyType.b2_dynamicBody;if(!h&&!m)continue;let _=s.m_sweep.alpha0;s.m_sweep.alpha0<o.m_sweep.alpha0?(_=o.m_sweep.alpha0,s.m_sweep.Advance(_)):o.m_sweep.alpha0<s.m_sweep.alpha0&&(_=s.m_sweep.alpha0,o.m_sweep.Advance(_));const f=e.GetChildIndexA(),d=e.GetChildIndexB(),p=zn.SolveTOI_s_toi_input;p.proxyA.SetShape(n.GetShape(),f),p.proxyB.SetShape(r.GetShape(),d),p.sweepA.Copy(s.m_sweep),p.sweepB.Copy(o.m_sweep),p.tMax=1;const y=zn.SolveTOI_s_toi_output;_e(y,p);const v=y.t;i=y.state===t.b2TOIOutputState.e_touching?P(_+(1-_)*v,1):1,e.m_toi=i,e.m_toiFlag=!0}i<r&&(n=e,r=i)}if(null===n||.9999<r){this.m_stepComplete=!0;break}const s=n.GetFixtureA(),o=n.GetFixtureB(),a=s.GetBody(),l=o.GetBody(),u=zn.SolveTOI_s_backup1.Copy(a.m_sweep),c=zn.SolveTOI_s_backup2.Copy(l.m_sweep);if(a.Advance(r),l.Advance(r),n.Update(this.m_contactManager.m_contactListener),n.m_toiFlag=!1,++n.m_toiCount,!n.IsEnabled()||!n.IsTouching()){n.SetEnabled(!1),a.m_sweep.Copy(u),l.m_sweep.Copy(c),a.SynchronizeTransform(),l.SynchronizeTransform();continue}a.SetAwake(!0),l.SetAwake(!0),i.Clear(),i.AddBody(a),i.AddBody(l),i.AddContact(n),a.m_islandFlag=!0,l.m_islandFlag=!0,n.m_islandFlag=!0;for(let e=0;e<2;++e){const n=0===e?a:l;if(n.m_type===t.b2BodyType.b2_dynamicBody)for(let e=n.m_contactList;e&&i.m_bodyCount!==i.m_bodyCapacity&&i.m_contactCount!==i.m_contactCapacity;e=e.next){const s=e.contact;if(s.m_islandFlag)continue;const o=e.other;if(o.m_type===t.b2BodyType.b2_dynamicBody&&!n.IsBullet()&&!o.IsBullet())continue;const a=s.m_fixtureA.m_isSensor,l=s.m_fixtureB.m_isSensor;if(a||l)continue;const u=zn.SolveTOI_s_backup.Copy(o.m_sweep);o.m_islandFlag||o.Advance(r),s.Update(this.m_contactManager.m_contactListener),s.IsEnabled()&&s.IsTouching()?(s.m_islandFlag=!0,i.AddContact(s),o.m_islandFlag||(o.m_islandFlag=!0,o.m_type!==t.b2BodyType.b2_staticBody&&o.SetAwake(!0),i.AddBody(o))):(o.m_sweep.Copy(u),o.SynchronizeTransform())}}const h=zn.SolveTOI_s_subStep;h.dt=(1-r)*e.dt,h.inv_dt=1/h.dt,h.dtRatio=1,h.positionIterations=20,h.velocityIterations=e.velocityIterations,h.particleIterations=e.particleIterations,h.warmStarting=!1,i.SolveTOI(h,a.m_islandIndex,l.m_islandIndex);for(let e=0;e<i.m_bodyCount;++e){const n=i.m_bodies[e];if(n.m_islandFlag=!1,n.m_type===t.b2BodyType.b2_dynamicBody){n.SynchronizeFixtures();for(let t=n.m_contactList;t;t=t.next)t.contact.m_toiFlag=!1,t.contact.m_islandFlag=!1}}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}}AddController(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t}RemoveController(t){return t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),--this.m_controllerCount,t.m_prev=null,t.m_next=null,t}}zn.Step_s_step=new tn,zn.Step_s_stepTimer=new $,zn.Step_s_timer=new $,zn.DrawDebugData_s_color=new Z(0,0,0),zn.DrawDebugData_s_vs=N.MakeArray(4),zn.DrawDebugData_s_xf=new X,zn.QueryFixtureShape_s_aabb=new Gt,zn.RayCast_s_input=new kt,zn.RayCast_s_output=new Dt,zn.RayCast_s_point=new N,zn.DrawJoint_s_p1=new N,zn.DrawJoint_s_p2=new N,zn.DrawJoint_s_color=new Z(.5,.8,.8),zn.DrawJoint_s_c=new Z,zn.DrawShape_s_ghostColor=new Z,zn.SolveTOI_s_subStep=new tn,zn.SolveTOI_s_backup=new H,zn.SolveTOI_s_backup1=new H,zn.SolveTOI_s_backup2=new H,zn.SolveTOI_s_toi_input=new Kt,zn.SolveTOI_s_toi_output=new ie;class On{constructor(t,e){this.prevBody=null,this.nextBody=null,this.prevController=null,this.nextController=null,this.controller=t,this.body=e}}class Nn{constructor(){this.m_bodyList=null,this.m_bodyCount=0,this.m_prev=null,this.m_next=null}GetNext(){return this.m_next}GetPrev(){return this.m_prev}GetBodyList(){return this.m_bodyList}AddBody(t){const e=new On(this,t);e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList&&(this.m_bodyList.prevBody=e),this.m_bodyList=e,++this.m_bodyCount,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList&&(t.m_controllerList.prevController=e),t.m_controllerList=e,++t.m_controllerCount}RemoveBody(t){if(this.m_bodyCount<=0)throw new Error;let e=this.m_bodyList;for(;e&&e.body!==t;)e=e.nextBody;if(null===e)throw new Error;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),this.m_bodyList===e&&(this.m_bodyList=e.nextBody),--this.m_bodyCount,e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),t.m_controllerList===e&&(t.m_controllerList=e.nextController),--t.m_controllerCount}Clear(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0}}class jn extends Nn{constructor(){super(...arguments),this.A=new N(0,0)}Step(t){const e=N.MulSV(t.dt,this.A,jn.Step_s_dtA);for(let i=this.m_bodyList;i;i=i.nextBody){const t=i.body;t.IsAwake()&&t.SetLinearVelocity(N.AddVV(t.GetLinearVelocity(),e,N.s_t0))}}Draw(t){}}jn.Step_s_dtA=new N;class qn extends Nn{constructor(){super(...arguments),this.G=1,this.invSqr=!0}Step(t){if(this.invSqr)for(let e=this.m_bodyList;e;e=e.nextBody){const t=e.body,i=t.GetWorldCenter(),r=t.GetMass();for(let s=this.m_bodyList;s&&s!==e;s=s.nextBody){const e=s.body,o=e.GetWorldCenter(),a=e.GetMass(),l=o.x-i.x,u=o.y-i.y,c=l*l+u*u;if(c<n)continue;const h=qn.Step_s_f.Set(l,u);h.SelfMul(this.G/c/T(c)*r*a),t.IsAwake()&&t.ApplyForce(h,i),e.IsAwake()&&e.ApplyForce(h.SelfMul(-1),o)}}else for(let e=this.m_bodyList;e;e=e.nextBody){const t=e.body,i=t.GetWorldCenter(),r=t.GetMass();for(let s=this.m_bodyList;s&&s!==e;s=s.nextBody){const e=s.body,o=e.GetWorldCenter(),a=e.GetMass(),l=o.x-i.x,u=o.y-i.y,c=l*l+u*u;if(c<n)continue;const h=qn.Step_s_f.Set(l,u);h.SelfMul(this.G/c*r*a),t.IsAwake()&&t.ApplyForce(h,i),e.IsAwake()&&e.ApplyForce(h.SelfMul(-1),o)}}}Draw(t){}}qn.Step_s_f=new N;class Un extends Nn{constructor(){super(...arguments),this.T=new U,this.maxTimestep=0}Step(t){let e=t.dt;if(!(e<=n)){e>this.maxTimestep&&this.maxTimestep>0&&(e=this.maxTimestep);for(let t=this.m_bodyList;t;t=t.nextBody){const i=t.body;if(!i.IsAwake())continue;const n=i.GetWorldVector(U.MulMV(this.T,i.GetLocalVector(i.GetLinearVelocity(),N.s_t0),N.s_t1),Un.Step_s_damping);i.SetLinearVelocity(N.AddVV(i.GetLinearVelocity(),N.MulSV(e,n,N.s_t0),N.s_t1))}}}Draw(t){}SetAxisAligned(t,e){this.T.ex.x=-t,this.T.ex.y=0,this.T.ey.x=0,this.T.ey.y=-e,this.maxTimestep=t>0||e>0?1/M(t,e):0}}Un.Step_s_damping=new N;class Jn{constructor(){this.m_count=0,this.m_ps=[],this.m_p0s=[],this.m_vs=[],this.m_ims=[],this.m_Ls=[],this.m_as=[],this.m_gravity=new N,this.m_damping=0,this.m_k2=1,this.m_k3=.1}GetVertexCount(){return this.m_count}GetVertices(){return this.m_ps}Initialize(t){this.m_count=t.count,this.m_ps=N.MakeArray(this.m_count),this.m_p0s=N.MakeArray(this.m_count),this.m_vs=N.MakeArray(this.m_count),this.m_ims=w(this.m_count);for(let n=0;n<this.m_count;++n){this.m_ps[n].Copy(t.vertices[n]),this.m_p0s[n].Copy(t.vertices[n]),this.m_vs[n].SetZero();const e=t.masses[n];this.m_ims[n]=e>0?1/e:0}const e=this.m_count-1,i=this.m_count-2;this.m_Ls=w(e),this.m_as=w(i);for(let n=0;n<e;++n){const t=this.m_ps[n],e=this.m_ps[n+1];this.m_Ls[n]=N.DistanceVV(t,e)}for(let n=0;n<i;++n){const t=this.m_ps[n],e=this.m_ps[n+1],i=this.m_ps[n+2],r=N.SubVV(e,t,N.s_t0),s=N.SubVV(i,e,N.s_t1),o=N.CrossVV(r,s),a=N.DotVV(r,s);this.m_as[n]=O(o,a)}this.m_gravity.Copy(t.gravity),this.m_damping=t.damping,this.m_k2=t.k2,this.m_k3=t.k3}Step(t,e){if(0===t)return;const i=Math.exp(-t*this.m_damping);for(let r=0;r<this.m_count;++r)this.m_p0s[r].Copy(this.m_ps[r]),this.m_ims[r]>0&&this.m_vs[r].SelfMulAdd(t,this.m_gravity),this.m_vs[r].SelfMul(i),this.m_ps[r].SelfMulAdd(t,this.m_vs[r]);for(let r=0;r<e;++r)this.SolveC2(),this.SolveC3(),this.SolveC2();const n=1/t;for(let r=0;r<this.m_count;++r)N.MulSV(n,N.SubVV(this.m_ps[r],this.m_p0s[r],N.s_t0),this.m_vs[r])}SolveC2(){const t=this.m_count-1;for(let e=0;e<t;++e){const t=this.m_ps[e],i=this.m_ps[e+1],n=N.SubVV(i,t,Jn.s_d),r=n.Normalize(),s=this.m_ims[e],o=this.m_ims[e+1];if(s+o===0)continue;const a=s/(s+o),l=o/(s+o);t.SelfMulSub(this.m_k2*a*(this.m_Ls[e]-r),n),i.SelfMulAdd(this.m_k2*l*(this.m_Ls[e]-r),n)}}SetAngle(t){const e=this.m_count-2;for(let i=0;i<e;++i)this.m_as[i]=t}SolveC3(){const t=this.m_count-2;for(let e=0;e<t;++e){const t=this.m_ps[e],i=this.m_ps[e+1],n=this.m_ps[e+2],r=this.m_ims[e],o=this.m_ims[e+1],a=this.m_ims[e+2],l=N.SubVV(i,t,Jn.s_d1),u=N.SubVV(n,i,Jn.s_d2),c=l.LengthSquared(),h=u.LengthSquared();if(c*h==0)continue;const m=N.CrossVV(l,u),_=N.DotVV(l,u);let f=O(m,_);const d=N.MulSV(-1/c,l.SelfSkew(),Jn.s_Jd1),p=N.MulSV(1/h,u.SelfSkew(),Jn.s_Jd2),y=N.NegV(d,Jn.s_J1),v=N.SubVV(d,p,Jn.s_J2),g=p;let b=r*N.DotVV(y,y)+o*N.DotVV(v,v)+a*N.DotVV(g,g);if(0===b)continue;b=1/b;let x=f-this.m_as[e];for(;x>s;)x=(f-=2*s)-this.m_as[e];for(;x<-s;)x=(f+=2*s)-this.m_as[e];const S=-this.m_k3*b*x;t.SelfMulAdd(r*S,y),i.SelfMulAdd(o*S,v),n.SelfMulAdd(a*S,g)}}Draw(t){const e=new Z(.4,.5,.7);for(let i=0;i<this.m_count-1;++i)t.DrawSegment(this.m_ps[i],this.m_ps[i+1],e)}}Jn.s_d=new N,Jn.s_d1=new N,Jn.s_d2=new N,Jn.s_Jd1=new N,Jn.s_Jd2=new N,Jn.s_J1=new N,Jn.s_J2=new N,t.b2Assert=function(t,...e){if(!t)throw new Error(...e)},t.b2Maybe=e,t.b2_maxFloat=i,t.b2_epsilon=n,t.b2_epsilon_sq=r,t.b2_pi=s,t.b2_maxManifoldPoints=2,t.b2_maxPolygonVertices=8,t.b2_aabbExtension=o,t.b2_aabbMultiplier=2,t.b2_linearSlop=a,t.b2_angularSlop=l,t.b2_polygonRadius=u,t.b2_maxSubSteps=8,t.b2_maxTOIContacts=32,t.b2_velocityThreshold=1,t.b2_maxLinearCorrection=c,t.b2_maxAngularCorrection=h,t.b2_maxTranslation=2,t.b2_maxTranslationSquared=4,t.b2_maxRotation=m,t.b2_maxRotationSquared=_,t.b2_baumgarte=.2,t.b2_toiBaumgarte=.75,t.b2_invalidParticleIndex=f,t.b2_maxParticleIndex=2147483647,t.b2_particleStride=d,t.b2_minParticleWeight=1,t.b2_maxParticlePressure=p,t.b2_maxParticleForce=.5,t.b2_maxTriadDistance=2,t.b2_maxTriadDistanceSquared=4,t.b2_minParticleSystemBufferCapacity=y,t.b2_barrierCollisionTime=2.5,t.b2_timeToSleep=.5,t.b2_linearSleepTolerance=v,t.b2_angularSleepTolerance=g,t.b2Alloc=function(t){return null},t.b2Free=function(t){},t.b2Log=function(t,...e){},t.b2Version=b,t.b2_version=x,t.b2_branch="master",t.b2_commit="fbf51801d80fc389d43dc46524520e89043b6faf",t.b2ParseInt=function(t){return parseInt(t,10)},t.b2ParseUInt=function(t){return Math.abs(parseInt(t,10))},t.b2MakeArray=S,t.b2MakeNullArray=function(t){const e=[];for(let i=0;i<t;++i)e.push(null);return e},t.b2MakeNumberArray=w,t.b2_pi_over_180=B,t.b2_180_over_pi=C,t.b2_two_pi=A,t.b2Abs=V,t.b2Min=P,t.b2Max=M,t.b2Clamp=I,t.b2Swap=function(t,e){const i=t[0];t[0]=e[0],e[0]=i},t.b2IsValid=k,t.b2Sq=D,t.b2InvSqrt=G,t.b2Sqrt=T,t.b2Pow=F,t.b2DegToRad=function(t){return t*B},t.b2RadToDeg=function(t){return t*C},t.b2Cos=L,t.b2Sin=R,t.b2Acos=E,t.b2Asin=z,t.b2Atan2=O,t.b2NextPowerOfTwo=function(t){return t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,1+((t|=t>>8&16777215)|t>>16&65535)},t.b2IsPowerOfTwo=function(t){return t>0&&0==(t&t-1)},t.b2Random=function(){return 2*Math.random()-1},t.b2RandomRange=function(t,e){return(e-t)*Math.random()+t},t.b2Vec2=N,t.b2Vec2_zero=j,t.b2Vec3=q,t.b2Mat22=U,t.b2Mat33=J,t.b2Rot=W,t.b2Transform=X,t.b2Sweep=H,t.b2Color=Z,t.b2Draw=class{constructor(){this.m_drawFlags=0}SetFlags(t){this.m_drawFlags=t}GetFlags(){return this.m_drawFlags}AppendFlags(t){this.m_drawFlags|=t}ClearFlags(t){this.m_drawFlags&=~t}},t.b2Timer=$,t.b2Counter=class{constructor(){this.m_count=0,this.m_min_count=0,this.m_max_count=0}GetCount(){return this.m_count}GetMinCount(){return this.m_min_count}GetMaxCount(){return this.m_max_count}ResetCount(){const t=this.m_count;return this.m_count=0,t}ResetMinCount(){this.m_min_count=0}ResetMaxCount(){this.m_max_count=0}Increment(){this.m_count++,this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)}Decrement(){this.m_count--,this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)}},t.b2GrowableStack=Y,t.b2BlockAllocator=class{},t.b2StackAllocator=class{},t.b2ContactFeature=Ct,t.b2ContactID=At,t.b2ManifoldPoint=Vt,t.b2Manifold=Pt,t.b2WorldManifold=Mt,t.b2GetPointStates=function(e,i,n,r){let s;for(s=0;s<n.pointCount;++s){const i=n.points[s].id.key;e[s]=t.b2PointState.b2_removeState;for(let n=0,o=r.pointCount;n<o;++n)if(r.points[n].id.key===i){e[s]=t.b2PointState.b2_persistState;break}}for(;s<2;++s)e[s]=t.b2PointState.b2_nullState;for(s=0;s<r.pointCount;++s){const e=r.points[s].id.key;i[s]=t.b2PointState.b2_addState;for(let r=0,o=n.pointCount;r<o;++r)if(n.points[r].id.key===e){i[s]=t.b2PointState.b2_persistState;break}}for(;s<2;++s)i[s]=t.b2PointState.b2_nullState},t.b2ClipVertex=It,t.b2RayCastInput=kt,t.b2RayCastOutput=Dt,t.b2AABB=Gt,t.b2TestOverlapAABB=Tt,t.b2ClipSegmentToLine=Ft,t.b2TestOverlapShape=zt,t.b2DistanceProxy=K,t.b2SimplexCache=tt,t.b2DistanceInput=et,t.b2DistanceOutput=it,t.b2ShapeCastInput=class{constructor(){this.proxyA=new K,this.proxyB=new K,this.transformA=new X,this.transformB=new X,this.translationB=new N}},t.b2ShapeCastOutput=class{constructor(){this.point=new N,this.normal=new N,this.lambda=0,this.iterations=0}},t.b2_gjk_reset=function(){t.b2_gjkCalls=0,t.b2_gjkIters=0,t.b2_gjkMaxIters=0},t.b2SimplexVertex=nt,t.b2Simplex=rt,t.b2Distance=_t,t.b2ShapeCast=function(t,e){t.iterations=0,t.lambda=1,t.normal.SetZero(),t.point.SetZero();const i=e.proxyA,n=e.proxyB,r=M(i.m_radius,u)+M(n.m_radius,u),s=e.transformA,o=e.transformB,a=e.translationB,l=ft.Set(0,0);let c=0;const h=dt;h.m_count=0;const m=h.m_vertices;let _=i.GetSupport(W.MulTRV(s.q,N.NegV(a,N.s_t1),N.s_t0)),f=X.MulXV(s,i.GetVertex(_),pt),d=n.GetSupport(W.MulTRV(o.q,a,N.s_t0)),p=X.MulXV(o,n.GetVertex(d),yt);const y=N.SubVV(f,p,vt),v=M(u,r-u);let g=0;for(;g<20&&V(y.Length()-v)>.004;){t.iterations+=1,_=i.GetSupport(W.MulTRV(s.q,N.NegV(y,N.s_t1),N.s_t0)),f=X.MulXV(s,i.GetVertex(_),pt),d=n.GetSupport(W.MulTRV(o.q,y,N.s_t0)),p=X.MulXV(o,n.GetVertex(d),yt);const e=N.SubVV(f,p,gt);y.Normalize();const r=N.DotVV(y,e),u=N.DotVV(y,a);if(r-v>c*u){if(u<=0)return!1;if((c=(r-v)/u)>1)return!1;l.Copy(y).SelfNeg(),h.m_count=0}const b=m[h.m_count];switch(b.indexA=d,b.wA.Copy(p).SelfMulAdd(c,a),b.indexB=_,b.wB.Copy(f),b.w.Copy(b.wB).SelfSub(b.wA),b.a=1,h.m_count+=1,h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3()}if(3===h.m_count)return!1;h.GetClosestPoint(y),++g}const b=bt,x=xt;return h.GetWitnessPoints(b,x),y.LengthSquared()>0&&(l.Copy(y).SelfNeg(),l.Normalize()),t.normal.Copy(l),t.lambda=c,t.iterations=g,!0},t.b2Pair=qt,t.b2BroadPhase=Ut,t.b2PairLessThan=Jt,t.b2TreeNode=Nt,t.b2DynamicTree=jt,t.b2_toi_reset=function(){t.b2_toiTime=0,t.b2_toiMaxTime=0,t.b2_toiCalls=0,t.b2_toiIters=0,t.b2_toiMaxIters=0,t.b2_toiRootIters=0,t.b2_toiMaxRootIters=0},t.b2TOIInput=Kt,t.b2TOIOutput=ie,t.b2SeparationFunction=ne,t.b2TimeOfImpact=_e,t.b2CollideCircles=pe,t.b2CollidePolygonAndCircle=be,t.b2CollidePolygons=qe,t.b2CollideEdgeAndCircle=Ye,t.b2CollideEdgeAndPolygon=ni,t.b2MassData=ri,t.b2Shape=ui,t.b2CircleShape=ci,t.b2PolygonShape=hi,t.b2EdgeShape=mi,t.b2ChainShape=_i,t.b2Filter=fi,t.b2FixtureDef=di,t.b2FixtureProxy=pi,t.b2Fixture=yi,t.b2BodyDef=class{constructor(){this.type=t.b2BodyType.b2_staticBody,this.position=new N(0,0),this.angle=0,this.linearVelocity=new N(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.active=!0,this.userData=null,this.gravityScale=1}},t.b2Body=vi,t.b2World=zn,t.b2DestructionListener=class{SayGoodbyeJoint(t){}SayGoodbyeFixture(t){}SayGoodbyeParticleGroup(t){}SayGoodbyeParticle(t,e){}},t.b2ContactFilter=Hi,t.b2ContactImpulse=Zi,t.b2ContactListener=Qi,t.b2QueryCallback=$i,t.b2RayCastCallback=class{ReportFixture(t,e,i,n){return n}ReportParticle(t,e,i,n,r){return 0}ShouldQueryParticleSystem(t){return!0}},t.b2Island=mn,t.b2Profile=Ki,t.b2TimeStep=tn,t.b2Position=en,t.b2Velocity=nn,t.b2SolverData=rn,t.b2ContactManager=Yi,t.b2MixFriction=Fi,t.b2MixRestitution=Li,t.b2ContactEdge=Ri,t.b2Contact=Ei,t.b2ContactRegister=Wi,t.b2ContactFactory=Xi,t.g_blockSolve=sn,t.b2VelocityConstraintPoint=on,t.b2ContactVelocityConstraint=an,t.b2ContactPositionConstraint=ln,t.b2ContactSolverDef=un,t.b2PositionSolverManifold=cn,t.b2ContactSolver=hn,t.b2CircleContact=zi,t.b2PolygonContact=Oi,t.b2PolygonAndCircleContact=Ni,t.b2EdgeAndCircleContact=ji,t.b2EdgeAndPolygonContact=qi,t.b2ChainAndCircleContact=Ui,t.b2ChainAndPolygonContact=Ji,t.b2Jacobian=class{constructor(){this.linear=new N,this.angularA=0,this.angularB=0}SetZero(){return this.linear.SetZero(),this.angularA=0,this.angularB=0,this}Set(t,e,i){return this.linear.Copy(t),this.angularA=e,this.angularB=i,this}},t.b2JointEdge=gi,t.b2JointDef=bi,t.b2Joint=xi,t.b2AreaJointDef=class extends bi{constructor(){super(t.b2JointType.e_areaJoint),this.bodies=[],this.frequencyHz=0,this.dampingRatio=0}AddBody(t){this.bodies.push(t),1===this.bodies.length?this.bodyA=t:2===this.bodies.length&&(this.bodyB=t)}},t.b2AreaJoint=Bi,t.b2DistanceJointDef=Si,t.b2DistanceJoint=wi,t.b2FrictionJointDef=class extends bi{constructor(){super(t.b2JointType.e_frictionJoint),this.localAnchorA=new N,this.localAnchorB=new N,this.maxForce=0,this.maxTorque=0}Initialize(t,e,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB)}},t.b2FrictionJoint=Ci,t.b2GearJointDef=class extends bi{constructor(){super(t.b2JointType.e_gearJoint),this.ratio=1}},t.b2GearJoint=Ai,t.b2MotorJointDef=class extends bi{constructor(){super(t.b2JointType.e_motorJoint),this.linearOffset=new N(0,0),this.angularOffset=0,this.maxForce=1,this.maxTorque=1,this.correctionFactor=.3}Initialize(t,e){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);const i=this.bodyA.GetAngle(),n=this.bodyB.GetAngle();this.angularOffset=n-i}},t.b2MotorJoint=Vi,t.b2MouseJointDef=class extends bi{constructor(){super(t.b2JointType.e_mouseJoint),this.target=new N,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7}},t.b2MouseJoint=Pi,t.b2PrismaticJointDef=class extends bi{constructor(){super(t.b2JointType.e_prismaticJoint),this.localAnchorA=new N,this.localAnchorB=new N,this.localAxisA=new N(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0}Initialize(t,e,i,n){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(n,this.localAxisA),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}},t.b2PrismaticJoint=Mi,t.b2_minPulleyLength=2,t.b2PulleyJointDef=class extends bi{constructor(){super(t.b2JointType.e_pulleyJoint),this.groundAnchorA=new N(-1,1),this.groundAnchorB=new N(1,1),this.localAnchorA=new N(-1,0),this.localAnchorB=new N(1,0),this.lengthA=0,this.lengthB=0,this.ratio=1,this.collideConnected=!0}Initialize(t,e,i,n,r,s,o){this.bodyA=t,this.bodyB=e,this.groundAnchorA.Copy(i),this.groundAnchorB.Copy(n),this.bodyA.GetLocalPoint(r,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.lengthA=N.DistanceVV(r,i),this.lengthB=N.DistanceVV(s,n),this.ratio=o}},t.b2PulleyJoint=Ii,t.b2RevoluteJointDef=class extends bi{constructor(){super(t.b2JointType.e_revoluteJoint),this.localAnchorA=new N(0,0),this.localAnchorB=new N(0,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerAngle=0,this.upperAngle=0,this.enableMotor=!1,this.motorSpeed=0,this.maxMotorTorque=0}Initialize(t,e,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}},t.b2RevoluteJoint=ki,t.b2RopeJointDef=class extends bi{constructor(){super(t.b2JointType.e_ropeJoint),this.localAnchorA=new N(-1,0),this.localAnchorB=new N(1,0),this.maxLength=0}},t.b2RopeJoint=Di,t.b2WeldJointDef=class extends bi{constructor(){super(t.b2JointType.e_weldJoint),this.localAnchorA=new N,this.localAnchorB=new N,this.referenceAngle=0,this.frequencyHz=0,this.dampingRatio=0}Initialize(t,e,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}},t.b2WeldJoint=Gi,t.b2WheelJointDef=class extends bi{constructor(){super(t.b2JointType.e_wheelJoint),this.localAnchorA=new N(0,0),this.localAnchorB=new N(0,0),this.localAxisA=new N(1,0),this.enableMotor=!1,this.maxMotorTorque=0,this.motorSpeed=0,this.frequencyHz=2,this.dampingRatio=.7}Initialize(t,e,i,n){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(n,this.localAxisA)}},t.b2WheelJoint=Ti,t.b2ControllerEdge=On,t.b2Controller=Nn,t.b2BuoyancyController=class extends Nn{constructor(){super(...arguments),this.normal=new N(0,1),this.offset=0,this.density=0,this.velocity=new N(0,0),this.linearDrag=0,this.angularDrag=0,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=new N(0,0)}Step(t){if(this.m_bodyList){this.useWorldGravity&&this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity());for(let t=this.m_bodyList;t;t=t.nextBody){const e=t.body;if(!e.IsAwake())continue;const i=new N,r=new N;let s=0,o=0;for(let t=e.GetFixtureList();t;t=t.m_next){const n=new N,a=t.GetShape().ComputeSubmergedArea(this.normal,this.offset,e.GetTransform(),n);s+=a,i.x+=a*n.x,i.y+=a*n.y;let l=0;l=this.useDensity?t.GetDensity():1,o+=a*l,r.x+=a*n.x*l,r.y+=a*n.y*l}if(i.x/=s,i.y/=s,r.x/=o,r.y/=o,s<n)continue;const a=this.gravity.Clone().SelfNeg();a.SelfMul(this.density*s),e.ApplyForce(a,r);const l=e.GetLinearVelocityFromWorldPoint(i,new N);l.SelfSub(this.velocity),l.SelfMul(-this.linearDrag*s),e.ApplyForce(l,i),e.ApplyTorque(-e.GetInertia()/e.GetMass()*s*e.GetAngularVelocity()*this.angularDrag)}}}Draw(t){const e=100,i=new N,n=new N;i.x=this.normal.x*this.offset+this.normal.y*e,i.y=this.normal.y*this.offset-this.normal.x*e,n.x=this.normal.x*this.offset-this.normal.y*e,n.y=this.normal.y*this.offset+this.normal.x*e;const r=new Z(0,0,.8);t.DrawSegment(i,n,r)}},t.b2ConstantAccelController=jn,t.b2ConstantForceController=class extends Nn{constructor(){super(...arguments),this.F=new N(0,0)}Step(t){for(let e=this.m_bodyList;e;e=e.nextBody){const t=e.body;t.IsAwake()&&t.ApplyForce(this.F,t.GetWorldCenter())}}Draw(t){}},t.b2GravityController=qn,t.b2TensorDampingController=Un,t.b2ParticleDef=pn,t.b2CalculateParticleIterations=yn,t.b2ParticleHandle=vn,t.b2ParticleGroupDef=gn,t.b2ParticleGroup=bn,t.b2GrowableBuffer=kn,t.b2FixtureParticleQueryCallback=Dn,t.b2ParticleContact=Gn,t.b2ParticleBodyContact=Tn,t.b2ParticlePair=Fn,t.b2ParticleTriad=Ln,t.b2ParticleSystemDef=Rn,t.b2ParticleSystem=En,t.b2RopeDef=class{constructor(){this.vertices=[],this.count=0,this.masses=[],this.gravity=new N(0,0),this.damping=.1,this.k2=.9,this.k3=.1}},t.b2Rope=Jn,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,i){t.exports=e.exports},function(t,e,i){var n=i(4);function r(){}function s(){}s.resetWarningCache=r,t.exports=function(){function t(t,e,i,r,s,o){if(o!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var i={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:s,resetWarningCache:r};return i.PropTypes=i,i}},function(t,e,i){t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,i){i.r(e);var n=i(2),r=i.n(n),s=i(0),o=i.n(s),a=i(1),l=function(t,e){return t*e},u=function(t,e){return t/e},c=function(t,e,i,n){return{x:t+i/2,y:e+n/2}},h=function(t,e,i,n,r,s,o){var a,u,c,h=(u=l(n,o),c=l(r,o),{left:u-e/2,top:c-i/2}),m=h.top;a="translate(".concat(h.left,"px,").concat(m,"px) rotate(").concat(s,"rad)"),t.style.transform=a},m=function(t,e,i){return t.TWO_NUMBERS_OPTIONAL?Array.isArray(t[e])&&2==t[e].length&&t[e].every(Number.isFinite)?null:new Error("".concat(e," needs to be an array of two numbers")):null};function _(){return this.contact.GetFixtureA().m_body.GetUserData().category}function f(){return this.contact.GetFixtureB().m_body.GetUserData().category}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var x=r.a.createContext(),S=x.Provider,w=(x.Consumer,function(t){function e(t){var i,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=y(e).call(this,t),i=!n||"object"!==d(n)&&"function"!=typeof n?v(this):n,b(v(i),"renderPhysics",(function(){for(var t=i.world.m_bodyList;t;t=t.m_next)if(t.IsAwake()){var e=t.GetUserData();if(e&&e.dom)if(e.removed)i.world.DestroyBody(t);else{var n=t.GetPosition(),r=n.x,s=n.y,o=t.GetAngle();e.rc&&h(e.dom,e.rc.width,e.rc.height,r,s,o,i.SCALE)}}})),b(v(i),"physLoop",(function(){i.rafId=void 0,i.world.Step(1/60,10,10),i.world.ClearForces(),i.renderPhysics(),i.physLoopStart()})),b(v(i),"physLoopStart",(function(){i.rafId||(i.rafId=window.requestAnimationFrame(i.physLoop))}));var r=t.width,s=t.height,o=t.gravity,l=void 0===o?[0,10]:o,c=t.allowSleep,m=void 0===c||c,p=t.scaleFactor,g=void 0===p?60:p,x=t.enclosed,S=void 0===x||x,w=t.enclosureThickness,B=void 0===w?3:w,C=(t.children,t.style),A=void 0===C?{}:C,V=function(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},s=Object.keys(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}(t,["width","height","gravity","allowSleep","scaleFactor","enclosed","enclosureThickness","children","style"]);i.restProps=V,i.SCALE=g,i.world=new a.b2World(new a.b2Vec2(l[0],l[1]),m),window.world=i.world,S&&function(t,e,i,n,r){var s=new a.b2BodyDef;s.type=a.b2BodyType.b2_staticBody;var o=new a.b2FixtureDef;o.shape=new a.b2PolygonShape,o.density=1,o.friction=.5,o.restitution=0,o.shape.SetAsBox(u(i/2,r),u(e/2,r)),s.position.x=u(i/2,r),s.position.y=u(e/2,r);var l=n.CreateBody(s).CreateFixture(o);l.m_body.SetUserData({category:"_LEFT_WALL_"}),o.shape.SetAsBox(u(t/2,r),u(i/2,r)),s.position.x=u(t/2,r),s.position.y=u(e,r),(l=n.CreateBody(s).CreateFixture(o)).m_body.SetUserData({category:"_BOTTOM_WALL_"}),o.shape.SetAsBox(u(t/2,r),u(i/2,r)),s.position.x=u(t/2,r),s.position.y=u(i/2,r),(l=n.CreateBody(s).CreateFixture(o)).m_body.SetUserData({category:"_TOP_WALL_"}),o.shape.SetAsBox(u(i/2,r),u(e/2,r)),s.position.x=u(t,r),s.position.y=u(e/2,r),(l=n.CreateBody(s).CreateFixture(o)).m_body.SetUserData({category:"_RIGHT_WALL_"})}(r,s,B,i.world,i.SCALE),i.worldChangeStatus=0,i._contactCbProcess=function(t,e){var n=i.SCALE,r=t.GetFixtureA().m_body.GetUserData();r&&(r[e]=!0);var s={SCALE:n,contact:t};r&&r.rc&&r.rc.props[e]&&(s.getOthersCategory=f,r.rc.props[e](s));var o=t.GetFixtureB().m_body.GetUserData();o&&(o[e]=!0),o&&o.rc&&o.rc.props[e]&&(s.getOthersCategory=_,o.rc.props[e](s))},i._contactListener={BeginContact:function(t){i._contactCbProcess(t,"onBeginContact")},EndContact:function(t){i._contactCbProcess(t,"onEndContact")},PreSolve:function(t,e){},PostSolve:function(t,e){}},i.world.SetContactListener(i._contactListener);var P={width:r,height:s,position:"relative",overlow:"hidden",boxSizing:"border-box",padding:B};return i.worldStyle=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){b(t,e,i[e])}))}return t}({},P,A),i}var i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,n.Component),(i=[{key:"componentDidMount",value:function(){this.physLoopStart()}},{key:"componentWillUnmount",value:function(){this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0)}},{key:"render",value:function(){var t=this.props,e=t.className,i=void 0===e?"Box2dWorld":e,n=t.children;return r.a.createElement("div",p({className:i},this.restProps,{style:this.worldStyle}),r.a.createElement(S,{value:this},n))}}])&&function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,i),e}());w.propTypes={width:o.a.number.isRequired,height:o.a.number.isRequired,gravity:m,enclosed:o.a.bool,allowSleep:o.a.bool,scaleFactor:o.a.number,enclosureThickness:o.a.number};var B=w;function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){G(t,e,i[e])}))}return t}function V(){return(V=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(l){r=!0,s=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function M(t,e,i,n,r,s,o){try{var a=t[s](o),l=a.value}catch(u){return void i(u)}a.done?e(l):Promise.resolve(l).then(n,r)}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function G(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var T=function(t){var e=t.body,i=t.gravityScale,r=void 0===i?1:i,s=t.sleep,o=void 0===s||s;return Object(n.useEffect)((function(){e&&(e.SetGravityScale(r),e.SetLinearDamping(.8))}),[e,r]),Object(n.useEffect)((function(){e&&e.SetSleepingAllowed(o)}),[e,o]),null},F=function(t){function e(t){var i,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this,n=I(e).call(this,t),i=!n||"object"!==C(n)&&"function"!=typeof n?k(this):n,G(k(i),"createFixturesForInline",(function(t,e,n){for(var r=i.context,s=i.el.getBoundingClientRect(),o=i.el.offsetWidth/2,l=s.height/2,c=r.SCALE,h=Array.from(n).filter((function(t){return t.width>0&&t.height>0})),m=s.left,_=(s.top,h[0]),f=0;f<h.length;f++){var d=h[f],p=(d.left-m+(d.right-m))/2-o,y=d.top-_.top+d.height/2-l;t.shape=new a.b2PolygonShape,t.shape.SetAsBox(u(d.width/2,c),u(d.height/2,c),new a.b2Vec2(u(p,c),u(y,c))),e.CreateFixture(t)}})),G(k(i),"physicsInit",function(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var s=t.apply(e,i);function o(t){M(s,n,r,o,a,"next",t)}function a(t){M(s,n,r,o,a,"throw",t)}o(void 0)}))}}(regeneratorRuntime.mark((function t(){var e,n,r,s,o,l,h,m,_,f,d,p,y,v,g,b,x,S,w,B,C,A,V,P,M,I,D,G,T,F,L,R,E,z,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.props,n=e.fixed,r=void 0!==n&&n,s=e.restitution,o=void 0===s?.1:s,l=e.friction,h=void 0===l?.5:l,m=e.density,_=void 0===m?1:m,f=e.shape,d=void 0===f?"box":f,p=e.category,y=void 0===p?null:p,v=e.data,g=e.width,b=e.height,x=e.left,S=e.top,w=e.initialForce,B=e.initialImpulse,C=e.bullet,A=i.context,(V=new a.b2BodyDef).type=r?a.b2BodyType.b2_staticBody:a.b2BodyType.b2_dynamicBody,(P=new a.b2FixtureDef).shape=new a.b2PolygonShape,P.density=_,P.friction=h,P.restitution=o,M=A.SCALE,i.el.style.overflow="visible",I=g||i.el.offsetWidth,D=b||i.el.offsetHeight,G="left"in i.props?x:i.el.offsetLeft,T="top"in i.props?S:i.el.offsetTop,i.width=I,i.height=D,F=c(G,T,I,D),L=F.x,R=F.y,V.position.x=u(L,A.SCALE),V.position.y=u(R,A.SCALE),E=A.world.CreateBody(V),"box"!==d){t.next=23;break}(z=i.el.getClientRects()).length>1?(console.log("inline element detected",z),i.createFixturesForInline(P,E,z)):(P.shape=new a.b2PolygonShape,P.shape.SetAsBox(u(I/2,M),u(D/2,M)),E.CreateFixture(P)),t.next=32;break;case 23:if("circle"!==d){t.next=31;break}if(D==I){t.next=26;break}throw new Error("For shape circle, height and width should be same");case 26:P.shape=new a.b2CircleShape(u(D/2,M)),E.CreateFixture(P),i.setState({circleRadius:D/2}),t.next=32;break;case 31:throw new Error("Unknown shape ".concat(d,", only box and circle supported for now"));case 32:O={category:y,dom:i.el,rc:k(i)},v&&(O.data=v),E.SetUserData(O),i.body=E,C&&i.body.SetBullet(C),w&&i.applyForce(w),B&&i.applyImpulse(B),i.setState({domHeight:D,domWidth:I,physicsInited:!0});case 40:case"end":return t.stop()}}),t)})))),G(k(i),"applyForce",(function(t){var e=P(t,2),n=e[0],r=e[1];i.body&&i.body.ApplyForce(new a.b2Vec2(n,r),i.body.GetWorldCenter())})),G(k(i),"applyImpulse",(function(t){var e=P(t,2),n=e[0],r=e[1];i.body&&i.body.ApplyLinearImpulse(new a.b2Vec2(n,r),i.body.GetWorldCenter())})),i.state={physicsInited:!1,domWidth:null,domHeight:null,circleRadius:null},i.width=null,i.height=null,i}var i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(e,n.Component),(i=[{key:"componentWillUnmount",value:function(){if(this.body){var t=this.body.GetUserData();t.removed=!0,this.body.SetUserData(t),this.body.SetAwake(!0)}}},{key:"componentDidMount",value:function(){"waitFor"in this.props?this.props.waitFor&&this.physicsInit():this.physicsInit()}},{key:"componentDidUpdate",value:function(t,e){"waitFor"in this.props&&(this.state.physicsInited||this.props.waitFor&&this.physicsInit())}},{key:"render",value:function(){var t=this,e=this.state,i=e.physicsInited,s=e.domHeight,o=e.domWidth,a=e.circleRadius,l=this.props.hideUntil,u=void 0===l||l,c=this.props.children.props.style,h=void 0===c?{}:c,m=i?{position:"absolute",display:"block",left:0,top:0,height:s,width:o,willChange:"transform"}:u?{visibility:"hidden"}:{};return i&&a&&(m.borderRadius=a),r.a.createElement(n.Fragment,null,r.a.createElement(T,V({body:this.body},this.props)),r.a.cloneElement(this.props.children,{ref:function(e){t.el=e},style:A({},h,m)}))}}])&&function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,i),e}();G(F,"_internalType","Box2dObject"),F.propTypes={children:o.a.element.isRequired,height:o.a.number,width:o.a.number,left:o.a.number,top:o.a.number,density:o.a.number,friction:o.a.number,restitution:o.a.number,bullet:o.a.bool,onBeginContact:o.a.func,onEndContact:o.a.func,shape:o.a.oneOf(["circle","box"]),initialForce:m,initialImpulse:m,category:o.a.string},F.contextType=x;var L=F;i.d(e,"World",(function(){return R})),i.d(e,"Item",(function(){return E}));var R=B,E=L;e.default={World:R,Item:E}}]),Yu={},Ku={};function tc(){}function ec(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return sc(this,e.join(" "))}function ic(t,e){if(!rc(t))throw new Error("kremling maybe() must be called with a string className and a boolean expression");return sc(this,e?t:"")}function nc(t,e,i){if(!rc(t)||!rc(e))throw new Error("kremling toggle() must be called with 2 string classNames and a boolean expression");return sc(this,i?t:e)}function rc(t){return"string"==typeof t||t instanceof String}function sc(t,e){var i=t instanceof String?t.toString():"",n=new String([i,e].join(" ").trim());return n.css=tc.bind(n),n.c=n.css,n.always=ec.bind(n),n.a=n.always,n.maybe=ic.bind(n),n.m=n.maybe,n.toggle=nc.bind(n),n.t=n.toggle,n}Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.c=Ku.css=tc,Ku.a=Ku.always=ec,Ku.m=Ku.maybe=ic,Ku.t=Ku.toggle=nc;var oc={},ac={exports:{}};function lc(){}function uc(){}uc.resetWarningCache=lc;ac.exports=function(){function t(t,e,i,n,r,s){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==s){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function e(){return t}t.isRequired=t;var i={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:uc,resetWarningCache:lc};return i.PropTypes=i,i}();var cc={};Object.defineProperty(cc,"__esModule",{value:!0}),cc.resetState=function(){hc=0,cc.styleTags=mc={}},cc.transformCss=function(t,e){return t.replace(/& ([^{}])+{/g,(function(t,i){return t.split(",").map((function(t){if(-1===(t=t.trim()).indexOf("&"))return t.replace("{","").trim();t=/[^&](.+)[^{]+/g.exec(t)[0].trim();var i=!1;return/^([.#]\w+)/.test(t)||(i=!0),i?"".concat(e," ").concat(t,", ").concat(t).concat(e):"".concat(e," ").concat(t,", ").concat(e).concat(t)})).join(", ")+" {"}))},cc.styleTags=cc.incrementCounter=void 0;var hc=0;cc.incrementCounter=function(){return hc++};var mc={};cc.styleTags=mc,Object.defineProperty(oc,"__esModule",{value:!0}),oc.Scoped=void 0;var _c=yc(e.exports),fc=yc(z.exports),dc=ac.exports,pc=cc;function yc(t){return t&&t.__esModule?t:{default:t}}function vc(t){return(vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gc(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bc(t,e){return(bc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Bc(t);if(e){var r=Bc(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Sc(this,i)}}function Sc(t,e){return!e||"object"!==vc(e)&&"function"!=typeof e?wc(t):e}function wc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bc(t){return(Bc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cc(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Ac=!!fc.default.createPortal,Vc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bc(t,e)}(s,_c["default"].Component);var e,i,n,r=xc(s);function s(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),Cc(wc(e=r.call(this,t)),"addKremlingAttributeToChildren",(function(t){return _c.default.Children.map(t,(function(t){if(_c.default.isValidElement(t)){if(t.type===_c.default.Fragment&&_c.default.Fragment){var i=e.addKremlingAttributeToChildren(t.props.children);return _c.default.cloneElement(t,{},i)}return _c.default.cloneElement(t,Cc({},e.state.kremlingAttr,e.state.kremlingAttrValue))}return t}))})),Cc(wc(e),"doneWithCss",(function(){e.state.styleRef&&0==--e.state.styleRef.kremlings&&(delete pc.styleTags[e.state.rawCss],e.state.styleRef.parentNode.removeChild(e.state.styleRef))})),e.state={},!t.css)throw Error("Kremling's <Scoped /> component requires the 'css' prop.");if("object"===vc(t.css)&&("string"!=typeof t.css.id||"string"!=typeof t.css.styles))throw Error('Kremling\'s <Scoped /> component requires either a string or an object with "id" and "styles" properties.');return e.state=e.newCssState(t),e}return e=s,(i=[{key:"render",value:function(){if(void 0===this.props.children||null===this.props.children||!1===this.props.children||!0===this.props.children)return null;var t=this.addKremlingAttributeToChildren(this.props.children);if(Ac)return t;if(t.length>1)throw new Error("kremling's <Scoped /> component requires exactly one child element unless you are using react@>=16");return 1===t.length?t[0]:null}},{key:"componentDidUpdate",value:function(t){var e=t.postcss||t.css,i=this.props.postcss||this.props.css;e===i&&e.id===i.id&&e.styles===i.styles&&e.namespace===i.namespace||(this.doneWithCss(),this.setState(this.newCssState(this.props)))}},{key:"componentWillUnmount",value:function(){this.doneWithCss()}},{key:"newCssState",value:function(t){var e,i,n,r=t.postcss||t.css,o=Boolean(r&&r.id),a=(o?r.namespace:t.namespace)||s.defaultNamespace,l=o?r.styles:r;if(!o){if("string"!=typeof r)return;if(r.indexOf("&")<0&&r.trim().length>0){var u=r.substring(0,t.css.indexOf("{")).trim();console.warn("Kremling's <Scoped css=\"...\"> css prop should have the '&' character in it to scope the css classes: ".concat(u))}}var c=pc.styleTags[l];if(c)e=c,c.kremlings++,i=e.kremlingAttr,n=e.kremlingValue;else{i=a,n=o?r.id:(0,pc.incrementCounter)();var h="[".concat(i,'="').concat(n,'"]'),m=o?l:(0,pc.transformCss)(l,h),_=document.createElement("style");_.setAttribute("type","text/css"),_.textContent=m,_.kremlings=1,_.kremlingAttr=i,_.kremlingValue=n,document.head.appendChild(_),pc.styleTags[l]=_,e=_}return{isPostCss:o,rawCss:l,styleRef:e,kremlingAttr:i,kremlingAttrValue:n}}}])&&gc(e.prototype,i),n&&gc(e,n),s}();oc.Scoped=Vc,Cc(Vc,"propTypes",{css:(0,dc.oneOfType)([dc.string,dc.object]),postcss:dc.object,namespace:dc.string}),Cc(Vc,"defaultNamespace","kremling");var Pc={};Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.useCss=function(t,e){var i="object"===Gc(t);if(i&&(!t.id||"string"!=typeof t.styles))throw Error('Kremling\'s "useCss" hook requires "id" and "styles" properties when using the kremling-loader');var n=e||i&&t.namespace||Ic.Scoped.defaultNamespace,r=(a=(0,Mc.useState)((function(){return Tc(i,t,n,!0)})),l=2,function(t){if(Array.isArray(t))return t}(a)||function(t,e){var i=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=i){var n,r,s=[],o=!0,a=!1;try{for(i=i.call(t);!(o=(n=i.next()).done)&&(s.push(n.value),!e||s.length!==e);o=!0);}catch(l){a=!0,r=l}finally{try{o||null==i.return||i.return()}finally{if(a)throw r}}return s}}(a,l)||function(t,e){if(t){if("string"==typeof t)return Dc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Dc(t,e):void 0}}(a,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=r[0],o=r[1];var a,l;return function(){(0,Mc.useLayoutEffect)((function(){var e=Tc(i,t,n);return o(e),function(){if(0==--s.kremlings){var e=i?t.styles:t;document.head.removeChild(s),delete kc.styleTags[e]}}}),[t,n,i])}(),function(t,e,i){e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i;return t}({},s.kremlingAttr,String(s.kremlingValue).toString())};var Mc=e.exports,Ic=oc,kc=cc;function Dc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Gc(t){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tc(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t?i:"data-".concat(i),s=t?e.id:(0,kc.incrementCounter)(),o=t?kc.styleTags[e.styles]:kc.styleTags[e];if(o)n&&o.kremlings++;else{var a="[".concat(r,"='").concat(s,"']"),l=t?e.styles:e,u=t?e.styles:(0,kc.transformCss)(e,a);(o=document.createElement("style")).type="text/css",o.textContent=u,o.kremlings=1,o.kremlingAttr=r,o.kremlingValue=s,document.head.appendChild(o),kc.styleTags[l]=o}return o}var Fc={};function Lc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==i)return;var n,r,s=[],o=!0,a=!1;try{for(i=i.call(t);!(o=(n=i.next()).done)&&(s.push(n.value),!e||s.length!==e);o=!0);}catch(l){a=!0,r=l}finally{try{o||null==i.return||i.return()}finally{if(a)throw r}}return s}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Rc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Rc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.k=void 0;function Ec(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function zc(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}Fc.k=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r=t.map((function(t,e){return"".concat(t).concat(i[e]||"")})).join(""),s=r.split("||KREMLING||"),o=Lc(s,3),a=o[0],l=o[1],u=o[2];return a&&l&&u?{id:a,namespace:l,styles:u}:r},function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"always",{enumerable:!0,get:function(){return e.always}}),Object.defineProperty(t,"a",{enumerable:!0,get:function(){return e.a}}),Object.defineProperty(t,"maybe",{enumerable:!0,get:function(){return e.maybe}}),Object.defineProperty(t,"m",{enumerable:!0,get:function(){return e.m}}),Object.defineProperty(t,"toggle",{enumerable:!0,get:function(){return e.toggle}}),Object.defineProperty(t,"t",{enumerable:!0,get:function(){return e.t}}),Object.defineProperty(t,"css",{enumerable:!0,get:function(){return e.css}}),Object.defineProperty(t,"c",{enumerable:!0,get:function(){return e.c}}),Object.defineProperty(t,"Scoped",{enumerable:!0,get:function(){return i.Scoped}}),Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return n.useCss}}),Object.defineProperty(t,"k",{enumerable:!0,get:function(){return r.k}});var e=Ku,i=oc,n=Pc,r=Fc}(Yu);var Oc="undefined"!=typeof window,Nc=function(t){e.exports.useEffect(t,[])},jc=function(t){var i=e.exports.useRef(t);i.current=t,Nc((function(){return function(){return i.current()}}))},qc=function(t){var i=e.exports.useRef(0),n=e.exports.useState(t),r=n[0],s=n[1],o=e.exports.useCallback((function(t){cancelAnimationFrame(i.current),i.current=requestAnimationFrame((function(){s(t)}))}),[]);return jc((function(){cancelAnimationFrame(i.current)})),[r,o]},Uc=function(t){var i=qc({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=i[0],r=i[1];return e.exports.useEffect((function(){var e=function(e){if(t&&t.current){var i=t.current.getBoundingClientRect(),n=i.left,s=i.top,o=i.width,a=i.height,l=n+window.pageXOffset,u=s+window.pageYOffset,c=e.pageX-l,h=e.pageY-u;r({docX:e.pageX,docY:e.pageY,posX:l,posY:u,elX:c,elY:h,elH:a,elW:o})}};return Ec(document,"mousemove",e),function(){zc(document,"mousemove",e)}}),[t]),n},Jc={exports:{}},Wc={},Xc=e.exports,Hc=60103;if(Wc.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var Zc=Symbol.for;Hc=Zc("react.element"),Wc.Fragment=Zc("react.fragment")}var Qc=Xc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$c=Object.prototype.hasOwnProperty,Yc={key:!0,ref:!0,__self:!0,__source:!0};function Kc(t,e,i){var n,r={},s=null,o=null;for(n in void 0!==i&&(s=""+i),void 0!==e.key&&(s=""+e.key),void 0!==e.ref&&(o=e.ref),e)$c.call(e,n)&&!Yc.hasOwnProperty(n)&&(r[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===r[n]&&(r[n]=e[n]);return{$$typeof:Hc,type:t,key:s,ref:o,props:r,_owner:Qc.current}}Wc.jsx=Kc,Wc.jsxs=Kc,Jc.exports=Wc;const th=Jc.exports.jsx,eh=Jc.exports.jsxs;var ih,nh,rh=function(t,i){void 0===t&&(t=1/0),void 0===i&&(i=1/0);var n=qc({width:Oc?window.innerWidth:t,height:Oc?window.innerHeight:i}),r=n[0],s=n[1];return e.exports.useEffect((function(){if(Oc){var t=function(){s({width:window.innerWidth,height:window.innerHeight})};return Ec(window,"resize",t),function(){zc(window,"resize",t)}}}),[]),r},sh={exports:{}};
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
ih=sh,nh=sh.exports,function(){var e,i="Expected a function",n="__lodash_hash_undefined__",r="__lodash_placeholder__",s=16,o=32,a=64,l=128,u=256,c=1/0,h=9007199254740991,m=NaN,_=4294967295,f=[["ary",l],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",o],["partialRight",a],["rearg",u]],d="[object Arguments]",p="[object Array]",y="[object Boolean]",v="[object Date]",g="[object Error]",b="[object Function]",x="[object GeneratorFunction]",S="[object Map]",w="[object Number]",B="[object Object]",C="[object Promise]",A="[object RegExp]",V="[object Set]",P="[object String]",M="[object Symbol]",I="[object WeakMap]",k="[object ArrayBuffer]",D="[object DataView]",G="[object Float32Array]",T="[object Float64Array]",F="[object Int8Array]",L="[object Int16Array]",R="[object Int32Array]",E="[object Uint8Array]",z="[object Uint8ClampedArray]",O="[object Uint16Array]",N="[object Uint32Array]",j=/\b__p \+= '';/g,q=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,J=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,X=RegExp(J.source),H=RegExp(W.source),Z=/<%-([\s\S]+?)%>/g,Q=/<%([\s\S]+?)%>/g,$=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,K=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,it=RegExp(et.source),nt=/^\s+/,rt=/\s/,st=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ot=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ut=/[()=,{}\[\]\/\s]/,ct=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mt=/\w*$/,_t=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,dt=/^\[object .+?Constructor\]$/,pt=/^0o[0-7]+$/i,yt=/^(?:0|[1-9]\d*)$/,vt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gt=/($^)/,bt=/['\n\r\u2028\u2029\\]/g,xt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",St="\\u2700-\\u27bf",wt="a-z\\xdf-\\xf6\\xf8-\\xff",Bt="A-Z\\xc0-\\xd6\\xd8-\\xde",Ct="\\ufe0e\\ufe0f",At="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Vt="['’]",Pt="[\\ud800-\\udfff]",Mt="["+At+"]",It="["+xt+"]",kt="\\d+",Dt="[\\u2700-\\u27bf]",Gt="["+wt+"]",Tt="[^\\ud800-\\udfff"+At+kt+St+wt+Bt+"]",Ft="\\ud83c[\\udffb-\\udfff]",Lt="[^\\ud800-\\udfff]",Rt="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",zt="["+Bt+"]",Ot="(?:"+Gt+"|"+Tt+")",Nt="(?:"+zt+"|"+Tt+")",jt="(?:['’](?:d|ll|m|re|s|t|ve))?",qt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ut="(?:"+It+"|"+Ft+")?",Jt="[\\ufe0e\\ufe0f]?",Wt=Jt+Ut+"(?:\\u200d(?:"+[Lt,Rt,Et].join("|")+")"+Jt+Ut+")*",Xt="(?:"+[Dt,Rt,Et].join("|")+")"+Wt,Ht="(?:"+[Lt+It+"?",It,Rt,Et,Pt].join("|")+")",Zt=RegExp(Vt,"g"),Qt=RegExp(It,"g"),$t=RegExp(Ft+"(?="+Ft+")|"+Ht+Wt,"g"),Yt=RegExp([zt+"?"+Gt+"+"+jt+"(?="+[Mt,zt,"$"].join("|")+")",Nt+"+"+qt+"(?="+[Mt,zt+Ot,"$"].join("|")+")",zt+"?"+Ot+"+"+jt,zt+"+"+qt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",kt,Xt].join("|"),"g"),Kt=RegExp("[\\u200d\\ud800-\\udfff"+xt+Ct+"]"),te=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ee=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ie=-1,ne={};ne[G]=ne[T]=ne[F]=ne[L]=ne[R]=ne[E]=ne[z]=ne[O]=ne[N]=!0,ne[d]=ne[p]=ne[k]=ne[y]=ne[D]=ne[v]=ne[g]=ne[b]=ne[S]=ne[w]=ne[B]=ne[A]=ne[V]=ne[P]=ne[I]=!1;var re={};re[d]=re[p]=re[k]=re[D]=re[y]=re[v]=re[G]=re[T]=re[F]=re[L]=re[R]=re[S]=re[w]=re[B]=re[A]=re[V]=re[P]=re[M]=re[E]=re[z]=re[O]=re[N]=!0,re[g]=re[b]=re[I]=!1;var se={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},oe=parseFloat,ae=parseInt,le="object"==typeof t&&t&&t.Object===Object&&t,ue="object"==typeof self&&self&&self.Object===Object&&self,ce=le||ue||Function("return this")(),he=nh&&!nh.nodeType&&nh,me=he&&ih&&!ih.nodeType&&ih,_e=me&&me.exports===he,fe=_e&&le.process,de=function(){try{var t=me&&me.require&&me.require("util").types;return t||fe&&fe.binding&&fe.binding("util")}catch(e){}}(),pe=de&&de.isArrayBuffer,ye=de&&de.isDate,ve=de&&de.isMap,ge=de&&de.isRegExp,be=de&&de.isSet,xe=de&&de.isTypedArray;function Se(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function we(t,e,i,n){for(var r=-1,s=null==t?0:t.length;++r<s;){var o=t[r];e(n,o,i(o),t)}return n}function Be(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}function Ce(t,e){for(var i=null==t?0:t.length;i--&&!1!==e(t[i],i,t););return t}function Ae(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function Ve(t,e){for(var i=-1,n=null==t?0:t.length,r=0,s=[];++i<n;){var o=t[i];e(o,i,t)&&(s[r++]=o)}return s}function Pe(t,e){return!(null==t||!t.length)&&Ee(t,e,0)>-1}function Me(t,e,i){for(var n=-1,r=null==t?0:t.length;++n<r;)if(i(e,t[n]))return!0;return!1}function Ie(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}function ke(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}function De(t,e,i,n){var r=-1,s=null==t?0:t.length;for(n&&s&&(i=t[++r]);++r<s;)i=e(i,t[r],r,t);return i}function Ge(t,e,i,n){var r=null==t?0:t.length;for(n&&r&&(i=t[--r]);r--;)i=e(i,t[r],r,t);return i}function Te(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}var Fe=je("length");function Le(t,e,i){var n;return i(t,(function(t,i,r){if(e(t,i,r))return n=i,!1})),n}function Re(t,e,i,n){for(var r=t.length,s=i+(n?1:-1);n?s--:++s<r;)if(e(t[s],s,t))return s;return-1}function Ee(t,e,i){return e==e?function(t,e,i){for(var n=i-1,r=t.length;++n<r;)if(t[n]===e)return n;return-1}(t,e,i):Re(t,Oe,i)}function ze(t,e,i,n){for(var r=i-1,s=t.length;++r<s;)if(n(t[r],e))return r;return-1}function Oe(t){return t!=t}function Ne(t,e){var i=null==t?0:t.length;return i?Je(t,e)/i:m}function je(t){return function(i){return null==i?e:i[t]}}function qe(t){return function(i){return null==t?e:t[i]}}function Ue(t,e,i,n,r){return r(t,(function(t,r,s){i=n?(n=!1,t):e(i,t,r,s)})),i}function Je(t,i){for(var n,r=-1,s=t.length;++r<s;){var o=i(t[r]);o!==e&&(n=n===e?o:n+o)}return n}function We(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function Xe(t){return t?t.slice(0,ci(t)+1).replace(nt,""):t}function He(t){return function(e){return t(e)}}function Ze(t,e){return Ie(e,(function(e){return t[e]}))}function Qe(t,e){return t.has(e)}function $e(t,e){for(var i=-1,n=t.length;++i<n&&Ee(e,t[i],0)>-1;);return i}function Ye(t,e){for(var i=t.length;i--&&Ee(e,t[i],0)>-1;);return i}function Ke(t,e){for(var i=t.length,n=0;i--;)t[i]===e&&++n;return n}var ti=qe({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),ei=qe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ii(t){return"\\"+se[t]}function ni(t){return Kt.test(t)}function ri(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}function si(t,e){return function(i){return t(e(i))}}function oi(t,e){for(var i=-1,n=t.length,s=0,o=[];++i<n;){var a=t[i];a!==e&&a!==r||(t[i]=r,o[s++]=i)}return o}function ai(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}function li(t){return ni(t)?function(t){for(var e=$t.lastIndex=0;$t.test(t);)++e;return e}(t):Fe(t)}function ui(t){return ni(t)?function(t){return t.match($t)||[]}(t):function(t){return t.split("")}(t)}function ci(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var hi=qe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),mi=function t(rt){var xt,St=(rt=null==rt?ce:mi.defaults(ce.Object(),rt,mi.pick(ce,ee))).Array,wt=rt.Date,Bt=rt.Error,Ct=rt.Function,At=rt.Math,Vt=rt.Object,Pt=rt.RegExp,Mt=rt.String,It=rt.TypeError,kt=St.prototype,Dt=Ct.prototype,Gt=Vt.prototype,Tt=rt["__core-js_shared__"],Ft=Dt.toString,Lt=Gt.hasOwnProperty,Rt=0,Et=(xt=/[^.]+$/.exec(Tt&&Tt.keys&&Tt.keys.IE_PROTO||""))?"Symbol(src)_1."+xt:"",zt=Gt.toString,Ot=Ft.call(Vt),Nt=ce._,jt=Pt("^"+Ft.call(Lt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qt=_e?rt.Buffer:e,Ut=rt.Symbol,Jt=rt.Uint8Array,Wt=qt?qt.allocUnsafe:e,Xt=si(Vt.getPrototypeOf,Vt),Ht=Vt.create,$t=Gt.propertyIsEnumerable,Kt=kt.splice,se=Ut?Ut.isConcatSpreadable:e,le=Ut?Ut.iterator:e,ue=Ut?Ut.toStringTag:e,he=function(){try{var t=ms(Vt,"defineProperty");return t({},"",{}),t}catch(e){}}(),me=rt.clearTimeout!==ce.clearTimeout&&rt.clearTimeout,fe=wt&&wt.now!==ce.Date.now&&wt.now,de=rt.setTimeout!==ce.setTimeout&&rt.setTimeout,Fe=At.ceil,qe=At.floor,_i=Vt.getOwnPropertySymbols,fi=qt?qt.isBuffer:e,di=rt.isFinite,pi=kt.join,yi=si(Vt.keys,Vt),vi=At.max,gi=At.min,bi=wt.now,xi=rt.parseInt,Si=At.random,wi=kt.reverse,Bi=ms(rt,"DataView"),Ci=ms(rt,"Map"),Ai=ms(rt,"Promise"),Vi=ms(rt,"Set"),Pi=ms(rt,"WeakMap"),Mi=ms(Vt,"create"),Ii=Pi&&new Pi,ki={},Di=js(Bi),Gi=js(Ci),Ti=js(Ai),Fi=js(Vi),Li=js(Pi),Ri=Ut?Ut.prototype:e,Ei=Ri?Ri.valueOf:e,zi=Ri?Ri.toString:e;function Oi(t){if(oa(t)&&!Zo(t)&&!(t instanceof Ui)){if(t instanceof qi)return t;if(Lt.call(t,"__wrapped__"))return qs(t)}return new qi(t)}var Ni=function(){function t(){}return function(i){if(!sa(i))return{};if(Ht)return Ht(i);t.prototype=i;var n=new t;return t.prototype=e,n}}();function ji(){}function qi(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=e}function Ui(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_,this.__views__=[]}function Ji(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Wi(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Xi(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Hi(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new Xi;++e<i;)this.add(t[e])}function Zi(t){var e=this.__data__=new Wi(t);this.size=e.size}function Qi(t,e){var i=Zo(t),n=!i&&Ho(t),r=!i&&!n&&Ko(t),s=!i&&!n&&!r&&fa(t),o=i||n||r||s,a=o?We(t.length,Mt):[],l=a.length;for(var u in t)!e&&!Lt.call(t,u)||o&&("length"==u||r&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||gs(u,l))||a.push(u);return a}function $i(t){var i=t.length;return i?t[Zn(0,i-1)]:e}function Yi(t,e){return Ls(Ir(t),ln(e,0,t.length))}function Ki(t){return Ls(Ir(t))}function tn(t,i,n){(n!==e&&!Jo(t[i],n)||n===e&&!(i in t))&&on(t,i,n)}function en(t,i,n){var r=t[i];Lt.call(t,i)&&Jo(r,n)&&(n!==e||i in t)||on(t,i,n)}function nn(t,e){for(var i=t.length;i--;)if(Jo(t[i][0],e))return i;return-1}function rn(t,e,i,n){return _n(t,(function(t,r,s){e(n,t,i(t),s)})),n}function sn(t,e){return t&&kr(e,La(e),t)}function on(t,e,i){"__proto__"==e&&he?he(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function an(t,i){for(var n=-1,r=i.length,s=St(r),o=null==t;++n<r;)s[n]=o?e:ka(t,i[n]);return s}function ln(t,i,n){return t==t&&(n!==e&&(t=t<=n?t:n),i!==e&&(t=t>=i?t:i)),t}function un(t,i,n,r,s,o){var a,l=1&i,u=2&i,c=4&i;if(n&&(a=s?n(t,r,s,o):n(t)),a!==e)return a;if(!sa(t))return t;var h=Zo(t);if(h){if(a=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&Lt.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!l)return Ir(t,a)}else{var m=ds(t),_=m==b||m==x;if(Ko(t))return Br(t,l);if(m==B||m==d||_&&!s){if(a=u||_?{}:ys(t),!l)return u?function(t,e){return kr(t,fs(t),e)}(t,function(t,e){return t&&kr(e,Ra(e),t)}(a,t)):function(t,e){return kr(t,_s(t),e)}(t,sn(a,t))}else{if(!re[m])return s?t:{};a=function(t,e,i){var n,r=t.constructor;switch(e){case k:return Cr(t);case y:case v:return new r(+t);case D:return function(t,e){var i=e?Cr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case G:case T:case F:case L:case R:case E:case z:case O:case N:return Ar(t,i);case S:return new r;case w:case P:return new r(t);case A:return function(t){var e=new t.constructor(t.source,mt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case V:return new r;case M:return n=t,Ei?Vt(Ei.call(n)):{}}}(t,m,l)}}o||(o=new Zi);var f=o.get(t);if(f)return f;o.set(t,a),ha(t)?t.forEach((function(e){a.add(un(e,i,n,e,t,o))})):aa(t)&&t.forEach((function(e,r){a.set(r,un(e,i,n,r,t,o))}));var p=h?e:(c?u?ss:rs:u?Ra:La)(t);return Be(p||t,(function(e,r){p&&(e=t[r=e]),en(a,r,un(e,i,n,r,t,o))})),a}function cn(t,i,n){var r=n.length;if(null==t)return!r;for(t=Vt(t);r--;){var s=n[r],o=i[s],a=t[s];if(a===e&&!(s in t)||!o(a))return!1}return!0}function hn(t,n,r){if("function"!=typeof t)throw new It(i);return Ds((function(){t.apply(e,r)}),n)}function mn(t,e,i,n){var r=-1,s=Pe,o=!0,a=t.length,l=[],u=e.length;if(!a)return l;i&&(e=Ie(e,He(i))),n?(s=Me,o=!1):e.length>=200&&(s=Qe,o=!1,e=new Hi(e));t:for(;++r<a;){var c=t[r],h=null==i?c:i(c);if(c=n||0!==c?c:0,o&&h==h){for(var m=u;m--;)if(e[m]===h)continue t;l.push(c)}else s(e,h,n)||l.push(c)}return l}Oi.templateSettings={escape:Z,evaluate:Q,interpolate:$,variable:"",imports:{_:Oi}},Oi.prototype=ji.prototype,Oi.prototype.constructor=Oi,qi.prototype=Ni(ji.prototype),qi.prototype.constructor=qi,Ui.prototype=Ni(ji.prototype),Ui.prototype.constructor=Ui,Ji.prototype.clear=function(){this.__data__=Mi?Mi(null):{},this.size=0},Ji.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ji.prototype.get=function(t){var i=this.__data__;if(Mi){var r=i[t];return r===n?e:r}return Lt.call(i,t)?i[t]:e},Ji.prototype.has=function(t){var i=this.__data__;return Mi?i[t]!==e:Lt.call(i,t)},Ji.prototype.set=function(t,i){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Mi&&i===e?n:i,this},Wi.prototype.clear=function(){this.__data__=[],this.size=0},Wi.prototype.delete=function(t){var e=this.__data__,i=nn(e,t);return!(i<0||(i==e.length-1?e.pop():Kt.call(e,i,1),--this.size,0))},Wi.prototype.get=function(t){var i=this.__data__,n=nn(i,t);return n<0?e:i[n][1]},Wi.prototype.has=function(t){return nn(this.__data__,t)>-1},Wi.prototype.set=function(t,e){var i=this.__data__,n=nn(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this},Xi.prototype.clear=function(){this.size=0,this.__data__={hash:new Ji,map:new(Ci||Wi),string:new Ji}},Xi.prototype.delete=function(t){var e=cs(this,t).delete(t);return this.size-=e?1:0,e},Xi.prototype.get=function(t){return cs(this,t).get(t)},Xi.prototype.has=function(t){return cs(this,t).has(t)},Xi.prototype.set=function(t,e){var i=cs(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},Hi.prototype.add=Hi.prototype.push=function(t){return this.__data__.set(t,n),this},Hi.prototype.has=function(t){return this.__data__.has(t)},Zi.prototype.clear=function(){this.__data__=new Wi,this.size=0},Zi.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},Zi.prototype.get=function(t){return this.__data__.get(t)},Zi.prototype.has=function(t){return this.__data__.has(t)},Zi.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Wi){var n=i.__data__;if(!Ci||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new Xi(n)}return i.set(t,e),this.size=i.size,this};var _n=Tr(xn),fn=Tr(Sn,!0);function dn(t,e){var i=!0;return _n(t,(function(t,n,r){return i=!!e(t,n,r)})),i}function pn(t,i,n){for(var r=-1,s=t.length;++r<s;){var o=t[r],a=i(o);if(null!=a&&(l===e?a==a&&!_a(a):n(a,l)))var l=a,u=o}return u}function yn(t,e){var i=[];return _n(t,(function(t,n,r){e(t,n,r)&&i.push(t)})),i}function vn(t,e,i,n,r){var s=-1,o=t.length;for(i||(i=vs),r||(r=[]);++s<o;){var a=t[s];e>0&&i(a)?e>1?vn(a,e-1,i,n,r):ke(r,a):n||(r[r.length]=a)}return r}var gn=Fr(),bn=Fr(!0);function xn(t,e){return t&&gn(t,e,La)}function Sn(t,e){return t&&bn(t,e,La)}function wn(t,e){return Ve(e,(function(e){return ia(t[e])}))}function Bn(t,i){for(var n=0,r=(i=br(i,t)).length;null!=t&&n<r;)t=t[Ns(i[n++])];return n&&n==r?t:e}function Cn(t,e,i){var n=e(t);return Zo(t)?n:ke(n,i(t))}function An(t){return null==t?t===e?"[object Undefined]":"[object Null]":ue&&ue in Vt(t)?function(t){var i=Lt.call(t,ue),n=t[ue];try{t[ue]=e;var r=!0}catch(o){}var s=zt.call(t);return r&&(i?t[ue]=n:delete t[ue]),s}(t):function(t){return zt.call(t)}(t)}function Vn(t,e){return t>e}function Pn(t,e){return null!=t&&Lt.call(t,e)}function Mn(t,e){return null!=t&&e in Vt(t)}function In(t,i,n){for(var r=n?Me:Pe,s=t[0].length,o=t.length,a=o,l=St(o),u=1/0,c=[];a--;){var h=t[a];a&&i&&(h=Ie(h,He(i))),u=gi(h.length,u),l[a]=!n&&(i||s>=120&&h.length>=120)?new Hi(a&&h):e}h=t[0];var m=-1,_=l[0];t:for(;++m<s&&c.length<u;){var f=h[m],d=i?i(f):f;if(f=n||0!==f?f:0,!(_?Qe(_,d):r(c,d,n))){for(a=o;--a;){var p=l[a];if(!(p?Qe(p,d):r(t[a],d,n)))continue t}_&&_.push(d),c.push(f)}}return c}function kn(t,i,n){var r=null==(t=Ps(t,i=br(i,t)))?t:t[Ns(to(i))];return null==r?e:Se(r,t,n)}function Dn(t){return oa(t)&&An(t)==d}function Gn(t,i,n,r,s){return t===i||(null==t||null==i||!oa(t)&&!oa(i)?t!=t&&i!=i:function(t,i,n,r,s,o){var a=Zo(t),l=Zo(i),u=a?p:ds(t),c=l?p:ds(i),h=(u=u==d?B:u)==B,m=(c=c==d?B:c)==B,_=u==c;if(_&&Ko(t)){if(!Ko(i))return!1;a=!0,h=!1}if(_&&!h)return o||(o=new Zi),a||fa(t)?is(t,i,n,r,s,o):function(t,e,i,n,r,s,o){switch(i){case D:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case k:return!(t.byteLength!=e.byteLength||!s(new Jt(t),new Jt(e)));case y:case v:case w:return Jo(+t,+e);case g:return t.name==e.name&&t.message==e.message;case A:case P:return t==e+"";case S:var a=ri;case V:var l=1&n;if(a||(a=ai),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;n|=2,o.set(t,e);var c=is(a(t),a(e),n,r,s,o);return o.delete(t),c;case M:if(Ei)return Ei.call(t)==Ei.call(e)}return!1}(t,i,u,n,r,s,o);if(!(1&n)){var f=h&&Lt.call(t,"__wrapped__"),b=m&&Lt.call(i,"__wrapped__");if(f||b){var x=f?t.value():t,C=b?i.value():i;return o||(o=new Zi),s(x,C,n,r,o)}}return!!_&&(o||(o=new Zi),function(t,i,n,r,s,o){var a=1&n,l=rs(t),u=l.length,c=rs(i).length;if(u!=c&&!a)return!1;for(var h=u;h--;){var m=l[h];if(!(a?m in i:Lt.call(i,m)))return!1}var _=o.get(t),f=o.get(i);if(_&&f)return _==i&&f==t;var d=!0;o.set(t,i),o.set(i,t);for(var p=a;++h<u;){var y=t[m=l[h]],v=i[m];if(r)var g=a?r(v,y,m,i,t,o):r(y,v,m,t,i,o);if(!(g===e?y===v||s(y,v,n,r,o):g)){d=!1;break}p||(p="constructor"==m)}if(d&&!p){var b=t.constructor,x=i.constructor;b==x||!("constructor"in t)||!("constructor"in i)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(d=!1)}return o.delete(t),o.delete(i),d}(t,i,n,r,s,o))}(t,i,n,r,Gn,s))}function Tn(t,i,n,r){var s=n.length,o=s,a=!r;if(null==t)return!o;for(t=Vt(t);s--;){var l=n[s];if(a&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<o;){var u=(l=n[s])[0],c=t[u],h=l[1];if(a&&l[2]){if(c===e&&!(u in t))return!1}else{var m=new Zi;if(r)var _=r(c,h,u,t,i,m);if(!(_===e?Gn(h,c,3,r,m):_))return!1}}return!0}function Fn(t){return!(!sa(t)||(e=t,Et&&Et in e))&&(ia(t)?jt:dt).test(js(t));var e}function Ln(t){return"function"==typeof t?t:null==t?ll:"object"==typeof t?Zo(t)?jn(t[0],t[1]):Nn(t):yl(t)}function Rn(t){if(!Bs(t))return yi(t);var e=[];for(var i in Vt(t))Lt.call(t,i)&&"constructor"!=i&&e.push(i);return e}function En(t){if(!sa(t))return function(t){var e=[];if(null!=t)for(var i in Vt(t))e.push(i);return e}(t);var e=Bs(t),i=[];for(var n in t)("constructor"!=n||!e&&Lt.call(t,n))&&i.push(n);return i}function zn(t,e){return t<e}function On(t,e){var i=-1,n=$o(t)?St(t.length):[];return _n(t,(function(t,r,s){n[++i]=e(t,r,s)})),n}function Nn(t){var e=hs(t);return 1==e.length&&e[0][2]?As(e[0][0],e[0][1]):function(i){return i===t||Tn(i,t,e)}}function jn(t,i){return xs(t)&&Cs(i)?As(Ns(t),i):function(n){var r=ka(n,t);return r===e&&r===i?Da(n,t):Gn(i,r,3)}}function qn(t,i,n,r,s){t!==i&&gn(i,(function(o,a){if(s||(s=new Zi),sa(o))!function(t,i,n,r,s,o,a){var l=Is(t,n),u=Is(i,n),c=a.get(u);if(c)tn(t,n,c);else{var h=o?o(l,u,n+"",t,i,a):e,m=h===e;if(m){var _=Zo(u),f=!_&&Ko(u),d=!_&&!f&&fa(u);h=u,_||f||d?Zo(l)?h=l:Yo(l)?h=Ir(l):f?(m=!1,h=Br(u,!0)):d?(m=!1,h=Ar(u,!0)):h=[]:ua(u)||Ho(u)?(h=l,Ho(l)?h=Sa(l):sa(l)&&!ia(l)||(h=ys(u))):m=!1}m&&(a.set(u,h),s(h,u,r,o,a),a.delete(u)),tn(t,n,h)}}(t,i,a,n,qn,r,s);else{var l=r?r(Is(t,a),o,a+"",t,i,s):e;l===e&&(l=o),tn(t,a,l)}}),Ra)}function Un(t,i){var n=t.length;if(n)return gs(i+=i<0?n:0,n)?t[i]:e}function Jn(t,e,i){e=e.length?Ie(e,(function(t){return Zo(t)?function(e){return Bn(e,1===t.length?t[0]:t)}:t})):[ll];var n=-1;return e=Ie(e,He(us())),function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}(On(t,(function(t,i,r){return{criteria:Ie(e,(function(e){return e(t)})),index:++n,value:t}})),(function(t,e){return function(t,e,i){for(var n=-1,r=t.criteria,s=e.criteria,o=r.length,a=i.length;++n<o;){var l=Vr(r[n],s[n]);if(l)return n>=a?l:l*("desc"==i[n]?-1:1)}return t.index-e.index}(t,e,i)}))}function Wn(t,e,i){for(var n=-1,r=e.length,s={};++n<r;){var o=e[n],a=Bn(t,o);i(a,o)&&tr(s,br(o,t),a)}return s}function Xn(t,e,i,n){var r=n?ze:Ee,s=-1,o=e.length,a=t;for(t===e&&(e=Ir(e)),i&&(a=Ie(t,He(i)));++s<o;)for(var l=0,u=e[s],c=i?i(u):u;(l=r(a,c,l,n))>-1;)a!==t&&Kt.call(a,l,1),Kt.call(t,l,1);return t}function Hn(t,e){for(var i=t?e.length:0,n=i-1;i--;){var r=e[i];if(i==n||r!==s){var s=r;gs(r)?Kt.call(t,r,1):mr(t,r)}}return t}function Zn(t,e){return t+qe(Si()*(e-t+1))}function Qn(t,e){var i="";if(!t||e<1||e>h)return i;do{e%2&&(i+=t),(e=qe(e/2))&&(t+=t)}while(e);return i}function $n(t,e){return Gs(Vs(t,e,ll),t+"")}function Yn(t){return $i(Ja(t))}function Kn(t,e){var i=Ja(t);return Ls(i,ln(e,0,i.length))}function tr(t,i,n,r){if(!sa(t))return t;for(var s=-1,o=(i=br(i,t)).length,a=o-1,l=t;null!=l&&++s<o;){var u=Ns(i[s]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;if(s!=a){var h=l[u];(c=r?r(h,u,l):e)===e&&(c=sa(h)?h:gs(i[s+1])?[]:{})}en(l,u,c),l=l[u]}return t}var er=Ii?function(t,e){return Ii.set(t,e),t}:ll,ir=he?function(t,e){return he(t,"toString",{configurable:!0,enumerable:!1,value:sl(e),writable:!0})}:ll;function nr(t){return Ls(Ja(t))}function rr(t,e,i){var n=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(i=i>r?r:i)<0&&(i+=r),r=e>i?0:i-e>>>0,e>>>=0;for(var s=St(r);++n<r;)s[n]=t[n+e];return s}function sr(t,e){var i;return _n(t,(function(t,n,r){return!(i=e(t,n,r))})),!!i}function or(t,e,i){var n=0,r=null==t?n:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;n<r;){var s=n+r>>>1,o=t[s];null!==o&&!_a(o)&&(i?o<=e:o<e)?n=s+1:r=s}return r}return ar(t,e,ll,i)}function ar(t,i,n,r){var s=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(i=n(i))!=i,l=null===i,u=_a(i),c=i===e;s<o;){var h=qe((s+o)/2),m=n(t[h]),_=m!==e,f=null===m,d=m==m,p=_a(m);if(a)var y=r||d;else y=c?d&&(r||_):l?d&&_&&(r||!f):u?d&&_&&!f&&(r||!p):!f&&!p&&(r?m<=i:m<i);y?s=h+1:o=h}return gi(o,4294967294)}function lr(t,e){for(var i=-1,n=t.length,r=0,s=[];++i<n;){var o=t[i],a=e?e(o):o;if(!i||!Jo(a,l)){var l=a;s[r++]=0===o?0:o}}return s}function ur(t){return"number"==typeof t?t:_a(t)?m:+t}function cr(t){if("string"==typeof t)return t;if(Zo(t))return Ie(t,cr)+"";if(_a(t))return zi?zi.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function hr(t,e,i){var n=-1,r=Pe,s=t.length,o=!0,a=[],l=a;if(i)o=!1,r=Me;else if(s>=200){var u=e?null:Qr(t);if(u)return ai(u);o=!1,r=Qe,l=new Hi}else l=e?[]:a;t:for(;++n<s;){var c=t[n],h=e?e(c):c;if(c=i||0!==c?c:0,o&&h==h){for(var m=l.length;m--;)if(l[m]===h)continue t;e&&l.push(h),a.push(c)}else r(l,h,i)||(l!==a&&l.push(h),a.push(c))}return a}function mr(t,e){return null==(t=Ps(t,e=br(e,t)))||delete t[Ns(to(e))]}function _r(t,e,i,n){return tr(t,e,i(Bn(t,e)),n)}function fr(t,e,i,n){for(var r=t.length,s=n?r:-1;(n?s--:++s<r)&&e(t[s],s,t););return i?rr(t,n?0:s,n?s+1:r):rr(t,n?s+1:0,n?r:s)}function dr(t,e){var i=t;return i instanceof Ui&&(i=i.value()),De(e,(function(t,e){return e.func.apply(e.thisArg,ke([t],e.args))}),i)}function pr(t,e,i){var n=t.length;if(n<2)return n?hr(t[0]):[];for(var r=-1,s=St(n);++r<n;)for(var o=t[r],a=-1;++a<n;)a!=r&&(s[r]=mn(s[r]||o,t[a],e,i));return hr(vn(s,1),e,i)}function yr(t,i,n){for(var r=-1,s=t.length,o=i.length,a={};++r<s;){var l=r<o?i[r]:e;n(a,t[r],l)}return a}function vr(t){return Yo(t)?t:[]}function gr(t){return"function"==typeof t?t:ll}function br(t,e){return Zo(t)?t:xs(t,e)?[t]:Os(wa(t))}var xr=$n;function Sr(t,i,n){var r=t.length;return n=n===e?r:n,!i&&n>=r?t:rr(t,i,n)}var wr=me||function(t){return ce.clearTimeout(t)};function Br(t,e){if(e)return t.slice();var i=t.length,n=Wt?Wt(i):new t.constructor(i);return t.copy(n),n}function Cr(t){var e=new t.constructor(t.byteLength);return new Jt(e).set(new Jt(t)),e}function Ar(t,e){var i=e?Cr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function Vr(t,i){if(t!==i){var n=t!==e,r=null===t,s=t==t,o=_a(t),a=i!==e,l=null===i,u=i==i,c=_a(i);if(!l&&!c&&!o&&t>i||o&&a&&u&&!l&&!c||r&&a&&u||!n&&u||!s)return 1;if(!r&&!o&&!c&&t<i||c&&n&&s&&!r&&!o||l&&n&&s||!a&&s||!u)return-1}return 0}function Pr(t,e,i,n){for(var r=-1,s=t.length,o=i.length,a=-1,l=e.length,u=vi(s-o,0),c=St(l+u),h=!n;++a<l;)c[a]=e[a];for(;++r<o;)(h||r<s)&&(c[i[r]]=t[r]);for(;u--;)c[a++]=t[r++];return c}function Mr(t,e,i,n){for(var r=-1,s=t.length,o=-1,a=i.length,l=-1,u=e.length,c=vi(s-a,0),h=St(c+u),m=!n;++r<c;)h[r]=t[r];for(var _=r;++l<u;)h[_+l]=e[l];for(;++o<a;)(m||r<s)&&(h[_+i[o]]=t[r++]);return h}function Ir(t,e){var i=-1,n=t.length;for(e||(e=St(n));++i<n;)e[i]=t[i];return e}function kr(t,i,n,r){var s=!n;n||(n={});for(var o=-1,a=i.length;++o<a;){var l=i[o],u=r?r(n[l],t[l],l,n,t):e;u===e&&(u=t[l]),s?on(n,l,u):en(n,l,u)}return n}function Dr(t,e){return function(i,n){var r=Zo(i)?we:rn,s=e?e():{};return r(i,t,us(n,2),s)}}function Gr(t){return $n((function(i,n){var r=-1,s=n.length,o=s>1?n[s-1]:e,a=s>2?n[2]:e;for(o=t.length>3&&"function"==typeof o?(s--,o):e,a&&bs(n[0],n[1],a)&&(o=s<3?e:o,s=1),i=Vt(i);++r<s;){var l=n[r];l&&t(i,l,r,o)}return i}))}function Tr(t,e){return function(i,n){if(null==i)return i;if(!$o(i))return t(i,n);for(var r=i.length,s=e?r:-1,o=Vt(i);(e?s--:++s<r)&&!1!==n(o[s],s,o););return i}}function Fr(t){return function(e,i,n){for(var r=-1,s=Vt(e),o=n(e),a=o.length;a--;){var l=o[t?a:++r];if(!1===i(s[l],l,s))break}return e}}function Lr(t){return function(i){var n=ni(i=wa(i))?ui(i):e,r=n?n[0]:i.charAt(0),s=n?Sr(n,1).join(""):i.slice(1);return r[t]()+s}}function Rr(t){return function(e){return De(il(Ha(e).replace(Zt,"")),t,"")}}function Er(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var i=Ni(t.prototype),n=t.apply(i,e);return sa(n)?n:i}}function zr(t){return function(i,n,r){var s=Vt(i);if(!$o(i)){var o=us(n,3);i=La(i),n=function(t){return o(s[t],t,s)}}var a=t(i,n,r);return a>-1?s[o?i[a]:a]:e}}function Or(t){return ns((function(n){var r=n.length,s=r,o=qi.prototype.thru;for(t&&n.reverse();s--;){var a=n[s];if("function"!=typeof a)throw new It(i);if(o&&!l&&"wrapper"==as(a))var l=new qi([],!0)}for(s=l?s:r;++s<r;){var u=as(a=n[s]),c="wrapper"==u?os(a):e;l=c&&Ss(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?l[as(c[0])].apply(l,c[3]):1==a.length&&Ss(a)?l[u]():l.thru(a)}return function(){var t=arguments,e=t[0];if(l&&1==t.length&&Zo(e))return l.plant(e).value();for(var i=0,s=r?n[i].apply(this,t):e;++i<r;)s=n[i].call(this,s);return s}}))}function Nr(t,i,n,r,s,o,a,u,c,h){var m=i&l,_=1&i,f=2&i,d=24&i,p=512&i,y=f?e:Er(t);return function e(){for(var l=arguments.length,v=St(l),g=l;g--;)v[g]=arguments[g];if(d)var b=ls(e),x=Ke(v,b);if(r&&(v=Pr(v,r,s,d)),o&&(v=Mr(v,o,a,d)),l-=x,d&&l<h){var S=oi(v,b);return Hr(t,i,Nr,e.placeholder,n,v,S,u,c,h-l)}var w=_?n:this,B=f?w[t]:t;return l=v.length,u?v=Ms(v,u):p&&l>1&&v.reverse(),m&&c<l&&(v.length=c),this&&this!==ce&&this instanceof e&&(B=y||Er(B)),B.apply(w,v)}}function jr(t,e){return function(i,n){return function(t,e,i,n){return xn(t,(function(t,r,s){e(n,i(t),r,s)})),n}(i,t,e(n),{})}}function qr(t,i){return function(n,r){var s;if(n===e&&r===e)return i;if(n!==e&&(s=n),r!==e){if(s===e)return r;"string"==typeof n||"string"==typeof r?(n=cr(n),r=cr(r)):(n=ur(n),r=ur(r)),s=t(n,r)}return s}}function Ur(t){return ns((function(e){return e=Ie(e,He(us())),$n((function(i){var n=this;return t(e,(function(t){return Se(t,n,i)}))}))}))}function Jr(t,i){var n=(i=i===e?" ":cr(i)).length;if(n<2)return n?Qn(i,t):i;var r=Qn(i,Fe(t/li(i)));return ni(i)?Sr(ui(r),0,t).join(""):r.slice(0,t)}function Wr(t){return function(i,n,r){return r&&"number"!=typeof r&&bs(i,n,r)&&(n=r=e),i=va(i),n===e?(n=i,i=0):n=va(n),function(t,e,i,n){for(var r=-1,s=vi(Fe((e-t)/(i||1)),0),o=St(s);s--;)o[n?s:++r]=t,t+=i;return o}(i,n,r=r===e?i<n?1:-1:va(r),t)}}function Xr(t){return function(e,i){return"string"==typeof e&&"string"==typeof i||(e=xa(e),i=xa(i)),t(e,i)}}function Hr(t,i,n,r,s,l,u,c,h,m){var _=8&i;i|=_?o:a,4&(i&=~(_?a:o))||(i&=-4);var f=[t,i,s,_?l:e,_?u:e,_?e:l,_?e:u,c,h,m],d=n.apply(e,f);return Ss(t)&&ks(d,f),d.placeholder=r,Ts(d,t,i)}function Zr(t){var e=At[t];return function(t,i){if(t=xa(t),(i=null==i?0:gi(ga(i),292))&&di(t)){var n=(wa(t)+"e").split("e");return+((n=(wa(e(n[0]+"e"+(+n[1]+i)))+"e").split("e"))[0]+"e"+(+n[1]-i))}return e(t)}}var Qr=Vi&&1/ai(new Vi([,-0]))[1]==c?function(t){return new Vi(t)}:_l;function $r(t){return function(e){var i=ds(e);return i==S?ri(e):i==V?function(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=[t,t]})),i}(e):function(t,e){return Ie(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Yr(t,n,c,h,m,_,f,d){var p=2&n;if(!p&&"function"!=typeof t)throw new It(i);var y=h?h.length:0;if(y||(n&=-97,h=m=e),f=f===e?f:vi(ga(f),0),d=d===e?d:ga(d),y-=m?m.length:0,n&a){var v=h,g=m;h=m=e}var b=p?e:os(t),x=[t,n,c,h,m,v,g,_,f,d];if(b&&function(t,e){var i=t[1],n=e[1],s=i|n,o=s<131,a=n==l&&8==i||n==l&&i==u&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==i;if(!o&&!a)return t;1&n&&(t[2]=e[2],s|=1&i?0:4);var c=e[3];if(c){var h=t[3];t[3]=h?Pr(h,c,e[4]):c,t[4]=h?oi(t[3],r):e[4]}(c=e[5])&&(h=t[5],t[5]=h?Mr(h,c,e[6]):c,t[6]=h?oi(t[5],r):e[6]),(c=e[7])&&(t[7]=c),n&l&&(t[8]=null==t[8]?e[8]:gi(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=s}(x,b),t=x[0],n=x[1],c=x[2],h=x[3],m=x[4],!(d=x[9]=x[9]===e?p?0:t.length:vi(x[9]-y,0))&&24&n&&(n&=-25),n&&1!=n)S=8==n||n==s?function(t,i,n){var r=Er(t);return function s(){for(var o=arguments.length,a=St(o),l=o,u=ls(s);l--;)a[l]=arguments[l];var c=o<3&&a[0]!==u&&a[o-1]!==u?[]:oi(a,u);return(o-=c.length)<n?Hr(t,i,Nr,s.placeholder,e,a,c,e,e,n-o):Se(this&&this!==ce&&this instanceof s?r:t,this,a)}}(t,n,d):n!=o&&33!=n||m.length?Nr.apply(e,x):function(t,e,i,n){var r=1&e,s=Er(t);return function e(){for(var o=-1,a=arguments.length,l=-1,u=n.length,c=St(u+a),h=this&&this!==ce&&this instanceof e?s:t;++l<u;)c[l]=n[l];for(;a--;)c[l++]=arguments[++o];return Se(h,r?i:this,c)}}(t,n,c,h);else var S=function(t,e,i){var n=1&e,r=Er(t);return function e(){return(this&&this!==ce&&this instanceof e?r:t).apply(n?i:this,arguments)}}(t,n,c);return Ts((b?er:ks)(S,x),t,n)}function Kr(t,i,n,r){return t===e||Jo(t,Gt[n])&&!Lt.call(r,n)?i:t}function ts(t,i,n,r,s,o){return sa(t)&&sa(i)&&(o.set(i,t),qn(t,i,e,ts,o),o.delete(i)),t}function es(t){return ua(t)?e:t}function is(t,i,n,r,s,o){var a=1&n,l=t.length,u=i.length;if(l!=u&&!(a&&u>l))return!1;var c=o.get(t),h=o.get(i);if(c&&h)return c==i&&h==t;var m=-1,_=!0,f=2&n?new Hi:e;for(o.set(t,i),o.set(i,t);++m<l;){var d=t[m],p=i[m];if(r)var y=a?r(p,d,m,i,t,o):r(d,p,m,t,i,o);if(y!==e){if(y)continue;_=!1;break}if(f){if(!Te(i,(function(t,e){if(!Qe(f,e)&&(d===t||s(d,t,n,r,o)))return f.push(e)}))){_=!1;break}}else if(d!==p&&!s(d,p,n,r,o)){_=!1;break}}return o.delete(t),o.delete(i),_}function ns(t){return Gs(Vs(t,e,Zs),t+"")}function rs(t){return Cn(t,La,_s)}function ss(t){return Cn(t,Ra,fs)}var os=Ii?function(t){return Ii.get(t)}:_l;function as(t){for(var e=t.name+"",i=ki[e],n=Lt.call(ki,e)?i.length:0;n--;){var r=i[n],s=r.func;if(null==s||s==t)return r.name}return e}function ls(t){return(Lt.call(Oi,"placeholder")?Oi:t).placeholder}function us(){var t=Oi.iteratee||ul;return t=t===ul?Ln:t,arguments.length?t(arguments[0],arguments[1]):t}function cs(t,e){var i,n,r=t.__data__;return("string"==(n=typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof e?"string":"hash"]:r.map}function hs(t){for(var e=La(t),i=e.length;i--;){var n=e[i],r=t[n];e[i]=[n,r,Cs(r)]}return e}function ms(t,i){var n=function(t,i){return null==t?e:t[i]}(t,i);return Fn(n)?n:e}var _s=_i?function(t){return null==t?[]:(t=Vt(t),Ve(_i(t),(function(e){return $t.call(t,e)})))}:bl,fs=_i?function(t){for(var e=[];t;)ke(e,_s(t)),t=Xt(t);return e}:bl,ds=An;function ps(t,e,i){for(var n=-1,r=(e=br(e,t)).length,s=!1;++n<r;){var o=Ns(e[n]);if(!(s=null!=t&&i(t,o)))break;t=t[o]}return s||++n!=r?s:!!(r=null==t?0:t.length)&&ra(r)&&gs(o,r)&&(Zo(t)||Ho(t))}function ys(t){return"function"!=typeof t.constructor||Bs(t)?{}:Ni(Xt(t))}function vs(t){return Zo(t)||Ho(t)||!!(se&&t&&t[se])}function gs(t,e){var i=typeof t;return!!(e=null==e?h:e)&&("number"==i||"symbol"!=i&&yt.test(t))&&t>-1&&t%1==0&&t<e}function bs(t,e,i){if(!sa(i))return!1;var n=typeof e;return!!("number"==n?$o(i)&&gs(e,i.length):"string"==n&&e in i)&&Jo(i[e],t)}function xs(t,e){if(Zo(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!_a(t))||K.test(t)||!Y.test(t)||null!=e&&t in Vt(e)}function Ss(t){var e=as(t),i=Oi[e];if("function"!=typeof i||!(e in Ui.prototype))return!1;if(t===i)return!0;var n=os(i);return!!n&&t===n[0]}(Bi&&ds(new Bi(new ArrayBuffer(1)))!=D||Ci&&ds(new Ci)!=S||Ai&&ds(Ai.resolve())!=C||Vi&&ds(new Vi)!=V||Pi&&ds(new Pi)!=I)&&(ds=function(t){var i=An(t),n=i==B?t.constructor:e,r=n?js(n):"";if(r)switch(r){case Di:return D;case Gi:return S;case Ti:return C;case Fi:return V;case Li:return I}return i});var ws=Tt?ia:xl;function Bs(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Gt)}function Cs(t){return t==t&&!sa(t)}function As(t,i){return function(n){return null!=n&&n[t]===i&&(i!==e||t in Vt(n))}}function Vs(t,i,n){return i=vi(i===e?t.length-1:i,0),function(){for(var e=arguments,r=-1,s=vi(e.length-i,0),o=St(s);++r<s;)o[r]=e[i+r];r=-1;for(var a=St(i+1);++r<i;)a[r]=e[r];return a[i]=n(o),Se(t,this,a)}}function Ps(t,e){return e.length<2?t:Bn(t,rr(e,0,-1))}function Ms(t,i){for(var n=t.length,r=gi(i.length,n),s=Ir(t);r--;){var o=i[r];t[r]=gs(o,n)?s[o]:e}return t}function Is(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ks=Fs(er),Ds=de||function(t,e){return ce.setTimeout(t,e)},Gs=Fs(ir);function Ts(t,e,i){var n=e+"";return Gs(t,function(t,e){var i=e.length;if(!i)return t;var n=i-1;return e[n]=(i>1?"& ":"")+e[n],e=e.join(i>2?", ":" "),t.replace(st,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return Be(f,(function(i){var n="_."+i[0];e&i[1]&&!Pe(t,n)&&t.push(n)})),t.sort()}(function(t){var e=t.match(ot);return e?e[1].split(at):[]}(n),i)))}function Fs(t){var i=0,n=0;return function(){var r=bi(),s=16-(r-n);if(n=r,s>0){if(++i>=800)return arguments[0]}else i=0;return t.apply(e,arguments)}}function Ls(t,i){var n=-1,r=t.length,s=r-1;for(i=i===e?r:i;++n<i;){var o=Zn(n,s),a=t[o];t[o]=t[n],t[n]=a}return t.length=i,t}var Rs,Es,zs,Os=(Rs=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,i,n,r){e.push(n?r.replace(ct,"$1"):i||t)})),e},Es=zo(Rs,(function(t){return 500===zs.size&&zs.clear(),t})),zs=Es.cache,Es);function Ns(t){if("string"==typeof t||_a(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function js(t){if(null!=t){try{return Ft.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function qs(t){if(t instanceof Ui)return t.clone();var e=new qi(t.__wrapped__,t.__chain__);return e.__actions__=Ir(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Us=$n((function(t,e){return Yo(t)?mn(t,vn(e,1,Yo,!0)):[]})),Js=$n((function(t,i){var n=to(i);return Yo(n)&&(n=e),Yo(t)?mn(t,vn(i,1,Yo,!0),us(n,2)):[]})),Ws=$n((function(t,i){var n=to(i);return Yo(n)&&(n=e),Yo(t)?mn(t,vn(i,1,Yo,!0),e,n):[]}));function Xs(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:ga(i);return r<0&&(r=vi(n+r,0)),Re(t,us(e,3),r)}function Hs(t,i,n){var r=null==t?0:t.length;if(!r)return-1;var s=r-1;return n!==e&&(s=ga(n),s=n<0?vi(r+s,0):gi(s,r-1)),Re(t,us(i,3),s,!0)}function Zs(t){return null!=t&&t.length?vn(t,1):[]}function Qs(t){return t&&t.length?t[0]:e}var $s=$n((function(t){var e=Ie(t,vr);return e.length&&e[0]===t[0]?In(e):[]})),Ys=$n((function(t){var i=to(t),n=Ie(t,vr);return i===to(n)?i=e:n.pop(),n.length&&n[0]===t[0]?In(n,us(i,2)):[]})),Ks=$n((function(t){var i=to(t),n=Ie(t,vr);return(i="function"==typeof i?i:e)&&n.pop(),n.length&&n[0]===t[0]?In(n,e,i):[]}));function to(t){var i=null==t?0:t.length;return i?t[i-1]:e}var eo=$n(io);function io(t,e){return t&&t.length&&e&&e.length?Xn(t,e):t}var no=ns((function(t,e){var i=null==t?0:t.length,n=an(t,e);return Hn(t,Ie(e,(function(t){return gs(t,i)?+t:t})).sort(Vr)),n}));function ro(t){return null==t?t:wi.call(t)}var so=$n((function(t){return hr(vn(t,1,Yo,!0))})),oo=$n((function(t){var i=to(t);return Yo(i)&&(i=e),hr(vn(t,1,Yo,!0),us(i,2))})),ao=$n((function(t){var i=to(t);return i="function"==typeof i?i:e,hr(vn(t,1,Yo,!0),e,i)}));function lo(t){if(!t||!t.length)return[];var e=0;return t=Ve(t,(function(t){if(Yo(t))return e=vi(t.length,e),!0})),We(e,(function(e){return Ie(t,je(e))}))}function uo(t,i){if(!t||!t.length)return[];var n=lo(t);return null==i?n:Ie(n,(function(t){return Se(i,e,t)}))}var co=$n((function(t,e){return Yo(t)?mn(t,e):[]})),ho=$n((function(t){return pr(Ve(t,Yo))})),mo=$n((function(t){var i=to(t);return Yo(i)&&(i=e),pr(Ve(t,Yo),us(i,2))})),_o=$n((function(t){var i=to(t);return i="function"==typeof i?i:e,pr(Ve(t,Yo),e,i)})),fo=$n(lo),po=$n((function(t){var i=t.length,n=i>1?t[i-1]:e;return n="function"==typeof n?(t.pop(),n):e,uo(t,n)}));function yo(t){var e=Oi(t);return e.__chain__=!0,e}function vo(t,e){return e(t)}var go=ns((function(t){var i=t.length,n=i?t[0]:0,r=this.__wrapped__,s=function(e){return an(e,t)};return!(i>1||this.__actions__.length)&&r instanceof Ui&&gs(n)?((r=r.slice(n,+n+(i?1:0))).__actions__.push({func:vo,args:[s],thisArg:e}),new qi(r,this.__chain__).thru((function(t){return i&&!t.length&&t.push(e),t}))):this.thru(s)})),bo=Dr((function(t,e,i){Lt.call(t,i)?++t[i]:on(t,i,1)})),xo=zr(Xs),So=zr(Hs);function wo(t,e){return(Zo(t)?Be:_n)(t,us(e,3))}function Bo(t,e){return(Zo(t)?Ce:fn)(t,us(e,3))}var Co=Dr((function(t,e,i){Lt.call(t,i)?t[i].push(e):on(t,i,[e])})),Ao=$n((function(t,e,i){var n=-1,r="function"==typeof e,s=$o(t)?St(t.length):[];return _n(t,(function(t){s[++n]=r?Se(e,t,i):kn(t,e,i)})),s})),Vo=Dr((function(t,e,i){on(t,i,e)}));function Po(t,e){return(Zo(t)?Ie:On)(t,us(e,3))}var Mo=Dr((function(t,e,i){t[i?0:1].push(e)}),(function(){return[[],[]]})),Io=$n((function(t,e){if(null==t)return[];var i=e.length;return i>1&&bs(t,e[0],e[1])?e=[]:i>2&&bs(e[0],e[1],e[2])&&(e=[e[0]]),Jn(t,vn(e,1),[])})),ko=fe||function(){return ce.Date.now()};function Do(t,i,n){return i=n?e:i,i=t&&null==i?t.length:i,Yr(t,l,e,e,e,e,i)}function Go(t,n){var r;if("function"!=typeof n)throw new It(i);return t=ga(t),function(){return--t>0&&(r=n.apply(this,arguments)),t<=1&&(n=e),r}}var To=$n((function(t,e,i){var n=1;if(i.length){var r=oi(i,ls(To));n|=o}return Yr(t,n,e,i,r)})),Fo=$n((function(t,e,i){var n=3;if(i.length){var r=oi(i,ls(Fo));n|=o}return Yr(e,n,t,i,r)}));function Lo(t,n,r){var s,o,a,l,u,c,h=0,m=!1,_=!1,f=!0;if("function"!=typeof t)throw new It(i);function d(i){var n=s,r=o;return s=o=e,h=i,l=t.apply(r,n)}function p(t){return h=t,u=Ds(v,n),m?d(t):l}function y(t){var i=t-c;return c===e||i>=n||i<0||_&&t-h>=a}function v(){var t=ko();if(y(t))return g(t);u=Ds(v,function(t){var e=n-(t-c);return _?gi(e,a-(t-h)):e}(t))}function g(t){return u=e,f&&s?d(t):(s=o=e,l)}function b(){var t=ko(),i=y(t);if(s=arguments,o=this,c=t,i){if(u===e)return p(c);if(_)return wr(u),u=Ds(v,n),d(c)}return u===e&&(u=Ds(v,n)),l}return n=xa(n)||0,sa(r)&&(m=!!r.leading,a=(_="maxWait"in r)?vi(xa(r.maxWait)||0,n):a,f="trailing"in r?!!r.trailing:f),b.cancel=function(){u!==e&&wr(u),h=0,s=c=o=u=e},b.flush=function(){return u===e?l:g(ko())},b}var Ro=$n((function(t,e){return hn(t,1,e)})),Eo=$n((function(t,e,i){return hn(t,xa(e)||0,i)}));function zo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new It(i);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(zo.Cache||Xi),n}function Oo(t){if("function"!=typeof t)throw new It(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}zo.Cache=Xi;var No=xr((function(t,e){var i=(e=1==e.length&&Zo(e[0])?Ie(e[0],He(us())):Ie(vn(e,1),He(us()))).length;return $n((function(n){for(var r=-1,s=gi(n.length,i);++r<s;)n[r]=e[r].call(this,n[r]);return Se(t,this,n)}))})),jo=$n((function(t,i){var n=oi(i,ls(jo));return Yr(t,o,e,i,n)})),qo=$n((function(t,i){var n=oi(i,ls(qo));return Yr(t,a,e,i,n)})),Uo=ns((function(t,i){return Yr(t,u,e,e,e,i)}));function Jo(t,e){return t===e||t!=t&&e!=e}var Wo=Xr(Vn),Xo=Xr((function(t,e){return t>=e})),Ho=Dn(function(){return arguments}())?Dn:function(t){return oa(t)&&Lt.call(t,"callee")&&!$t.call(t,"callee")},Zo=St.isArray,Qo=pe?He(pe):function(t){return oa(t)&&An(t)==k};function $o(t){return null!=t&&ra(t.length)&&!ia(t)}function Yo(t){return oa(t)&&$o(t)}var Ko=fi||xl,ta=ye?He(ye):function(t){return oa(t)&&An(t)==v};function ea(t){if(!oa(t))return!1;var e=An(t);return e==g||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ua(t)}function ia(t){if(!sa(t))return!1;var e=An(t);return e==b||e==x||"[object AsyncFunction]"==e||"[object Proxy]"==e}function na(t){return"number"==typeof t&&t==ga(t)}function ra(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function sa(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function oa(t){return null!=t&&"object"==typeof t}var aa=ve?He(ve):function(t){return oa(t)&&ds(t)==S};function la(t){return"number"==typeof t||oa(t)&&An(t)==w}function ua(t){if(!oa(t)||An(t)!=B)return!1;var e=Xt(t);if(null===e)return!0;var i=Lt.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Ft.call(i)==Ot}var ca=ge?He(ge):function(t){return oa(t)&&An(t)==A},ha=be?He(be):function(t){return oa(t)&&ds(t)==V};function ma(t){return"string"==typeof t||!Zo(t)&&oa(t)&&An(t)==P}function _a(t){return"symbol"==typeof t||oa(t)&&An(t)==M}var fa=xe?He(xe):function(t){return oa(t)&&ra(t.length)&&!!ne[An(t)]},da=Xr(zn),pa=Xr((function(t,e){return t<=e}));function ya(t){if(!t)return[];if($o(t))return ma(t)?ui(t):Ir(t);if(le&&t[le])return function(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}(t[le]());var e=ds(t);return(e==S?ri:e==V?ai:Ja)(t)}function va(t){return t?(t=xa(t))===c||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ga(t){var e=va(t),i=e%1;return e==e?i?e-i:e:0}function ba(t){return t?ln(ga(t),0,_):0}function xa(t){if("number"==typeof t)return t;if(_a(t))return m;if(sa(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=sa(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Xe(t);var i=ft.test(t);return i||pt.test(t)?ae(t.slice(2),i?2:8):_t.test(t)?m:+t}function Sa(t){return kr(t,Ra(t))}function wa(t){return null==t?"":cr(t)}var Ba=Gr((function(t,e){if(Bs(e)||$o(e))kr(e,La(e),t);else for(var i in e)Lt.call(e,i)&&en(t,i,e[i])})),Ca=Gr((function(t,e){kr(e,Ra(e),t)})),Aa=Gr((function(t,e,i,n){kr(e,Ra(e),t,n)})),Va=Gr((function(t,e,i,n){kr(e,La(e),t,n)})),Pa=ns(an),Ma=$n((function(t,i){t=Vt(t);var n=-1,r=i.length,s=r>2?i[2]:e;for(s&&bs(i[0],i[1],s)&&(r=1);++n<r;)for(var o=i[n],a=Ra(o),l=-1,u=a.length;++l<u;){var c=a[l],h=t[c];(h===e||Jo(h,Gt[c])&&!Lt.call(t,c))&&(t[c]=o[c])}return t})),Ia=$n((function(t){return t.push(e,ts),Se(za,e,t)}));function ka(t,i,n){var r=null==t?e:Bn(t,i);return r===e?n:r}function Da(t,e){return null!=t&&ps(t,e,Mn)}var Ga=jr((function(t,e,i){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),t[e]=i}),sl(ll)),Ta=jr((function(t,e,i){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),Lt.call(t,e)?t[e].push(i):t[e]=[i]}),us),Fa=$n(kn);function La(t){return $o(t)?Qi(t):Rn(t)}function Ra(t){return $o(t)?Qi(t,!0):En(t)}var Ea=Gr((function(t,e,i){qn(t,e,i)})),za=Gr((function(t,e,i,n){qn(t,e,i,n)})),Oa=ns((function(t,e){var i={};if(null==t)return i;var n=!1;e=Ie(e,(function(e){return e=br(e,t),n||(n=e.length>1),e})),kr(t,ss(t),i),n&&(i=un(i,7,es));for(var r=e.length;r--;)mr(i,e[r]);return i})),Na=ns((function(t,e){return null==t?{}:function(t,e){return Wn(t,e,(function(e,i){return Da(t,i)}))}(t,e)}));function ja(t,e){if(null==t)return{};var i=Ie(ss(t),(function(t){return[t]}));return e=us(e),Wn(t,i,(function(t,i){return e(t,i[0])}))}var qa=$r(La),Ua=$r(Ra);function Ja(t){return null==t?[]:Ze(t,La(t))}var Wa=Rr((function(t,e,i){return e=e.toLowerCase(),t+(i?Xa(e):e)}));function Xa(t){return el(wa(t).toLowerCase())}function Ha(t){return(t=wa(t))&&t.replace(vt,ti).replace(Qt,"")}var Za=Rr((function(t,e,i){return t+(i?"-":"")+e.toLowerCase()})),Qa=Rr((function(t,e,i){return t+(i?" ":"")+e.toLowerCase()})),$a=Lr("toLowerCase"),Ya=Rr((function(t,e,i){return t+(i?"_":"")+e.toLowerCase()})),Ka=Rr((function(t,e,i){return t+(i?" ":"")+el(e)})),tl=Rr((function(t,e,i){return t+(i?" ":"")+e.toUpperCase()})),el=Lr("toUpperCase");function il(t,i,n){return t=wa(t),(i=n?e:i)===e?function(t){return te.test(t)}(t)?function(t){return t.match(Yt)||[]}(t):function(t){return t.match(lt)||[]}(t):t.match(i)||[]}var nl=$n((function(t,i){try{return Se(t,e,i)}catch(n){return ea(n)?n:new Bt(n)}})),rl=ns((function(t,e){return Be(e,(function(e){e=Ns(e),on(t,e,To(t[e],t))})),t}));function sl(t){return function(){return t}}var ol=Or(),al=Or(!0);function ll(t){return t}function ul(t){return Ln("function"==typeof t?t:un(t,1))}var cl=$n((function(t,e){return function(i){return kn(i,t,e)}})),hl=$n((function(t,e){return function(i){return kn(t,i,e)}}));function ml(t,e,i){var n=La(e),r=wn(e,n);null!=i||sa(e)&&(r.length||!n.length)||(i=e,e=t,t=this,r=wn(e,La(e)));var s=!(sa(i)&&"chain"in i&&!i.chain),o=ia(t);return Be(r,(function(i){var n=e[i];t[i]=n,o&&(t.prototype[i]=function(){var e=this.__chain__;if(s||e){var i=t(this.__wrapped__),r=i.__actions__=Ir(this.__actions__);return r.push({func:n,args:arguments,thisArg:t}),i.__chain__=e,i}return n.apply(t,ke([this.value()],arguments))})})),t}function _l(){}var fl=Ur(Ie),dl=Ur(Ae),pl=Ur(Te);function yl(t){return xs(t)?je(Ns(t)):function(t){return function(e){return Bn(e,t)}}(t)}var vl=Wr(),gl=Wr(!0);function bl(){return[]}function xl(){return!1}var Sl,wl=qr((function(t,e){return t+e}),0),Bl=Zr("ceil"),Cl=qr((function(t,e){return t/e}),1),Al=Zr("floor"),Vl=qr((function(t,e){return t*e}),1),Pl=Zr("round"),Ml=qr((function(t,e){return t-e}),0);return Oi.after=function(t,e){if("function"!=typeof e)throw new It(i);return t=ga(t),function(){if(--t<1)return e.apply(this,arguments)}},Oi.ary=Do,Oi.assign=Ba,Oi.assignIn=Ca,Oi.assignInWith=Aa,Oi.assignWith=Va,Oi.at=Pa,Oi.before=Go,Oi.bind=To,Oi.bindAll=rl,Oi.bindKey=Fo,Oi.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Zo(t)?t:[t]},Oi.chain=yo,Oi.chunk=function(t,i,n){i=(n?bs(t,i,n):i===e)?1:vi(ga(i),0);var r=null==t?0:t.length;if(!r||i<1)return[];for(var s=0,o=0,a=St(Fe(r/i));s<r;)a[o++]=rr(t,s,s+=i);return a},Oi.compact=function(t){for(var e=-1,i=null==t?0:t.length,n=0,r=[];++e<i;){var s=t[e];s&&(r[n++]=s)}return r},Oi.concat=function(){var t=arguments.length;if(!t)return[];for(var e=St(t-1),i=arguments[0],n=t;n--;)e[n-1]=arguments[n];return ke(Zo(i)?Ir(i):[i],vn(e,1))},Oi.cond=function(t){var e=null==t?0:t.length,n=us();return t=e?Ie(t,(function(t){if("function"!=typeof t[1])throw new It(i);return[n(t[0]),t[1]]})):[],$n((function(i){for(var n=-1;++n<e;){var r=t[n];if(Se(r[0],this,i))return Se(r[1],this,i)}}))},Oi.conforms=function(t){return function(t){var e=La(t);return function(i){return cn(i,t,e)}}(un(t,1))},Oi.constant=sl,Oi.countBy=bo,Oi.create=function(t,e){var i=Ni(t);return null==e?i:sn(i,e)},Oi.curry=function t(i,n,r){var s=Yr(i,8,e,e,e,e,e,n=r?e:n);return s.placeholder=t.placeholder,s},Oi.curryRight=function t(i,n,r){var o=Yr(i,s,e,e,e,e,e,n=r?e:n);return o.placeholder=t.placeholder,o},Oi.debounce=Lo,Oi.defaults=Ma,Oi.defaultsDeep=Ia,Oi.defer=Ro,Oi.delay=Eo,Oi.difference=Us,Oi.differenceBy=Js,Oi.differenceWith=Ws,Oi.drop=function(t,i,n){var r=null==t?0:t.length;return r?rr(t,(i=n||i===e?1:ga(i))<0?0:i,r):[]},Oi.dropRight=function(t,i,n){var r=null==t?0:t.length;return r?rr(t,0,(i=r-(i=n||i===e?1:ga(i)))<0?0:i):[]},Oi.dropRightWhile=function(t,e){return t&&t.length?fr(t,us(e,3),!0,!0):[]},Oi.dropWhile=function(t,e){return t&&t.length?fr(t,us(e,3),!0):[]},Oi.fill=function(t,i,n,r){var s=null==t?0:t.length;return s?(n&&"number"!=typeof n&&bs(t,i,n)&&(n=0,r=s),function(t,i,n,r){var s=t.length;for((n=ga(n))<0&&(n=-n>s?0:s+n),(r=r===e||r>s?s:ga(r))<0&&(r+=s),r=n>r?0:ba(r);n<r;)t[n++]=i;return t}(t,i,n,r)):[]},Oi.filter=function(t,e){return(Zo(t)?Ve:yn)(t,us(e,3))},Oi.flatMap=function(t,e){return vn(Po(t,e),1)},Oi.flatMapDeep=function(t,e){return vn(Po(t,e),c)},Oi.flatMapDepth=function(t,i,n){return n=n===e?1:ga(n),vn(Po(t,i),n)},Oi.flatten=Zs,Oi.flattenDeep=function(t){return null!=t&&t.length?vn(t,c):[]},Oi.flattenDepth=function(t,i){return null!=t&&t.length?vn(t,i=i===e?1:ga(i)):[]},Oi.flip=function(t){return Yr(t,512)},Oi.flow=ol,Oi.flowRight=al,Oi.fromPairs=function(t){for(var e=-1,i=null==t?0:t.length,n={};++e<i;){var r=t[e];n[r[0]]=r[1]}return n},Oi.functions=function(t){return null==t?[]:wn(t,La(t))},Oi.functionsIn=function(t){return null==t?[]:wn(t,Ra(t))},Oi.groupBy=Co,Oi.initial=function(t){return null!=t&&t.length?rr(t,0,-1):[]},Oi.intersection=$s,Oi.intersectionBy=Ys,Oi.intersectionWith=Ks,Oi.invert=Ga,Oi.invertBy=Ta,Oi.invokeMap=Ao,Oi.iteratee=ul,Oi.keyBy=Vo,Oi.keys=La,Oi.keysIn=Ra,Oi.map=Po,Oi.mapKeys=function(t,e){var i={};return e=us(e,3),xn(t,(function(t,n,r){on(i,e(t,n,r),t)})),i},Oi.mapValues=function(t,e){var i={};return e=us(e,3),xn(t,(function(t,n,r){on(i,n,e(t,n,r))})),i},Oi.matches=function(t){return Nn(un(t,1))},Oi.matchesProperty=function(t,e){return jn(t,un(e,1))},Oi.memoize=zo,Oi.merge=Ea,Oi.mergeWith=za,Oi.method=cl,Oi.methodOf=hl,Oi.mixin=ml,Oi.negate=Oo,Oi.nthArg=function(t){return t=ga(t),$n((function(e){return Un(e,t)}))},Oi.omit=Oa,Oi.omitBy=function(t,e){return ja(t,Oo(us(e)))},Oi.once=function(t){return Go(2,t)},Oi.orderBy=function(t,i,n,r){return null==t?[]:(Zo(i)||(i=null==i?[]:[i]),Zo(n=r?e:n)||(n=null==n?[]:[n]),Jn(t,i,n))},Oi.over=fl,Oi.overArgs=No,Oi.overEvery=dl,Oi.overSome=pl,Oi.partial=jo,Oi.partialRight=qo,Oi.partition=Mo,Oi.pick=Na,Oi.pickBy=ja,Oi.property=yl,Oi.propertyOf=function(t){return function(i){return null==t?e:Bn(t,i)}},Oi.pull=eo,Oi.pullAll=io,Oi.pullAllBy=function(t,e,i){return t&&t.length&&e&&e.length?Xn(t,e,us(i,2)):t},Oi.pullAllWith=function(t,i,n){return t&&t.length&&i&&i.length?Xn(t,i,e,n):t},Oi.pullAt=no,Oi.range=vl,Oi.rangeRight=gl,Oi.rearg=Uo,Oi.reject=function(t,e){return(Zo(t)?Ve:yn)(t,Oo(us(e,3)))},Oi.remove=function(t,e){var i=[];if(!t||!t.length)return i;var n=-1,r=[],s=t.length;for(e=us(e,3);++n<s;){var o=t[n];e(o,n,t)&&(i.push(o),r.push(n))}return Hn(t,r),i},Oi.rest=function(t,n){if("function"!=typeof t)throw new It(i);return $n(t,n=n===e?n:ga(n))},Oi.reverse=ro,Oi.sampleSize=function(t,i,n){return i=(n?bs(t,i,n):i===e)?1:ga(i),(Zo(t)?Yi:Kn)(t,i)},Oi.set=function(t,e,i){return null==t?t:tr(t,e,i)},Oi.setWith=function(t,i,n,r){return r="function"==typeof r?r:e,null==t?t:tr(t,i,n,r)},Oi.shuffle=function(t){return(Zo(t)?Ki:nr)(t)},Oi.slice=function(t,i,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&bs(t,i,n)?(i=0,n=r):(i=null==i?0:ga(i),n=n===e?r:ga(n)),rr(t,i,n)):[]},Oi.sortBy=Io,Oi.sortedUniq=function(t){return t&&t.length?lr(t):[]},Oi.sortedUniqBy=function(t,e){return t&&t.length?lr(t,us(e,2)):[]},Oi.split=function(t,i,n){return n&&"number"!=typeof n&&bs(t,i,n)&&(i=n=e),(n=n===e?_:n>>>0)?(t=wa(t))&&("string"==typeof i||null!=i&&!ca(i))&&!(i=cr(i))&&ni(t)?Sr(ui(t),0,n):t.split(i,n):[]},Oi.spread=function(t,e){if("function"!=typeof t)throw new It(i);return e=null==e?0:vi(ga(e),0),$n((function(i){var n=i[e],r=Sr(i,0,e);return n&&ke(r,n),Se(t,this,r)}))},Oi.tail=function(t){var e=null==t?0:t.length;return e?rr(t,1,e):[]},Oi.take=function(t,i,n){return t&&t.length?rr(t,0,(i=n||i===e?1:ga(i))<0?0:i):[]},Oi.takeRight=function(t,i,n){var r=null==t?0:t.length;return r?rr(t,(i=r-(i=n||i===e?1:ga(i)))<0?0:i,r):[]},Oi.takeRightWhile=function(t,e){return t&&t.length?fr(t,us(e,3),!1,!0):[]},Oi.takeWhile=function(t,e){return t&&t.length?fr(t,us(e,3)):[]},Oi.tap=function(t,e){return e(t),t},Oi.throttle=function(t,e,n){var r=!0,s=!0;if("function"!=typeof t)throw new It(i);return sa(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),Lo(t,e,{leading:r,maxWait:e,trailing:s})},Oi.thru=vo,Oi.toArray=ya,Oi.toPairs=qa,Oi.toPairsIn=Ua,Oi.toPath=function(t){return Zo(t)?Ie(t,Ns):_a(t)?[t]:Ir(Os(wa(t)))},Oi.toPlainObject=Sa,Oi.transform=function(t,e,i){var n=Zo(t),r=n||Ko(t)||fa(t);if(e=us(e,4),null==i){var s=t&&t.constructor;i=r?n?new s:[]:sa(t)&&ia(s)?Ni(Xt(t)):{}}return(r?Be:xn)(t,(function(t,n,r){return e(i,t,n,r)})),i},Oi.unary=function(t){return Do(t,1)},Oi.union=so,Oi.unionBy=oo,Oi.unionWith=ao,Oi.uniq=function(t){return t&&t.length?hr(t):[]},Oi.uniqBy=function(t,e){return t&&t.length?hr(t,us(e,2)):[]},Oi.uniqWith=function(t,i){return i="function"==typeof i?i:e,t&&t.length?hr(t,e,i):[]},Oi.unset=function(t,e){return null==t||mr(t,e)},Oi.unzip=lo,Oi.unzipWith=uo,Oi.update=function(t,e,i){return null==t?t:_r(t,e,gr(i))},Oi.updateWith=function(t,i,n,r){return r="function"==typeof r?r:e,null==t?t:_r(t,i,gr(n),r)},Oi.values=Ja,Oi.valuesIn=function(t){return null==t?[]:Ze(t,Ra(t))},Oi.without=co,Oi.words=il,Oi.wrap=function(t,e){return jo(gr(e),t)},Oi.xor=ho,Oi.xorBy=mo,Oi.xorWith=_o,Oi.zip=fo,Oi.zipObject=function(t,e){return yr(t||[],e||[],en)},Oi.zipObjectDeep=function(t,e){return yr(t||[],e||[],tr)},Oi.zipWith=po,Oi.entries=qa,Oi.entriesIn=Ua,Oi.extend=Ca,Oi.extendWith=Aa,ml(Oi,Oi),Oi.add=wl,Oi.attempt=nl,Oi.camelCase=Wa,Oi.capitalize=Xa,Oi.ceil=Bl,Oi.clamp=function(t,i,n){return n===e&&(n=i,i=e),n!==e&&(n=(n=xa(n))==n?n:0),i!==e&&(i=(i=xa(i))==i?i:0),ln(xa(t),i,n)},Oi.clone=function(t){return un(t,4)},Oi.cloneDeep=function(t){return un(t,5)},Oi.cloneDeepWith=function(t,i){return un(t,5,i="function"==typeof i?i:e)},Oi.cloneWith=function(t,i){return un(t,4,i="function"==typeof i?i:e)},Oi.conformsTo=function(t,e){return null==e||cn(t,e,La(e))},Oi.deburr=Ha,Oi.defaultTo=function(t,e){return null==t||t!=t?e:t},Oi.divide=Cl,Oi.endsWith=function(t,i,n){t=wa(t),i=cr(i);var r=t.length,s=n=n===e?r:ln(ga(n),0,r);return(n-=i.length)>=0&&t.slice(n,s)==i},Oi.eq=Jo,Oi.escape=function(t){return(t=wa(t))&&H.test(t)?t.replace(W,ei):t},Oi.escapeRegExp=function(t){return(t=wa(t))&&it.test(t)?t.replace(et,"\\$&"):t},Oi.every=function(t,i,n){var r=Zo(t)?Ae:dn;return n&&bs(t,i,n)&&(i=e),r(t,us(i,3))},Oi.find=xo,Oi.findIndex=Xs,Oi.findKey=function(t,e){return Le(t,us(e,3),xn)},Oi.findLast=So,Oi.findLastIndex=Hs,Oi.findLastKey=function(t,e){return Le(t,us(e,3),Sn)},Oi.floor=Al,Oi.forEach=wo,Oi.forEachRight=Bo,Oi.forIn=function(t,e){return null==t?t:gn(t,us(e,3),Ra)},Oi.forInRight=function(t,e){return null==t?t:bn(t,us(e,3),Ra)},Oi.forOwn=function(t,e){return t&&xn(t,us(e,3))},Oi.forOwnRight=function(t,e){return t&&Sn(t,us(e,3))},Oi.get=ka,Oi.gt=Wo,Oi.gte=Xo,Oi.has=function(t,e){return null!=t&&ps(t,e,Pn)},Oi.hasIn=Da,Oi.head=Qs,Oi.identity=ll,Oi.includes=function(t,e,i,n){t=$o(t)?t:Ja(t),i=i&&!n?ga(i):0;var r=t.length;return i<0&&(i=vi(r+i,0)),ma(t)?i<=r&&t.indexOf(e,i)>-1:!!r&&Ee(t,e,i)>-1},Oi.indexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:ga(i);return r<0&&(r=vi(n+r,0)),Ee(t,e,r)},Oi.inRange=function(t,i,n){return i=va(i),n===e?(n=i,i=0):n=va(n),function(t,e,i){return t>=gi(e,i)&&t<vi(e,i)}(t=xa(t),i,n)},Oi.invoke=Fa,Oi.isArguments=Ho,Oi.isArray=Zo,Oi.isArrayBuffer=Qo,Oi.isArrayLike=$o,Oi.isArrayLikeObject=Yo,Oi.isBoolean=function(t){return!0===t||!1===t||oa(t)&&An(t)==y},Oi.isBuffer=Ko,Oi.isDate=ta,Oi.isElement=function(t){return oa(t)&&1===t.nodeType&&!ua(t)},Oi.isEmpty=function(t){if(null==t)return!0;if($o(t)&&(Zo(t)||"string"==typeof t||"function"==typeof t.splice||Ko(t)||fa(t)||Ho(t)))return!t.length;var e=ds(t);if(e==S||e==V)return!t.size;if(Bs(t))return!Rn(t).length;for(var i in t)if(Lt.call(t,i))return!1;return!0},Oi.isEqual=function(t,e){return Gn(t,e)},Oi.isEqualWith=function(t,i,n){var r=(n="function"==typeof n?n:e)?n(t,i):e;return r===e?Gn(t,i,e,n):!!r},Oi.isError=ea,Oi.isFinite=function(t){return"number"==typeof t&&di(t)},Oi.isFunction=ia,Oi.isInteger=na,Oi.isLength=ra,Oi.isMap=aa,Oi.isMatch=function(t,e){return t===e||Tn(t,e,hs(e))},Oi.isMatchWith=function(t,i,n){return n="function"==typeof n?n:e,Tn(t,i,hs(i),n)},Oi.isNaN=function(t){return la(t)&&t!=+t},Oi.isNative=function(t){if(ws(t))throw new Bt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Fn(t)},Oi.isNil=function(t){return null==t},Oi.isNull=function(t){return null===t},Oi.isNumber=la,Oi.isObject=sa,Oi.isObjectLike=oa,Oi.isPlainObject=ua,Oi.isRegExp=ca,Oi.isSafeInteger=function(t){return na(t)&&t>=-9007199254740991&&t<=h},Oi.isSet=ha,Oi.isString=ma,Oi.isSymbol=_a,Oi.isTypedArray=fa,Oi.isUndefined=function(t){return t===e},Oi.isWeakMap=function(t){return oa(t)&&ds(t)==I},Oi.isWeakSet=function(t){return oa(t)&&"[object WeakSet]"==An(t)},Oi.join=function(t,e){return null==t?"":pi.call(t,e)},Oi.kebabCase=Za,Oi.last=to,Oi.lastIndexOf=function(t,i,n){var r=null==t?0:t.length;if(!r)return-1;var s=r;return n!==e&&(s=(s=ga(n))<0?vi(r+s,0):gi(s,r-1)),i==i?function(t,e,i){for(var n=i+1;n--;)if(t[n]===e)return n;return n}(t,i,s):Re(t,Oe,s,!0)},Oi.lowerCase=Qa,Oi.lowerFirst=$a,Oi.lt=da,Oi.lte=pa,Oi.max=function(t){return t&&t.length?pn(t,ll,Vn):e},Oi.maxBy=function(t,i){return t&&t.length?pn(t,us(i,2),Vn):e},Oi.mean=function(t){return Ne(t,ll)},Oi.meanBy=function(t,e){return Ne(t,us(e,2))},Oi.min=function(t){return t&&t.length?pn(t,ll,zn):e},Oi.minBy=function(t,i){return t&&t.length?pn(t,us(i,2),zn):e},Oi.stubArray=bl,Oi.stubFalse=xl,Oi.stubObject=function(){return{}},Oi.stubString=function(){return""},Oi.stubTrue=function(){return!0},Oi.multiply=Vl,Oi.nth=function(t,i){return t&&t.length?Un(t,ga(i)):e},Oi.noConflict=function(){return ce._===this&&(ce._=Nt),this},Oi.noop=_l,Oi.now=ko,Oi.pad=function(t,e,i){t=wa(t);var n=(e=ga(e))?li(t):0;if(!e||n>=e)return t;var r=(e-n)/2;return Jr(qe(r),i)+t+Jr(Fe(r),i)},Oi.padEnd=function(t,e,i){t=wa(t);var n=(e=ga(e))?li(t):0;return e&&n<e?t+Jr(e-n,i):t},Oi.padStart=function(t,e,i){t=wa(t);var n=(e=ga(e))?li(t):0;return e&&n<e?Jr(e-n,i)+t:t},Oi.parseInt=function(t,e,i){return i||null==e?e=0:e&&(e=+e),xi(wa(t).replace(nt,""),e||0)},Oi.random=function(t,i,n){if(n&&"boolean"!=typeof n&&bs(t,i,n)&&(i=n=e),n===e&&("boolean"==typeof i?(n=i,i=e):"boolean"==typeof t&&(n=t,t=e)),t===e&&i===e?(t=0,i=1):(t=va(t),i===e?(i=t,t=0):i=va(i)),t>i){var r=t;t=i,i=r}if(n||t%1||i%1){var s=Si();return gi(t+s*(i-t+oe("1e-"+((s+"").length-1))),i)}return Zn(t,i)},Oi.reduce=function(t,e,i){var n=Zo(t)?De:Ue,r=arguments.length<3;return n(t,us(e,4),i,r,_n)},Oi.reduceRight=function(t,e,i){var n=Zo(t)?Ge:Ue,r=arguments.length<3;return n(t,us(e,4),i,r,fn)},Oi.repeat=function(t,i,n){return i=(n?bs(t,i,n):i===e)?1:ga(i),Qn(wa(t),i)},Oi.replace=function(){var t=arguments,e=wa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Oi.result=function(t,i,n){var r=-1,s=(i=br(i,t)).length;for(s||(s=1,t=e);++r<s;){var o=null==t?e:t[Ns(i[r])];o===e&&(r=s,o=n),t=ia(o)?o.call(t):o}return t},Oi.round=Pl,Oi.runInContext=t,Oi.sample=function(t){return(Zo(t)?$i:Yn)(t)},Oi.size=function(t){if(null==t)return 0;if($o(t))return ma(t)?li(t):t.length;var e=ds(t);return e==S||e==V?t.size:Rn(t).length},Oi.snakeCase=Ya,Oi.some=function(t,i,n){var r=Zo(t)?Te:sr;return n&&bs(t,i,n)&&(i=e),r(t,us(i,3))},Oi.sortedIndex=function(t,e){return or(t,e)},Oi.sortedIndexBy=function(t,e,i){return ar(t,e,us(i,2))},Oi.sortedIndexOf=function(t,e){var i=null==t?0:t.length;if(i){var n=or(t,e);if(n<i&&Jo(t[n],e))return n}return-1},Oi.sortedLastIndex=function(t,e){return or(t,e,!0)},Oi.sortedLastIndexBy=function(t,e,i){return ar(t,e,us(i,2),!0)},Oi.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var i=or(t,e,!0)-1;if(Jo(t[i],e))return i}return-1},Oi.startCase=Ka,Oi.startsWith=function(t,e,i){return t=wa(t),i=null==i?0:ln(ga(i),0,t.length),e=cr(e),t.slice(i,i+e.length)==e},Oi.subtract=Ml,Oi.sum=function(t){return t&&t.length?Je(t,ll):0},Oi.sumBy=function(t,e){return t&&t.length?Je(t,us(e,2)):0},Oi.template=function(t,i,n){var r=Oi.templateSettings;n&&bs(t,i,n)&&(i=e),t=wa(t),i=Aa({},i,r,Kr);var s,o,a=Aa({},i.imports,r.imports,Kr),l=La(a),u=Ze(a,l),c=0,h=i.interpolate||gt,m="__p += '",_=Pt((i.escape||gt).source+"|"+h.source+"|"+(h===$?ht:gt).source+"|"+(i.evaluate||gt).source+"|$","g"),f="//# sourceURL="+(Lt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ie+"]")+"\n";t.replace(_,(function(e,i,n,r,a,l){return n||(n=r),m+=t.slice(c,l).replace(bt,ii),i&&(s=!0,m+="' +\n__e("+i+") +\n'"),a&&(o=!0,m+="';\n"+a+";\n__p += '"),n&&(m+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=l+e.length,e})),m+="';\n";var d=Lt.call(i,"variable")&&i.variable;if(d){if(ut.test(d))throw new Bt("Invalid `variable` option passed into `_.template`")}else m="with (obj) {\n"+m+"\n}\n";m=(o?m.replace(j,""):m).replace(q,"$1").replace(U,"$1;"),m="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var p=nl((function(){return Ct(l,f+"return "+m).apply(e,u)}));if(p.source=m,ea(p))throw p;return p},Oi.times=function(t,e){if((t=ga(t))<1||t>h)return[];var i=_,n=gi(t,_);e=us(e),t-=_;for(var r=We(n,e);++i<t;)e(i);return r},Oi.toFinite=va,Oi.toInteger=ga,Oi.toLength=ba,Oi.toLower=function(t){return wa(t).toLowerCase()},Oi.toNumber=xa,Oi.toSafeInteger=function(t){return t?ln(ga(t),-9007199254740991,h):0===t?t:0},Oi.toString=wa,Oi.toUpper=function(t){return wa(t).toUpperCase()},Oi.trim=function(t,i,n){if((t=wa(t))&&(n||i===e))return Xe(t);if(!t||!(i=cr(i)))return t;var r=ui(t),s=ui(i);return Sr(r,$e(r,s),Ye(r,s)+1).join("")},Oi.trimEnd=function(t,i,n){if((t=wa(t))&&(n||i===e))return t.slice(0,ci(t)+1);if(!t||!(i=cr(i)))return t;var r=ui(t);return Sr(r,0,Ye(r,ui(i))+1).join("")},Oi.trimStart=function(t,i,n){if((t=wa(t))&&(n||i===e))return t.replace(nt,"");if(!t||!(i=cr(i)))return t;var r=ui(t);return Sr(r,$e(r,ui(i))).join("")},Oi.truncate=function(t,i){var n=30,r="...";if(sa(i)){var s="separator"in i?i.separator:s;n="length"in i?ga(i.length):n,r="omission"in i?cr(i.omission):r}var o=(t=wa(t)).length;if(ni(t)){var a=ui(t);o=a.length}if(n>=o)return t;var l=n-li(r);if(l<1)return r;var u=a?Sr(a,0,l).join(""):t.slice(0,l);if(s===e)return u+r;if(a&&(l+=u.length-l),ca(s)){if(t.slice(l).search(s)){var c,h=u;for(s.global||(s=Pt(s.source,wa(mt.exec(s))+"g")),s.lastIndex=0;c=s.exec(h);)var m=c.index;u=u.slice(0,m===e?l:m)}}else if(t.indexOf(cr(s),l)!=l){var _=u.lastIndexOf(s);_>-1&&(u=u.slice(0,_))}return u+r},Oi.unescape=function(t){return(t=wa(t))&&X.test(t)?t.replace(J,hi):t},Oi.uniqueId=function(t){var e=++Rt;return wa(t)+e},Oi.upperCase=tl,Oi.upperFirst=el,Oi.each=wo,Oi.eachRight=Bo,Oi.first=Qs,ml(Oi,(Sl={},xn(Oi,(function(t,e){Lt.call(Oi.prototype,e)||(Sl[e]=t)})),Sl),{chain:!1}),Oi.VERSION="4.17.21",Be(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Oi[t].placeholder=Oi})),Be(["drop","take"],(function(t,i){Ui.prototype[t]=function(n){n=n===e?1:vi(ga(n),0);var r=this.__filtered__&&!i?new Ui(this):this.clone();return r.__filtered__?r.__takeCount__=gi(n,r.__takeCount__):r.__views__.push({size:gi(n,_),type:t+(r.__dir__<0?"Right":"")}),r},Ui.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Be(["filter","map","takeWhile"],(function(t,e){var i=e+1,n=1==i||3==i;Ui.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:us(t,3),type:i}),e.__filtered__=e.__filtered__||n,e}})),Be(["head","last"],(function(t,e){var i="take"+(e?"Right":"");Ui.prototype[t]=function(){return this[i](1).value()[0]}})),Be(["initial","tail"],(function(t,e){var i="drop"+(e?"":"Right");Ui.prototype[t]=function(){return this.__filtered__?new Ui(this):this[i](1)}})),Ui.prototype.compact=function(){return this.filter(ll)},Ui.prototype.find=function(t){return this.filter(t).head()},Ui.prototype.findLast=function(t){return this.reverse().find(t)},Ui.prototype.invokeMap=$n((function(t,e){return"function"==typeof t?new Ui(this):this.map((function(i){return kn(i,t,e)}))})),Ui.prototype.reject=function(t){return this.filter(Oo(us(t)))},Ui.prototype.slice=function(t,i){t=ga(t);var n=this;return n.__filtered__&&(t>0||i<0)?new Ui(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),i!==e&&(n=(i=ga(i))<0?n.dropRight(-i):n.take(i-t)),n)},Ui.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ui.prototype.toArray=function(){return this.take(_)},xn(Ui.prototype,(function(t,i){var n=/^(?:filter|find|map|reject)|While$/.test(i),r=/^(?:head|last)$/.test(i),s=Oi[r?"take"+("last"==i?"Right":""):i],o=r||/^find/.test(i);s&&(Oi.prototype[i]=function(){var i=this.__wrapped__,a=r?[1]:arguments,l=i instanceof Ui,u=a[0],c=l||Zo(i),h=function(t){var e=s.apply(Oi,ke([t],a));return r&&m?e[0]:e};c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var m=this.__chain__,_=!!this.__actions__.length,f=o&&!m,d=l&&!_;if(!o&&c){i=d?i:new Ui(this);var p=t.apply(i,a);return p.__actions__.push({func:vo,args:[h],thisArg:e}),new qi(p,m)}return f&&d?t.apply(this,a):(p=this.thru(h),f?r?p.value()[0]:p.value():p)})})),Be(["pop","push","shift","sort","splice","unshift"],(function(t){var e=kt[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);Oi.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var r=this.value();return e.apply(Zo(r)?r:[],t)}return this[i]((function(i){return e.apply(Zo(i)?i:[],t)}))}})),xn(Ui.prototype,(function(t,e){var i=Oi[e];if(i){var n=i.name+"";Lt.call(ki,n)||(ki[n]=[]),ki[n].push({name:e,func:i})}})),ki[Nr(e,2).name]=[{name:"wrapper",func:e}],Ui.prototype.clone=function(){var t=new Ui(this.__wrapped__);return t.__actions__=Ir(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ir(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ir(this.__views__),t},Ui.prototype.reverse=function(){if(this.__filtered__){var t=new Ui(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Ui.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,i=Zo(t),n=e<0,r=i?t.length:0,s=function(t,e,i){for(var n=-1,r=i.length;++n<r;){var s=i[n],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=gi(e,t+o);break;case"takeRight":t=vi(t,e-o)}}return{start:t,end:e}}(0,r,this.__views__),o=s.start,a=s.end,l=a-o,u=n?a:o-1,c=this.__iteratees__,h=c.length,m=0,_=gi(l,this.__takeCount__);if(!i||!n&&r==l&&_==l)return dr(t,this.__actions__);var f=[];t:for(;l--&&m<_;){for(var d=-1,p=t[u+=e];++d<h;){var y=c[d],v=y.iteratee,g=y.type,b=v(p);if(2==g)p=b;else if(!b){if(1==g)continue t;break t}}f[m++]=p}return f},Oi.prototype.at=go,Oi.prototype.chain=function(){return yo(this)},Oi.prototype.commit=function(){return new qi(this.value(),this.__chain__)},Oi.prototype.next=function(){this.__values__===e&&(this.__values__=ya(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?e:this.__values__[this.__index__++]}},Oi.prototype.plant=function(t){for(var i,n=this;n instanceof ji;){var r=qs(n);r.__index__=0,r.__values__=e,i?s.__wrapped__=r:i=r;var s=r;n=n.__wrapped__}return s.__wrapped__=t,i},Oi.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Ui){var i=t;return this.__actions__.length&&(i=new Ui(this)),(i=i.reverse()).__actions__.push({func:vo,args:[ro],thisArg:e}),new qi(i,this.__chain__)}return this.thru(ro)},Oi.prototype.toJSON=Oi.prototype.valueOf=Oi.prototype.value=function(){return dr(this.__wrapped__,this.__actions__)},Oi.prototype.first=Oi.prototype.head,le&&(Oi.prototype[le]=function(){return this}),Oi}();me?((me.exports=mi)._=mi,he._=mi):ce._=mi}.call(t);export{Zu as R,Uc as a,eh as b,$u as c,E as d,th as j,Yu as k,sh as l,e as r,rh as u};
